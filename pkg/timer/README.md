# Timer - å®šæ—¶ä»»åŠ¡è°ƒåº¦ç»„ä»¶

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€ç»“æ„æ¸…æ™°çš„Goå®šæ—¶ä»»åŠ¡è°ƒåº¦ç»„ä»¶ï¼Œæ”¯æŒå¤šç§è°ƒåº¦ç­–ç•¥å’Œæ¨ªå‘æ‰©å±•ã€‚

## ç›®å½•ç»“æ„

```
pkg/timer/
â”œâ”€â”€ timer.go              # æ ¸å¿ƒæ¥å£å’Œç±»å‹å®šä¹‰
â”œâ”€â”€ timer_pool.go         # å…¨å±€è°ƒåº¦å™¨æ± ç®¡ç†
â”œâ”€â”€ task.go              # ä»»åŠ¡ç›¸å…³å·¥å…·å‡½æ•°
â”œâ”€â”€ scheduler.go         # æ ‡å‡†è°ƒåº¦å™¨å®ç°
â”œâ”€â”€ cron/               # Cronè¡¨è¾¾å¼è§£æ
â”‚   â””â”€â”€ cron.go
â”œâ”€â”€ executor/           # ä»»åŠ¡æ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ executor.go     # æ‰§è¡Œå™¨æ¥å£å’ŒåŸºç¡€å®ç°
â”‚   â””â”€â”€ builtin.go      # å†…ç½®æ‰§è¡Œå™¨
â”œâ”€â”€ storage/            # å­˜å‚¨å®ç°
â”‚   â”œâ”€â”€ storage.go      # å­˜å‚¨æ¥å£
â”‚   â””â”€â”€ memory.go       # å†…å­˜å­˜å‚¨å®ç°
â””â”€â”€ examples/           # ä½¿ç”¨ç¤ºä¾‹
    â””â”€â”€ basic.go
```

## æ ¸å¿ƒç‰¹æ€§

- **å¤šç§è°ƒåº¦ç­–ç•¥**: æ”¯æŒä¸€æ¬¡æ€§æ‰§è¡Œã€å›ºå®šé—´éš”ã€Cronè¡¨è¾¾å¼ã€å»¶è¿Ÿæ‰§è¡Œ
- **å®Œæ•´çš„ä»»åŠ¡ç®¡ç†**: ä»»åŠ¡çš„å¢åˆ æ”¹æŸ¥ã€å¯åŠ¨åœæ­¢ã€æ‰‹åŠ¨è§¦å‘
- **è°ƒåº¦å™¨æ± ç®¡ç†**: å…¨å±€è°ƒåº¦å™¨æ± ï¼Œæ”¯æŒå¤šä¸ªè°ƒåº¦å™¨å®ä¾‹çš„ç»Ÿä¸€ç®¡ç†
- **å†…ç½®æ‰§è¡Œå™¨**: æ—¥å¿—è¾“å‡ºã€HTTPè¯·æ±‚ã€ç³»ç»Ÿå‘½ä»¤ç­‰å¸¸ç”¨æ‰§è¡Œå™¨
- **è‡ªå®šä¹‰æ‰§è¡Œå™¨**: æ”¯æŒå‡½æ•°æ‰§è¡Œå™¨ï¼Œå¯ä»¥è½»æ¾æ‰©å±•
- **å¹¶å‘å®‰å…¨**: ä½¿ç”¨å·¥ä½œçº¿ç¨‹æ± ï¼Œæ”¯æŒå¹¶å‘æ‰§è¡Œ
- **é”™è¯¯å¤„ç†**: æ”¯æŒé‡è¯•æœºåˆ¶å’Œè¶…æ—¶æ§åˆ¶
- **å­˜å‚¨æŒä¹…åŒ–**: å†…å­˜å­˜å‚¨ï¼Œæ˜“äºæ‰©å±•Redisç­‰å…¶ä»–å­˜å‚¨

## å¿«é€Ÿå¼€å§‹

> ğŸ“– **è¯¦ç»†å¯åŠ¨æŒ‡å—**: è¯·æŸ¥çœ‹ [STARTUP_GUIDE.md](./STARTUP_GUIDE.md) è·å–å®Œæ•´çš„å¯åŠ¨æµç¨‹è¯´æ˜

### 1. ä½¿ç”¨å…¨å±€è°ƒåº¦å™¨æ± ï¼ˆæ¨èï¼‰

```go
package main

import (
    "time"
    "github.com/gohub/pkg/timer"
    "github.com/gohub/pkg/timer/executor"
    "github.com/gohub/pkg/timer/storage"
)

func main() {
    // è·å–å…¨å±€è°ƒåº¦å™¨æ± 
    pool := timer.GetTimerPool()
    
    // åˆ›å»ºå­˜å‚¨
    store := storage.NewMemoryStorage()
    
    // åˆ›å»ºä»»åŠ¡é…ç½®
    taskConfig := &timer.TaskConfig{
        ID:           "my-task",
        Name:         "ç¤ºä¾‹ä»»åŠ¡",
        ScheduleType: timer.ScheduleTypeInterval,
        Interval:     time.Minute,
        Enabled:      true,
        Params:       "Hello World!",
    }
    
    // åˆ›å»ºæ‰§è¡Œå™¨
    executor := executor.NewLogExecutor()
    
    // å‘é»˜è®¤è°ƒåº¦å™¨æ·»åŠ ä»»åŠ¡
    pool.AddTaskToDefault(taskConfig, executor, store)
    
    // å¯åŠ¨é»˜è®¤è°ƒåº¦å™¨
    pool.StartDefaultScheduler(store)
    
    // ç­‰å¾…ä»»åŠ¡æ‰§è¡Œ
    time.Sleep(5 * time.Minute)
    
    // åœæ­¢æ‰€æœ‰è°ƒåº¦å™¨
    pool.StopAllSchedulers()
}
```

### 2. åˆ›å»ºå¤šä¸ªè°ƒåº¦å™¨å®ä¾‹

```go
// åˆ›å»ºè‡ªå®šä¹‰è°ƒåº¦å™¨é…ç½®
config1 := &timer.SchedulerConfig{
    ID:             "scheduler-1",
    Name:           "ä¸šåŠ¡è°ƒåº¦å™¨",
    MaxWorkers:     10,
    QueueSize:      200,
    DefaultTimeout: time.Minute * 30,
    DefaultRetries: 3,
}

config2 := &timer.SchedulerConfig{
    ID:             "scheduler-2", 
    Name:           "ç›‘æ§è°ƒåº¦å™¨",
    MaxWorkers:     5,
    QueueSize:      50,
    DefaultTimeout: time.Minute * 5,
    DefaultRetries: 1,
}

// åˆ›å»ºè°ƒåº¦å™¨å®ä¾‹
pool := timer.GetTimerPool()
scheduler1, _ := pool.CreateScheduler(config1, store)
scheduler2, _ := pool.CreateScheduler(config2, store)

// åˆ†åˆ«ç®¡ç†ä¸åŒç±»å‹çš„ä»»åŠ¡
scheduler1.AddTask(businessTaskConfig, businessExecutor)
scheduler2.AddTask(monitorTaskConfig, monitorExecutor)

// å¯åŠ¨æ‰€æœ‰è°ƒåº¦å™¨
pool.StartAllSchedulers()
```

### 3. åŸºæœ¬ä½¿ç”¨ï¼ˆç›´æ¥åˆ›å»ºè°ƒåº¦å™¨ï¼‰

```go
package main

import (
    "time"
    "github.com/gohub/pkg/timer"
    "github.com/gohub/pkg/timer/executor"
    "github.com/gohub/pkg/timer/storage"
)

func main() {
    // åˆ›å»ºå­˜å‚¨å’Œè°ƒåº¦å™¨
    store := storage.NewMemoryStorage()
    scheduler := timer.NewStandardScheduler(nil, store)
    
    // åˆ›å»ºä»»åŠ¡é…ç½®
    taskConfig := &timer.TaskConfig{
        ID:           "my-task",
        Name:         "ç¤ºä¾‹ä»»åŠ¡",
        ScheduleType: timer.ScheduleTypeInterval,
        Interval:     time.Minute,
        Enabled:      true,
        Params:       "Hello World!",
    }
    
    // åˆ›å»ºæ‰§è¡Œå™¨
    executor := executor.NewLogExecutor()
    
    // æ·»åŠ ä»»åŠ¡å¹¶å¯åŠ¨è°ƒåº¦å™¨
    scheduler.AddTask(taskConfig, executor)
    scheduler.Start()
    
    // ç­‰å¾…ä»»åŠ¡æ‰§è¡Œ
    time.Sleep(5 * time.Minute)
    
    // åœæ­¢è°ƒåº¦å™¨
    scheduler.Stop()
}
```

### 4. Cronè¡¨è¾¾å¼ä»»åŠ¡

```go
taskConfig := &timer.TaskConfig{
    ID:           "cron-task",
    Name:         "Cronä»»åŠ¡",
    ScheduleType: timer.ScheduleTypeCron,
    CronExpr:     "0 9 * * 1-5", // å·¥ä½œæ—¥ä¸Šåˆ9ç‚¹
    Enabled:      true,
}
```

### 5. è‡ªå®šä¹‰æ‰§è¡Œå™¨

```go
customExecutor := executor.NewFunctionExecutor("MyTask", func(ctx context.Context, params interface{}) error {
    fmt.Printf("æ‰§è¡Œè‡ªå®šä¹‰ä»»åŠ¡: %v\n", params)
    return nil
})
```

### 6. HTTPå¥åº·æ£€æŸ¥ä»»åŠ¡

```go
httpExecutor := executor.NewHTTPExecutor()
taskConfig := &timer.TaskConfig{
    ID:           "health-check",
    Name:         "å¥åº·æ£€æŸ¥",
    ScheduleType: timer.ScheduleTypeInterval,
    Interval:     30 * time.Second,
    Enabled:      true,
    Params: map[string]interface{}{
        "url":    "https://example.com/health",
        "method": "GET",
    },
}
```

## APIå‚è€ƒ

### è°ƒåº¦å™¨æ± æ¥å£

- `GetTimerPool()` - è·å–å…¨å±€è°ƒåº¦å™¨æ± å®ä¾‹
- `CreateScheduler(config, storage)` - åˆ›å»ºæ–°çš„è°ƒåº¦å™¨å®ä¾‹
- `GetScheduler(schedulerID)` - æ ¹æ®IDè·å–è°ƒåº¦å™¨å®ä¾‹
- `RemoveScheduler(schedulerID)` - ç§»é™¤æŒ‡å®šè°ƒåº¦å™¨
- `ListSchedulers()` - è·å–æ‰€æœ‰è°ƒåº¦å™¨IDåˆ—è¡¨
- `StartAllSchedulers()` - å¯åŠ¨æ‰€æœ‰è°ƒåº¦å™¨
- `StopAllSchedulers()` - åœæ­¢æ‰€æœ‰è°ƒåº¦å™¨
- `GetSchedulerInfo(schedulerID)` - è·å–è°ƒåº¦å™¨è¯¦ç»†ä¿¡æ¯
- `GetDefaultScheduler(storage)` - è·å–é»˜è®¤è°ƒåº¦å™¨
- `AddTaskToDefault(config, executor, storage)` - å‘é»˜è®¤è°ƒåº¦å™¨æ·»åŠ ä»»åŠ¡

### è°ƒåº¦å™¨æ¥å£

- `AddTask(config, executor)` - æ·»åŠ ä»»åŠ¡
- `RemoveTask(taskID)` - ç§»é™¤ä»»åŠ¡
- `StartTask(taskID)` - å¯åŠ¨ä»»åŠ¡
- `StopTask(taskID)` - åœæ­¢ä»»åŠ¡
- `TriggerTask(taskID, params)` - æ‰‹åŠ¨è§¦å‘ä»»åŠ¡
- `Start()` - å¯åŠ¨è°ƒåº¦å™¨
- `Stop()` - åœæ­¢è°ƒåº¦å™¨
- `ListTasks()` - åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡
- `GetTaskHistory(taskID, limit)` - è·å–ä»»åŠ¡æ‰§è¡Œå†å²

### å†…ç½®æ‰§è¡Œå™¨

- `LogExecutor` - æ—¥å¿—è¾“å‡ºæ‰§è¡Œå™¨
- `HTTPExecutor` - HTTPè¯·æ±‚æ‰§è¡Œå™¨
- `CommandExecutor` - ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œå™¨
- `FunctionExecutor` - è‡ªå®šä¹‰å‡½æ•°æ‰§è¡Œå™¨

### Cronè¡¨è¾¾å¼

æ”¯æŒæ ‡å‡†5å­—æ®µCronè¡¨è¾¾å¼ï¼š`åˆ†é’Ÿ å°æ—¶ æ—¥ æœˆ å‘¨`

é¢„å®šä¹‰è¡¨è¾¾å¼ï¼š
- `cron.EveryMinute` - æ¯åˆ†é’Ÿ
- `cron.Hourly` - æ¯å°æ—¶
- `cron.Daily` - æ¯å¤©
- `cron.Weekly` - æ¯å‘¨
- `cron.Monthly` - æ¯æœˆ
- `cron.Yearly` - æ¯å¹´

## è¿è¡Œç¤ºä¾‹

```go
import "github.com/gohub/pkg/timer/examples"

// è¿è¡ŒåŸºæœ¬ç¤ºä¾‹
examples.BasicUsageExample()

// è¿è¡Œæ‰€æœ‰ç¤ºä¾‹
examples.RunAllExamples()
```

## æ‰©å±•

### è‡ªå®šä¹‰å­˜å‚¨

å®ç° `timer.TaskStorage` æ¥å£å³å¯æ·»åŠ æ–°çš„å­˜å‚¨åç«¯ï¼ˆå¦‚Redisã€MySQLç­‰ï¼‰ã€‚

### è‡ªå®šä¹‰æ‰§è¡Œå™¨

å®ç° `timer.TaskExecutor` æ¥å£å³å¯åˆ›å»ºè‡ªå®šä¹‰æ‰§è¡Œå™¨ï¼š

```go
type MyExecutor struct {
    name string
}

func (e *MyExecutor) Execute(ctx context.Context, params interface{}) error {
    // æ‰§è¡Œé€»è¾‘
    return nil
}

func (e *MyExecutor) GetName() string {
    return e.name
}
```

## æœ€ä½³å®è·µ

1. **ä»»åŠ¡IDå”¯ä¸€æ€§**: ç¡®ä¿ä»»åŠ¡IDåœ¨æ•´ä¸ªç³»ç»Ÿä¸­å”¯ä¸€
2. **è¶…æ—¶è®¾ç½®**: ä¸ºé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡è®¾ç½®åˆé€‚çš„è¶…æ—¶æ—¶é—´
3. **é”™è¯¯å¤„ç†**: åˆç†è®¾ç½®é‡è¯•æ¬¡æ•°å’Œé‡è¯•é—´éš”
4. **èµ„æºç®¡ç†**: æ ¹æ®ç³»ç»Ÿè´Ÿè½½è°ƒæ•´å·¥ä½œçº¿ç¨‹æ•°å’Œé˜Ÿåˆ—å¤§å°
5. **ç›‘æ§æ—¥å¿—**: å…³æ³¨ä»»åŠ¡æ‰§è¡Œæ—¥å¿—ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TaskConfig    â”‚    â”‚   TaskExecutor  â”‚    â”‚   TaskStorage   â”‚
â”‚   (ä»»åŠ¡é…ç½®)    â”‚    â”‚   (ä»»åŠ¡æ‰§è¡Œå™¨)  â”‚    â”‚   (å­˜å‚¨æ¥å£)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ TaskScheduler   â”‚
                    â”‚ (ä»»åŠ¡è°ƒåº¦å™¨)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å·¥ä½œçº¿ç¨‹æ±      â”‚
                    â”‚  (Worker Pool)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»„ä»¶èŒè´£

- **TaskConfig**: å®šä¹‰ä»»åŠ¡çš„è°ƒåº¦è§„åˆ™ã€é‡è¯•ç­–ç•¥ã€è¶…æ—¶è®¾ç½®ç­‰é…ç½®ä¿¡æ¯
- **TaskExecutor**: å®ç°å…·ä½“çš„ä»»åŠ¡æ‰§è¡Œé€»è¾‘ï¼Œæ”¯æŒå¤šç§å†…ç½®æ‰§è¡Œå™¨å’Œè‡ªå®šä¹‰æ‰©å±•
- **TaskStorage**: æä¾›ä»»åŠ¡æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œæ”¯æŒå†…å­˜å­˜å‚¨å’Œæ‰©å±•å­˜å‚¨åç«¯
- **TaskScheduler**: æ ¸å¿ƒè°ƒåº¦å™¨ï¼Œè´Ÿè´£ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œè°ƒåº¦æ‰§è¡Œ
- **Worker Pool**: å·¥ä½œçº¿ç¨‹æ± ï¼Œè´Ÿè´£å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œæ§åˆ¶ç³»ç»Ÿèµ„æºä½¿ç”¨

## æ‰§è¡Œæµç¨‹

### 1. ä»»åŠ¡æ·»åŠ æµç¨‹

```
ç”¨æˆ·è°ƒç”¨ AddTask
    â†“
éªŒè¯ä»»åŠ¡é…ç½® (ValidateTaskConfig)
    â†“
æ£€æŸ¥ä»»åŠ¡IDå”¯ä¸€æ€§
    â†“
ä¿å­˜ä»»åŠ¡é…ç½®åˆ°å­˜å‚¨ (SaveTaskConfig)
    â†“
åˆ›å»ºä»»åŠ¡è¿è¡Œæ—¶ä¿¡æ¯ (NewTaskInfo)
    â†“
æ³¨å†Œæ‰§è¡Œå™¨åˆ°å†…å­˜æ˜ å°„
    â†“
å¦‚æœè°ƒåº¦å™¨è¿è¡Œä¸­ä¸”ä»»åŠ¡å·²å¯ç”¨
    â†“
å¼€å§‹ä»»åŠ¡è°ƒåº¦ (scheduleTask)
```

### 2. ä»»åŠ¡è°ƒåº¦æµç¨‹

```
è°ƒåº¦å™¨å¯åŠ¨ (Start)
    â†“
å¯åŠ¨å·¥ä½œçº¿ç¨‹æ± 
    â†“
åŠ è½½æ‰€æœ‰ä»»åŠ¡é…ç½®
    â†“
ä¸ºæ¯ä¸ªå¯ç”¨ä»»åŠ¡è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
    â†“
è®¾ç½®å®šæ—¶å™¨ (time.Timer)
    â†“
å®šæ—¶å™¨è§¦å‘
    â†“
åˆ›å»ºä»»åŠ¡ä½œä¸š (taskJob)
    â†“
æäº¤åˆ°ä»»åŠ¡é˜Ÿåˆ— (taskQueue)
    â†“
å·¥ä½œçº¿ç¨‹è·å–ä»»åŠ¡
    â†“
æ‰§è¡Œä»»åŠ¡ (runTask)
    â†“
è®°å½•æ‰§è¡Œç»“æœ
    â†“
é‡æ–°è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
    â†“
è®¾ç½®æ–°çš„å®šæ—¶å™¨
```

### 3. ä»»åŠ¡æ‰§è¡Œæµç¨‹

```
å·¥ä½œçº¿ç¨‹ä»é˜Ÿåˆ—è·å–ä»»åŠ¡
    â†“
åˆ›å»ºæ‰§è¡Œç»“æœå¯¹è±¡ (NewTaskResult)
    â†“
æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸ºè¿è¡Œä¸­
    â†“
è®¾ç½®æ‰§è¡Œè¶…æ—¶æ§åˆ¶
    â†“
è°ƒç”¨æ‰§è¡Œå™¨ Execute æ–¹æ³•
    â†“
å¤„ç†æ‰§è¡Œç»“æœï¼š
    â”œâ”€ æˆåŠŸï¼šæ ‡è®°å®Œæˆ (Complete)
    â””â”€ å¤±è´¥ï¼š
        â”œâ”€ æ£€æŸ¥é‡è¯•æ¬¡æ•°
        â”œâ”€ å¦‚æœå¯é‡è¯•ï¼šå»¶è¿Ÿåé‡æ–°æ‰§è¡Œ
        â””â”€ å¦åˆ™ï¼šæ ‡è®°å¤±è´¥ (Fail)
    â†“
ä¿å­˜æ‰§è¡Œç»“æœåˆ°å­˜å‚¨
    â†“
æ›´æ–°ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
```

### 4. è°ƒåº¦ç­–ç•¥

#### Cronè¡¨è¾¾å¼è°ƒåº¦
- ä½¿ç”¨æ ‡å‡†5å­—æ®µCronè¡¨è¾¾å¼ï¼ˆåˆ†é’Ÿ å°æ—¶ æ—¥ æœˆ å‘¨ï¼‰
- æ”¯æŒé€šé…ç¬¦ã€èŒƒå›´ã€åˆ—è¡¨ã€æ­¥é•¿ç­‰è¯­æ³•
- è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´åŸºäºå½“å‰æ—¶é—´å’ŒCronè§„åˆ™

#### å›ºå®šé—´éš”è°ƒåº¦
- åŸºäºé…ç½®çš„æ—¶é—´é—´éš”é‡å¤æ‰§è¡Œ
- ä»ä»»åŠ¡å®Œæˆæ—¶é—´å¼€å§‹è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
- ç¡®ä¿ä»»åŠ¡ä¹‹é—´æœ‰å›ºå®šçš„é—´éš”æ—¶é—´

#### ä¸€æ¬¡æ€§æ‰§è¡Œ
- åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œä¸€æ¬¡
- æ‰§è¡Œå®Œæˆåä¸å†è°ƒåº¦

#### å»¶è¿Ÿæ‰§è¡Œ
- å»¶è¿ŸæŒ‡å®šæ—¶é—´åæ‰§è¡Œ
- å¯ä»¥ç»“åˆå…¶ä»–è°ƒåº¦ç­–ç•¥ä½¿ç”¨

### 5. é”™è¯¯å¤„ç†æœºåˆ¶

```
ä»»åŠ¡æ‰§è¡Œå¤±è´¥
    â†“
æ£€æŸ¥é‡è¯•é…ç½® (MaxRetries)
    â†“
å¦‚æœé‡è¯•æ¬¡æ•°æœªè¾¾ä¸Šé™ï¼š
    â”œâ”€ ç­‰å¾…é‡è¯•é—´éš” (RetryInterval)
    â”œâ”€ å¢åŠ é‡è¯•è®¡æ•°
    â””â”€ é‡æ–°æ‰§è¡Œä»»åŠ¡
    â†“
å¦‚æœé‡è¯•æ¬¡æ•°è¾¾ä¸Šé™ï¼š
    â”œâ”€ æ ‡è®°ä»»åŠ¡å¤±è´¥
    â”œâ”€ è®°å½•é”™è¯¯ä¿¡æ¯
    â””â”€ ç»§ç»­ä¸‹æ¬¡æ­£å¸¸è°ƒåº¦
```

### 6. å¹¶å‘æ§åˆ¶

- **å·¥ä½œçº¿ç¨‹æ± **: é™åˆ¶åŒæ—¶æ‰§è¡Œçš„ä»»åŠ¡æ•°é‡ï¼Œé˜²æ­¢ç³»ç»Ÿèµ„æºè€—å°½
- **ä»»åŠ¡é˜Ÿåˆ—**: ç¼“å†²å¾…æ‰§è¡Œä»»åŠ¡ï¼Œå¹³æ»‘å¤„ç†ä»»åŠ¡å³°å€¼
- **è¯»å†™é”**: ä¿æŠ¤è°ƒåº¦å™¨çŠ¶æ€å’Œä»»åŠ¡æ˜ å°„çš„å¹¶å‘å®‰å…¨
- **ä¸Šä¸‹æ–‡æ§åˆ¶**: æ”¯æŒä»»åŠ¡è¶…æ—¶å’Œä¼˜é›…å–æ¶ˆ

## æ‰©å±•æœºåˆ¶

### è‡ªå®šä¹‰æ‰§è¡Œå™¨

```go
type MyExecutor struct {
    name string
}

func (e *MyExecutor) Execute(ctx context.Context, params interface{}) error {
    // å®ç°è‡ªå®šä¹‰æ‰§è¡Œé€»è¾‘
    return nil
}

func (e *MyExecutor) GetName() string {
    return e.name
}
```

### è‡ªå®šä¹‰å­˜å‚¨åç«¯

```go
type MyStorage struct {
    // å­˜å‚¨å®ç°
}

func (s *MyStorage) SaveTaskConfig(config *TaskConfig) error {
    // å®ç°é…ç½®ä¿å­˜é€»è¾‘
    return nil
}

// å®ç° TaskStorage æ¥å£çš„å…¶ä»–æ–¹æ³•...
```

## æ€§èƒ½ç‰¹æ€§

- **å†…å­˜é«˜æ•ˆ**: ä½¿ç”¨å¯¹è±¡æ± å’Œå»¶è¿ŸåŠ è½½å‡å°‘å†…å­˜åˆ†é…
- **å¹¶å‘å®‰å…¨**: é‡‡ç”¨è¯»å†™é”å’Œæ— é”æ•°æ®ç»“æ„ä¼˜åŒ–å¹¶å‘æ€§èƒ½
- **è°ƒåº¦ç²¾ç¡®**: åŸºäºç³»ç»Ÿå®šæ—¶å™¨å®ç°ç²¾ç¡®çš„ä»»åŠ¡è°ƒåº¦
- **èµ„æºæ§åˆ¶**: é€šè¿‡å·¥ä½œçº¿ç¨‹æ± å’Œé˜Ÿåˆ—å¤§å°æ§åˆ¶ç³»ç»Ÿèµ„æºä½¿ç”¨

## æ³¨æ„äº‹é¡¹

- è°ƒåº¦å™¨åœæ­¢åï¼Œæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ä¼šç­‰å¾…å®Œæˆ
- Cronè¡¨è¾¾å¼ä½¿ç”¨UTCæ—¶é—´ï¼Œè¯·æ³¨æ„æ—¶åŒºé—®é¢˜
- å†…å­˜å­˜å‚¨é‡å¯åæ•°æ®ä¼šä¸¢å¤±ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨æŒä¹…åŒ–å­˜å‚¨
- ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿å¯èƒ½å½±å“å…¶ä»–ä»»åŠ¡çš„è°ƒåº¦ç²¾åº¦
- å»ºè®®åˆç†è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°å’Œé˜Ÿåˆ—å¤§å°ï¼Œé¿å…ç³»ç»Ÿèµ„æºè€—å°½ 