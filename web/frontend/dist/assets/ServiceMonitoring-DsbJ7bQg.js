import{d as Z,T as L,aC as lt,P as xe,R as Oe,ay as rt,V as st,W as Ze,dp as it,Z as ct,j as G,c8 as ut,c7 as dt,c9 as mt,c6 as pt,aJ as Ge,af as vt,m as _e,r as C,z as K,A as Q,B as ee,d5 as yt,aO as Se,bV as te,aa as Y,p as se,q as pe,c as W,o as E,b as t,a9 as Ce,w as m,G as ht,H as Fe,e as a,i as ne,cq as Ee,J as le,K as O,t as D,a7 as V,M as X,av as ze,h as ge,f as S,a5 as et,ac as fe,_ as ie,C as He,D as qe,g as $e,n as Xe,a8 as Ue,ab as Je}from"./index-B5iwLEhr.js";import{S as ft}from"./ServerOutline-D0nXs2bi.js";import{R as ve}from"./RefreshOutline-Ca-9cWyP.js";import{_ as Pe}from"./Select-DZOKbeI6.js";import{_ as tt,i as gt,a as at}from"./index-ysO7SyTO.js";import{_ as xt}from"./DataTable-BP0rWkt1.js";import{u as Re,b as Ie,c as Me,d as De,e as Ae,a as ke,g as Ne,i as oe}from"./installCanvasRenderer-Bdf8yIjj.js";import{N as Be}from"./DatePicker-BYwGRPWG.js";import{_ as _t,a as bt}from"./Grid-CNbyDJRX.js";import{s as wt,a as Tt}from"./Radio-j9RXIevN.js";import{_ as We}from"./RadioGroup-CXVTQ2cd.js";import{A as St}from"./ArrowBackOutline-C5QuifMF.js";import"./Checkbox-CEPM1LtD.js";import"./prop-NnGblK-3.js";import"./download-C2161hUv.js";const Ve=Z({name:"RadioButton",props:Tt,setup:wt,render(){const{mergedClsPrefix:i}=this;return L("label",{class:[`${i}-radio-button`,this.mergedDisabled&&`${i}-radio-button--disabled`,this.renderSafeChecked&&`${i}-radio-button--checked`,this.focus&&[`${i}-radio-button--focus`]]},L("input",{ref:"inputRef",type:"radio",class:`${i}-radio-input`,value:this.value,name:this.mergedName,checked:this.renderSafeChecked,disabled:this.mergedDisabled,onChange:this.handleRadioInputChange,onFocus:this.handleRadioInputFocus,onBlur:this.handleRadioInputBlur}),L("div",{class:`${i}-radio-button__state-border`}),lt(this.$slots.default,c=>!c&&!this.label?null:L("div",{ref:"labelRef",class:`${i}-radio__label`},c||this.label)))}});function Ct(){return L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},L("path",{fill:"#EF9645",d:"M15.5 2.965c1.381 0 2.5 1.119 2.5 2.5v.005L20.5.465c1.381 0 2.5 1.119 2.5 2.5V4.25l2.5-1.535c1.381 0 2.5 1.119 2.5 2.5V8.75L29 18H15.458L15.5 2.965z"}),L("path",{fill:"#FFDC5D",d:"M4.625 16.219c1.381-.611 3.354.208 4.75 2.188.917 1.3 1.187 3.151 2.391 3.344.46.073 1.234-.313 1.234-1.397V4.5s0-2 2-2 2 2 2 2v11.633c0-.029 1-.064 1-.082V2s0-2 2-2 2 2 2 2v14.053c0 .017 1 .041 1 .069V4.25s0-2 2-2 2 2 2 2v12.638c0 .118 1 .251 1 .398V8.75s0-2 2-2 2 2 2 2V24c0 6.627-5.373 12-12 12-4.775 0-8.06-2.598-9.896-5.292C8.547 28.423 8.096 26.051 8 25.334c0 0-.123-1.479-1.156-2.865-1.469-1.969-2.5-3.156-3.125-3.866-.317-.359-.625-1.707.906-2.384z"}))}function zt(){return L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},L("circle",{fill:"#FFCB4C",cx:"18",cy:"17.018",r:"17"}),L("path",{fill:"#65471B",d:"M14.524 21.036c-.145-.116-.258-.274-.312-.464-.134-.46.13-.918.59-1.021 4.528-1.021 7.577 1.363 7.706 1.465.384.306.459.845.173 1.205-.286.358-.828.401-1.211.097-.11-.084-2.523-1.923-6.182-1.098-.274.061-.554-.016-.764-.184z"}),L("ellipse",{fill:"#65471B",cx:"13.119",cy:"11.174",rx:"2.125",ry:"2.656"}),L("ellipse",{fill:"#65471B",cx:"24.375",cy:"12.236",rx:"2.125",ry:"2.656"}),L("path",{fill:"#F19020",d:"M17.276 35.149s1.265-.411 1.429-1.352c.173-.972-.624-1.167-.624-1.167s1.041-.208 1.172-1.376c.123-1.101-.861-1.363-.861-1.363s.97-.4 1.016-1.539c.038-.959-.995-1.428-.995-1.428s5.038-1.221 5.556-1.341c.516-.12 1.32-.615 1.069-1.694-.249-1.08-1.204-1.118-1.697-1.003-.494.115-6.744 1.566-8.9 2.068l-1.439.334c-.54.127-.785-.11-.404-.512.508-.536.833-1.129.946-2.113.119-1.035-.232-2.313-.433-2.809-.374-.921-1.005-1.649-1.734-1.899-1.137-.39-1.945.321-1.542 1.561.604 1.854.208 3.375-.833 4.293-2.449 2.157-3.588 3.695-2.83 6.973.828 3.575 4.377 5.876 7.952 5.048l3.152-.681z"}),L("path",{fill:"#65471B",d:"M9.296 6.351c-.164-.088-.303-.224-.391-.399-.216-.428-.04-.927.393-1.112 4.266-1.831 7.699-.043 7.843.034.433.231.608.747.391 1.154-.216.405-.74.546-1.173.318-.123-.063-2.832-1.432-6.278.047-.257.109-.547.085-.785-.042zm12.135 3.75c-.156-.098-.286-.243-.362-.424-.187-.442.023-.927.468-1.084 4.381-1.536 7.685.48 7.823.567.415.26.555.787.312 1.178-.242.39-.776.495-1.191.238-.12-.072-2.727-1.621-6.267-.379-.266.091-.553.046-.783-.096z"}))}function $t(){return L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},L("ellipse",{fill:"#292F33",cx:"18",cy:"26",rx:"18",ry:"10"}),L("ellipse",{fill:"#66757F",cx:"18",cy:"24",rx:"18",ry:"10"}),L("path",{fill:"#E1E8ED",d:"M18 31C3.042 31 1 16 1 12h34c0 2-1.958 19-17 19z"}),L("path",{fill:"#77B255",d:"M35 12.056c0 5.216-7.611 9.444-17 9.444S1 17.271 1 12.056C1 6.84 8.611 3.611 18 3.611s17 3.229 17 8.445z"}),L("ellipse",{fill:"#A6D388",cx:"18",cy:"13",rx:"15",ry:"7"}),L("path",{d:"M21 17c-.256 0-.512-.098-.707-.293-2.337-2.337-2.376-4.885-.125-8.262.739-1.109.9-2.246.478-3.377-.461-1.236-1.438-1.996-1.731-2.077-.553 0-.958-.443-.958-.996 0-.552.491-.995 1.043-.995.997 0 2.395 1.153 3.183 2.625 1.034 1.933.91 4.039-.351 5.929-1.961 2.942-1.531 4.332-.125 5.738.391.391.391 1.023 0 1.414-.195.196-.451.294-.707.294zm-6-2c-.256 0-.512-.098-.707-.293-2.337-2.337-2.376-4.885-.125-8.262.727-1.091.893-2.083.494-2.947-.444-.961-1.431-1.469-1.684-1.499-.552 0-.989-.447-.989-1 0-.552.458-1 1.011-1 .997 0 2.585.974 3.36 2.423.481.899 1.052 2.761-.528 5.131-1.961 2.942-1.531 4.332-.125 5.738.391.391.391 1.023 0 1.414-.195.197-.451.295-.707.295z",fill:"#5C913B"}))}function Rt(){return L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},L("path",{fill:"#FFCC4D",d:"M36 18c0 9.941-8.059 18-18 18-9.94 0-18-8.059-18-18C0 8.06 8.06 0 18 0c9.941 0 18 8.06 18 18"}),L("ellipse",{fill:"#664500",cx:"18",cy:"27",rx:"5",ry:"6"}),L("path",{fill:"#664500",d:"M5.999 11c-.208 0-.419-.065-.599-.2-.442-.331-.531-.958-.2-1.4C8.462 5.05 12.816 5 13 5c.552 0 1 .448 1 1 0 .551-.445.998-.996 1-.155.002-3.568.086-6.204 3.6-.196.262-.497.4-.801.4zm24.002 0c-.305 0-.604-.138-.801-.4-2.64-3.521-6.061-3.598-6.206-3.6-.55-.006-.994-.456-.991-1.005C22.006 5.444 22.45 5 23 5c.184 0 4.537.05 7.8 4.4.332.442.242 1.069-.2 1.4-.18.135-.39.2-.599.2zm-16.087 4.5l1.793-1.793c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0L12.5 14.086l-1.793-1.793c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.793 1.793-1.793 1.793c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l1.793-1.793 1.793 1.793c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414L13.914 15.5zm11 0l1.793-1.793c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0L23.5 14.086l-1.793-1.793c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.793 1.793-1.793 1.793c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l1.793-1.793 1.793 1.793c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414L24.914 15.5z"}))}const It=xe("result",`
 color: var(--n-text-color);
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 transition:
 color .3s var(--n-bezier);
`,[xe("result-icon",`
 display: flex;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `,[Oe("status-image",`
 font-size: var(--n-icon-size);
 width: 1em;
 height: 1em;
 `),xe("base-icon",`
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),xe("result-content",{marginTop:"24px"}),xe("result-footer",`
 margin-top: 24px;
 text-align: center;
 `),xe("result-header",[Oe("title",`
 margin-top: 16px;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 text-align: center;
 color: var(--n-title-text-color);
 font-size: var(--n-title-font-size);
 `),Oe("description",`
 margin-top: 4px;
 text-align: center;
 font-size: var(--n-font-size);
 `)])]),Mt={403:Ct,404:zt,418:$t,500:Rt,info:()=>L(pt,null),success:()=>L(mt,null),warning:()=>L(dt,null),error:()=>L(ut,null)},Dt=Object.assign(Object.assign({},Ze.props),{size:{type:String,default:"medium"},status:{type:String,default:"info"},title:String,description:String}),At=Z({name:"Result",props:Dt,slots:Object,setup(i){const{mergedClsPrefixRef:c,inlineThemeDisabled:l}=st(i),_=Ze("Result","-result",It,it,i,c),p=G(()=>{const{size:x,status:b}=i,{common:{cubicBezierEaseInOut:f},self:{textColor:B,lineHeight:I,titleTextColor:k,titleFontWeight:z,[Ge("iconColor",b)]:M,[Ge("fontSize",x)]:A,[Ge("titleFontSize",x)]:r,[Ge("iconSize",x)]:h}}=_.value;return{"--n-bezier":f,"--n-font-size":A,"--n-icon-size":h,"--n-line-height":I,"--n-text-color":B,"--n-title-font-size":r,"--n-title-font-weight":z,"--n-title-text-color":k,"--n-icon-color":M||""}}),u=l?ct("result",G(()=>{const{size:x,status:b}=i;let f="";return x&&(f+=x[0]),b&&(f+=b[0]),f}),p,i):void 0;return{mergedClsPrefix:c,cssVars:l?void 0:p,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender}},render(){var i;const{status:c,$slots:l,mergedClsPrefix:_,onRender:p}=this;return p==null||p(),L("div",{class:[`${_}-result`,this.themeClass],style:this.cssVars},L("div",{class:`${_}-result-icon`},((i=l.icon)===null||i===void 0?void 0:i.call(l))||L(rt,{clsPrefix:_},{default:()=>Mt[c]()})),L("div",{class:`${_}-result-header`},this.title?L("div",{class:`${_}-result-header__title`},this.title):null,this.description?L("div",{class:`${_}-result-header__description`},this.description):null),l.default&&L("div",{class:`${_}-result-content`},l),l.footer&&L("div",{class:`${_}-result-footer`},l.footer()))}}),ae=vt("/gateway/hub0042"),kt=async i=>ae.post("/queryJvmResources",i),Nt=async i=>ae.post("/getJvmResourceDetail",{jvmResourceId:i}),Bt=async i=>ae.post("/getJvmOverview",{jvmResourceId:i}),ot=async i=>ae.post("/queryMemory",i),Lt=async i=>ae.post("/queryMemoryPools",i),jt=async i=>ae.post("/queryGCSnapshots",i),Gt=async i=>ae.post("/getLatestGCSnapshot",{jvmResourceId:i}),Pt=async i=>ae.post("/getGcTrend",i),Ot=async i=>ae.post("/queryThreads",i),Ft=async i=>ae.post("/getThreadState",{jvmThreadId:i}),Et=async i=>ae.post("/queryThreadStates",i),Ht=async i=>ae.post("/queryDeadlocks",i),Ye=async i=>ae.post("/queryAppMonitorData",i);function nt(){const i=_e(),c=C(!1),l=C([]),_=C(null),p=C(null),u=C(0),x=C({pageNum:1,pageSize:20}),b=async h=>{c.value=!0;try{h&&(x.value={...x.value,...h});const s=await kt(x.value);if(K(s)){l.value=Q(s,[]);try{const o=yt(s);u.value=o.totalCount||0}catch(o){console.warn("解析分页信息失败:",o),u.value=l.value.length}}else i.error(ee(s,"查询JVM资源列表失败"))}catch(s){console.error("查询JVM资源列表失败:",s),i.error("查询JVM资源列表失败")}finally{c.value=!1}},f=async h=>{c.value=!0;try{const s=await Nt(h);if(K(s)){const o=Q(s,null);return _.value=o,o}else return i.error(ee(s,"获取JVM资源详情失败")),null}catch(s){return console.error("获取JVM资源详情失败:",s),i.error("获取JVM资源详情失败"),null}finally{c.value=!1}},B=async h=>{c.value=!0;try{const s=await Bt(h);if(K(s)){const o=Q(s,null);return p.value=o,o}else return i.error(ee(s,"获取JVM监控详情失败")),null}catch(s){return console.error("获取JVM监控详情失败:",s),i.error("获取JVM监控详情失败"),null}finally{c.value=!1}},I=()=>{b()},k=()=>{x.value={pageNum:1,pageSize:20},b()},z=G(()=>l.value.length>0),M=G(()=>l.value.filter(h=>h.healthyFlag==="Y").length),A=G(()=>l.value.filter(h=>h.healthyFlag==="N").length),r=G(()=>l.value.filter(h=>h.requiresAttentionFlag==="Y").length);return{loading:c,jvmResources:l,currentResource:_,monitorDetail:p,total:u,queryParams:x,hasData:z,healthyCount:M,unhealthyCount:A,attentionCount:r,queryJvmResources:b,getJvmResource:f,getJvmMonitorDetail:B,refresh:I,resetQuery:k}}function qt(){const i=_e(),c=C(!1),l=C([]),_=C(null),p=C([]),u=async r=>{c.value=!0;try{const h=await jt(r);K(h)?l.value=Q(h,[]):i.error(ee(h,"查询GC快照失败"))}catch(h){console.error("查询GC快照失败:",h),i.error("查询GC快照失败")}finally{c.value=!1}},x=async r=>{c.value=!0;try{const h=await Gt(r);if(K(h)){const s=Q(h,null);return _.value=s,s}else return i.error(ee(h,"获取最新GC快照失败")),null}catch(h){return console.error("获取最新GC快照失败:",h),i.error("获取最新GC快照失败"),null}finally{c.value=!1}},b=async r=>{c.value=!0;try{const h=await Pt(r);K(h)?p.value=Q(h,[]):i.error(ee(h,"获取GC趋势失败"))}catch(h){console.error("获取GC趋势失败:",h),i.error("获取GC趋势失败")}finally{c.value=!1}},f=G(()=>{var r;return((r=_.value)==null?void 0:r.collectionCount)||0}),B=G(()=>{var r;return((r=_.value)==null?void 0:r.collectionTimeMs)||0}),I=G(()=>{var r;return((r=_.value)==null?void 0:r.ygc)||0}),k=G(()=>{var r;return((r=_.value)==null?void 0:r.fgc)||0}),z=G(()=>!_.value||_.value.collectionCount===0?0:_.value.collectionTimeMs/_.value.collectionCount);return{loading:c,gcSnapshots:l,latestGcSnapshot:_,gcTrend:p,totalGcCount:f,totalGcTime:B,youngGcCount:I,fullGcCount:k,avgGcTime:z,queryGcSnapshots:u,getLatestGcSnapshot:x,getGcTrend:b,formatGcTime:r=>(r/1e3).toFixed(3)+"s",calculateUsagePercent:(r,h)=>h===0?0:Number((r/h*100).toFixed(2))}}function Ut(){const i=_e(),c=C(!1),l=C(null),_=C([]),p=C(null),u=C([]),x=C([]),b=async o=>{c.value=!0;try{const n=await Ot(o);if(K(n)){const e=Q(n,[]);o.startTime&&o.endTime?_.value=e:l.value=Array.isArray(e)&&e.length>0?e[0]:e}else i.error(ee(n,"查询线程信息失败"))}catch(n){console.error("查询线程信息失败:",n),i.error("查询线程信息失败")}finally{c.value=!1}},f=async o=>{c.value=!0;try{const n=await Ft(o);if(K(n)){const e=Q(n,null);return p.value=e,e}else return i.error(ee(n,"获取线程状态失败")),null}catch(n){return console.error("获取线程状态失败:",n),i.error("获取线程状态失败"),null}finally{c.value=!1}},B=async o=>{c.value=!0;try{const n=await Et(o);K(n)?u.value=Q(n,[]):i.error(ee(n,"查询线程状态列表失败"))}catch(n){console.error("查询线程状态列表失败:",n),i.error("查询线程状态列表失败")}finally{c.value=!1}},I=async o=>{c.value=!0;try{const n=await Ht(o);K(n)?x.value=Q(n,[]):i.error(ee(n,"查询死锁信息失败"))}catch(n){console.error("查询死锁信息失败:",n),i.error("查询死锁信息失败")}finally{c.value=!1}},k=G(()=>x.value.some(o=>o.hasDeadlockFlag==="Y")),z=G(()=>{var o;return((o=p.value)==null?void 0:o.runnableThreadCount)||0}),M=G(()=>{var o;return((o=p.value)==null?void 0:o.blockedThreadCount)||0}),A=G(()=>{var o,n;return(((o=p.value)==null?void 0:o.waitingThreadCount)||0)+(((n=p.value)==null?void 0:n.timedWaitingThreadCount)||0)}),r=G(()=>p.value?[{name:"NEW",value:p.value.newThreadCount,type:"info"},{name:"RUNNABLE",value:p.value.runnableThreadCount,type:"success"},{name:"BLOCKED",value:p.value.blockedThreadCount,type:"error"},{name:"WAITING",value:p.value.waitingThreadCount,type:"warning"},{name:"TIMED_WAITING",value:p.value.timedWaitingThreadCount,type:"warning"},{name:"TERMINATED",value:p.value.terminatedThreadCount,type:"default"}]:[]),h=G(()=>!_.value||!u.value||!Array.isArray(_.value)||!Array.isArray(u.value)||_.value.length===0||u.value.length===0?[]:_.value.map((o,n)=>{const e=u.value[n];return{time:(o==null?void 0:o.collectionTime)||"",currentThreadCount:(o==null?void 0:o.currentThreadCount)||0,peakThreadCount:(o==null?void 0:o.peakThreadCount)||0,daemonThreadCount:(o==null?void 0:o.daemonThreadCount)||0,userThreadCount:(o==null?void 0:o.userThreadCount)||0,activeThreadCount:(e==null?void 0:e.runnableThreadCount)||0,blockedThreadCount:(e==null?void 0:e.blockedThreadCount)||0,waitingThreadCount:((e==null?void 0:e.waitingThreadCount)||0)+((e==null?void 0:e.timedWaitingThreadCount)||0),activeThreadRatioPercent:(e==null?void 0:e.activeThreadRatioPercent)||0,blockedThreadRatioPercent:(e==null?void 0:e.blockedThreadRatioPercent)||0,waitingThreadRatioPercent:(e==null?void 0:e.waitingThreadRatioPercent)||0}})),s=G(()=>!u.value||!Array.isArray(u.value)?[]:u.value.map(o=>({time:(o==null?void 0:o.collectionTime)||"",newThreadCount:(o==null?void 0:o.newThreadCount)||0,runnableThreadCount:(o==null?void 0:o.runnableThreadCount)||0,blockedThreadCount:(o==null?void 0:o.blockedThreadCount)||0,waitingThreadCount:(o==null?void 0:o.waitingThreadCount)||0,timedWaitingThreadCount:(o==null?void 0:o.timedWaitingThreadCount)||0,terminatedThreadCount:(o==null?void 0:o.terminatedThreadCount)||0,totalThreadCount:(o==null?void 0:o.totalThreadCount)||0})));return{loading:c,threadInfo:l,threadInfoList:_,threadState:p,threadStateList:u,deadlocks:x,hasDeadlock:k,activeThreads:z,blockedThreads:M,waitingThreads:A,threadStateDistribution:r,threadTrendData:h,threadStateTrendData:s,queryThreadInfo:b,getThreadState:f,queryThreadStates:B,queryDeadlocks:I}}const Jt=i=>[{title:i("jvmResourceId"),key:"jvmResourceId",width:200,ellipsis:{tooltip:!0}},{title:i("applicationName"),key:"applicationName",width:150,ellipsis:{tooltip:!0}},{title:i("groupName"),key:"groupName",width:120,ellipsis:{tooltip:!0}},{title:i("hostName"),key:"hostName",width:150,ellipsis:{tooltip:!0},render:c=>c.hostName||"-"},{title:i("hostIpAddress"),key:"hostIpAddress",width:140,ellipsis:{tooltip:!0},render:c=>c.hostIpAddress||"-"},{title:i("healthStatus"),key:"healthyFlag",width:120,render:c=>{const l=c.healthyFlag==="Y",_=c.requiresAttentionFlag==="Y";return L(te,{size:4},{default:()=>[L(Se,{type:l?"success":"error",size:"small"},{default:()=>i(l?"healthy":"unhealthy")}),_&&L(Se,{type:"warning",size:"small"},{default:()=>i("attention")})]})}},{title:i("healthGrade"),key:"healthGrade",width:100,render:c=>{if(!c.healthGrade)return"-";const _={EXCELLENT:{type:"success",text:i("excellent")},GOOD:{type:"success",text:i("good")},FAIR:{type:"warning",text:i("fair")},POOR:{type:"error",text:i("poor")},CRITICAL:{type:"error",text:i("critical")}}[c.healthGrade]||{type:"info",text:c.healthGrade};return L(Se,{type:_.type,size:"small"},{default:()=>_.text})}},{title:i("jvmUptime"),key:"jvmUptimeMs",width:130,render:c=>{const l=c.jvmUptimeMs,_=Math.floor(l/(1e3*60*60)),p=Math.floor(l%(1e3*60*60)/(1e3*60));if(_>24){const u=Math.floor(_/24),x=_%24;return`${u}${i("day")} ${x}${i("hour")}`}return`${_}${i("hour")} ${p}${i("minute")}`}},{title:i("jvmStartTime"),key:"jvmStartTime",width:180,ellipsis:{tooltip:!0},render:c=>{if(!c.jvmStartTime)return"-";try{return Y(c.jvmStartTime,"YYYY-MM-DD HH:mm:ss")}catch{return c.jvmStartTime}}},{title:i("collectionTime"),key:"collectionTime",width:180,ellipsis:{tooltip:!0},render:c=>{if(!c.collectionTime)return"-";try{return Y(c.collectionTime,"YYYY-MM-DD HH:mm:ss")}catch{return c.collectionTime}}},{title:i("summaryText"),key:"summaryText",width:200,ellipsis:{tooltip:!0}},{title:i("actions"),key:"actions",width:150,fixed:"right",render:(c,l)=>L(te,{size:4},{default:()=>[]})}],Wt={class:"jvm-resource-list"},Vt=Z({__name:"JvmResourceList",emits:["select"],setup(i,{emit:c}){const{t:l}=se("hub0042"),{loading:_,jvmResources:p,total:u,queryParams:x,healthyCount:b,unhealthyCount:f,attentionCount:B,queryJvmResources:I,resetQuery:k}=nt(),z=C({applicationName:"",groupName:"",hostIpAddress:"",healthyFlag:null}),M=G(()=>[{label:l("healthy"),value:"Y"},{label:l("unhealthy"),value:"N"}]),A=c,r=G(()=>{const y=Jt(l),$=y.find(T=>"key"in T&&T.key==="actions");return $&&"render"in $&&$.render&&($.render,$.render=T=>L(le,{type:"primary",size:"small",onClick:()=>h(T)},{default:()=>l("monitoringDetail")})),y}),h=y=>{A("select",y)},s=G(()=>({page:x.value.pageNum||1,pageSize:x.value.pageSize||20,itemCount:u.value,showSizePicker:!0,pageSizes:[10,20,50,100]})),o=()=>{I({applicationName:z.value.applicationName,groupName:z.value.groupName,hostIpAddress:z.value.hostIpAddress,healthyFlag:z.value.healthyFlag||void 0,pageNum:1})},n=()=>{z.value={applicationName:"",groupName:"",hostIpAddress:"",healthyFlag:null},k()},e=y=>{I({pageNum:y})},d=y=>{I({pageNum:1,pageSize:y})};return pe(()=>{I()}),(y,$)=>{const T=ne,g=ht,w=Pe,P=te,j=Ce,F=tt,U=Se,re=xt;return E(),W("div",Wt,[t(j,{bordered:!1,class:"search-card"},{default:m(()=>[t(P,{vertical:"",size:16},{default:m(()=>[t(P,{size:12,wrap:""},{default:m(()=>[t(g,{value:z.value.applicationName,"onUpdate:value":$[0]||($[0]=H=>z.value.applicationName=H),placeholder:a(l)("searchByApplicationName"),clearable:"",style:{width:"200px"},onKeyup:Fe(o,["enter"])},{prefix:m(()=>[t(T,{component:a(Ee)},null,8,["component"])]),_:1},8,["value","placeholder"]),t(g,{value:z.value.groupName,"onUpdate:value":$[1]||($[1]=H=>z.value.groupName=H),placeholder:a(l)("searchByGroupName"),clearable:"",style:{width:"180px"},onKeyup:Fe(o,["enter"])},{prefix:m(()=>[t(T,{component:a(Ee)},null,8,["component"])]),_:1},8,["value","placeholder"]),t(g,{value:z.value.hostIpAddress,"onUpdate:value":$[2]||($[2]=H=>z.value.hostIpAddress=H),placeholder:a(l)("searchByHostIp"),clearable:"",style:{width:"180px"},onKeyup:Fe(o,["enter"])},{prefix:m(()=>[t(T,{component:a(ft)},null,8,["component"])]),_:1},8,["value","placeholder"]),t(w,{value:z.value.healthyFlag,"onUpdate:value":$[3]||($[3]=H=>z.value.healthyFlag=H),options:M.value,placeholder:a(l)("selectHealthStatus"),clearable:"",style:{width:"150px"}},null,8,["value","options","placeholder"]),t(a(le),{type:"primary",onClick:o},{icon:m(()=>[t(T,{component:a(Ee)},null,8,["component"])]),default:m(()=>[O(" "+D(a(l)("search")),1)]),_:1}),t(a(le),{onClick:n},{icon:m(()=>[t(T,{component:a(ve)},null,8,["component"])]),default:m(()=>[O(" "+D(a(l)("reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(P,{size:16,style:{"margin-top":"16px"}},{default:m(()=>[t(j,{bordered:!1,style:{flex:"1"}},{default:m(()=>[t(F,{label:a(l)("totalJvmInstances"),value:a(u)},null,8,["label","value"])]),_:1}),t(j,{bordered:!1,style:{flex:"1"}},{default:m(()=>[t(F,{label:a(l)("healthyInstances"),value:a(b)},{suffix:m(()=>[t(U,{type:"success",size:"small"},{default:m(()=>[O(D(a(l)("healthy")),1)]),_:1})]),_:1},8,["label","value"])]),_:1}),t(j,{bordered:!1,style:{flex:"1"}},{default:m(()=>[t(F,{label:a(l)("unhealthyInstances"),value:a(f)},{suffix:m(()=>[t(U,{type:"error",size:"small"},{default:m(()=>[O(D(a(l)("unhealthy")),1)]),_:1})]),_:1},8,["label","value"])]),_:1}),t(j,{bordered:!1,style:{flex:"1"}},{default:m(()=>[t(F,{label:a(l)("attentionRequired"),value:a(B)},{suffix:m(()=>[t(U,{type:"warning",size:"small"},{default:m(()=>[O(D(a(l)("attention")),1)]),_:1})]),_:1},8,["label","value"])]),_:1})]),_:1}),t(j,{bordered:!1,style:{"margin-top":"16px"}},{default:m(()=>[t(re,{columns:r.value,data:a(p),loading:a(_),pagination:s.value,"scroll-x":1940,"onUpdate:page":e,"onUpdate:pageSize":d},null,8,["columns","data","loading","pagination"])]),_:1})])}}}),Yt={class:"heap-memory-chart"},Kt={key:0,class:"memory-overview"},Qt={class:"memory-stat"},Xt={class:"memory-stat"},Zt={class:"stat-value"},ea={class:"memory-stat"},ta={class:"stat-value"},aa={class:"memory-stat"},oa={class:"stat-value"},na={class:"chart-header"},la={class:"chart-controls"},ra={class:"chart-content"},sa=Z({__name:"HeapMemoryChart",props:{jvmResourceId:{}},setup(i){Re([Ie,Me,De,Ae,gt,ke,Ne]);const c=i,{t:l}=se("hub0042"),_=_e(),p=C(!1),u=C([]),x=C(null),b=C();let f=null;const B=G(()=>{if(u.value.length===0)return null;const e=u.value[u.value.length-1];return{usagePercent:e.value,usedMemoryBytes:e.usedMemoryBytes,committedMemoryBytes:e.committedMemoryBytes,maxMemoryBytes:e.maxMemoryBytes||-1,initMemoryBytes:e.initMemoryBytes||0}}),I={最近2小时:()=>{const e=Date.now();return[e-7200*1e3,e]},最近6小时:()=>{const e=Date.now();return[e-360*60*1e3,e]},最近24小时:()=>{const e=Date.now();return[e-1440*60*1e3,e]},最近7天:()=>{const e=Date.now();return[e-10080*60*1e3,e]}},k=async()=>{if(!(!c.jvmResourceId||!x.value)){p.value=!0;try{const[e,d]=x.value,y=await ot({jvmResourceId:c.jvmResourceId,memoryType:"HEAP",startTime:Y(e),endTime:Y(d)});if(K(y)){const $=Q(y,[]);$&&Array.isArray($)&&(u.value=$.map(T=>({time:T.collectionTime,value:T.usagePercent,usedMemoryBytes:T.usedMemoryBytes,committedMemoryBytes:T.committedMemoryBytes,maxMemoryBytes:T.maxMemoryBytes,initMemoryBytes:T.initMemoryBytes})))}else _.error(ee(y,"查询堆内存趋势数据失败"))}catch(e){console.error("查询堆内存趋势数据失败:",e),_.error("查询堆内存趋势数据失败")}finally{p.value=!1}}},z=e=>{if(e<0)return"N/A";if(e===0)return"0 B";const d=1024,y=["B","KB","MB","GB","TB"],$=Math.floor(Math.log(e)/Math.log(d));return`${(e/Math.pow(d,$)).toFixed(2)} ${y[$]}`},M=e=>e>=90?"#ff4d4f":e>=75?"#faad14":"#52c41a",A=G(()=>{const e=u.value.map(y=>new Date(y.time).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})),d=u.value.map(y=>y.value);return{tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:y=>{if(!Array.isArray(y)||y.length===0)return"";const $=y[0].dataIndex,T=u.value[$],g=y[0].name,w=T.value,P=T.usedMemoryBytes||0,j=T.committedMemoryBytes||0;return`
          <div style="font-size: 12px;">
            <div style="font-weight: bold; margin-bottom: 6px;">${g}</div>
            <div style="margin-bottom: 3px;">
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: #1890ff; border-radius: 50%;"></span>
              <span>使用率: ${w.toFixed(2)}%</span>
            </div>
            <div style="margin-bottom: 3px;">
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: #1890ff; border-radius: 50%; opacity: 0.6;"></span>
              <span>使用量: ${z(P)}</span>
            </div>
            <div>
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: #faad14; border-radius: 50%;"></span>
              <span>提交量: ${z(j)}</span>
            </div>
          </div>
        `}},grid:{left:"10px",right:"30px",bottom:"50px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e,axisLabel:{fontSize:13,rotate:0,color:"#595959"},axisLine:{lineStyle:{color:"#d9d9d9"}}},yAxis:{type:"value",axisLabel:{fontSize:13,color:"#595959",formatter:y=>`${y}%`},axisLine:{lineStyle:{color:"#d9d9d9"}},splitLine:{lineStyle:{color:"#f0f0f0"}}},series:[{name:l("heapMemory"),type:"line",data:d,smooth:!0,symbol:"circle",symbolSize:4,lineStyle:{color:"#1890ff",width:2},itemStyle:{color:"#1890ff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#1890ff40"},{offset:1,color:"#1890ff10"}]}},markLine:{silent:!0,symbol:"none",data:[{yAxis:75,lineStyle:{color:"#faad14",type:"dashed",width:1},label:{formatter:"警告: 75%",fontSize:10}},{yAxis:90,lineStyle:{color:"#ff4d4f",type:"dashed",width:1},label:{formatter:"危险: 90%",fontSize:10}}]}}]}}),r=()=>{if(!b.value)return;const{clientWidth:e,clientHeight:d}=b.value;if(e===0||d===0){setTimeout(()=>r(),100);return}f&&f.dispose(),f=oe(b.value),f.setOption(A.value),window.addEventListener("resize",s)},h=()=>{f?f.setOption(A.value):r()},s=()=>{f&&f.resize()},o=async()=>{x.value&&await k()},n=e=>{x.value=e,e&&k()};return V(()=>c.jvmResourceId,async(e,d)=>{e&&e!==d&&(u.value=[],x.value&&await k())}),V(()=>u.value,()=>{X(()=>{h()})},{deep:!0}),pe(()=>{X(()=>{r()});const e=Date.now();x.value=[e-7200*1e3,e],c.jvmResourceId&&x.value&&k()}),ze(()=>{f&&(f.dispose(),f=null),window.removeEventListener("resize",s)}),(e,d)=>(E(),W("div",Yt,[B.value?(E(),W("div",Kt,[t(a(te),{size:24},{default:m(()=>[S("div",Qt,[d[1]||(d[1]=S("div",{class:"stat-label"},"当前使用率",-1)),S("div",{class:"stat-value",style:et({color:M(B.value.usagePercent)})},D(B.value.usagePercent.toFixed(2))+"% ",5)]),t(a(fe),{vertical:""}),S("div",Xt,[d[2]||(d[2]=S("div",{class:"stat-label"},"已使用",-1)),S("div",Zt,D(z(B.value.usedMemoryBytes)),1)]),t(a(fe),{vertical:""}),S("div",ea,[d[3]||(d[3]=S("div",{class:"stat-label"},"已提交",-1)),S("div",ta,D(z(B.value.committedMemoryBytes)),1)]),t(a(fe),{vertical:""}),S("div",aa,[d[4]||(d[4]=S("div",{class:"stat-label"},"最大值",-1)),S("div",oa,D(B.value.maxMemoryBytes>0?z(B.value.maxMemoryBytes):"无限制"),1)])]),_:1})])):ge("",!0),S("div",na,[S("div",la,[t(a(Be),{value:x.value,"onUpdate:value":[d[0]||(d[0]=y=>x.value=y),n],type:"datetimerange",shortcuts:I,placeholder:"选择时间范围",size:"small",style:{width:"280px"},clearable:""},null,8,["value"]),t(a(le),{size:"small",onClick:o,loading:p.value},{icon:m(()=>[t(a(ne),{component:a(ve)},null,8,["component"])]),_:1},8,["loading"])])]),S("div",ra,[S("div",{ref_key:"chartRef",ref:b,style:{width:"100%",height:"300px"}},null,512)])]))}}),ia=ie(sa,[["__scopeId","data-v-4e8034b3"]]),ca={class:"non-heap-memory-chart"},ua={key:0,class:"memory-overview"},da={class:"memory-stat"},ma={class:"memory-stat"},pa={class:"stat-value"},va={class:"memory-stat"},ya={class:"stat-value"},ha={class:"memory-stat"},fa={class:"stat-value"},ga={class:"chart-header"},xa={class:"chart-controls"},_a={class:"chart-content"},ba=Z({__name:"NonHeapMemoryChart",props:{jvmResourceId:{}},setup(i){Re([Ie,Me,De,Ae,ke,Ne]);const c=i;se("hub0042");const l=_e(),_=C(!1),p=C([]),u=C(null),x=C();let b=null;const f=G(()=>{if(p.value.length===0)return null;const n=p.value[p.value.length-1];return{usagePercent:n.value,usedMemoryBytes:n.usedMemoryBytes,committedMemoryBytes:n.committedMemoryBytes,maxMemoryBytes:n.maxMemoryBytes||-1,initMemoryBytes:n.initMemoryBytes||0}}),B={最近2小时:()=>{const n=Date.now();return[n-7200*1e3,n]},最近6小时:()=>{const n=Date.now();return[n-360*60*1e3,n]},最近24小时:()=>{const n=Date.now();return[n-1440*60*1e3,n]},最近7天:()=>{const n=Date.now();return[n-10080*60*1e3,n]}},I=async()=>{if(!(!c.jvmResourceId||!u.value)){_.value=!0;try{const[n,e]=u.value,d=await ot({jvmResourceId:c.jvmResourceId,memoryType:"NON_HEAP",startTime:Y(n),endTime:Y(e)});if(K(d)){const y=Q(d,[]);y&&Array.isArray(y)&&(p.value=y.map($=>({time:$.collectionTime,value:$.usagePercent,usedMemoryBytes:$.usedMemoryBytes,committedMemoryBytes:$.committedMemoryBytes,maxMemoryBytes:$.maxMemoryBytes,initMemoryBytes:$.initMemoryBytes})))}else l.error(ee(d,"查询非堆内存趋势数据失败"))}catch(n){console.error("查询非堆内存趋势数据失败:",n),l.error("查询非堆内存趋势数据失败")}finally{_.value=!1}}},k=n=>{if(n<0)return"N/A";if(n===0)return"0 B";const e=1024,d=["B","KB","MB","GB","TB"],y=Math.floor(Math.log(n)/Math.log(e));return`${(n/Math.pow(e,y)).toFixed(2)} ${d[y]}`},z=n=>n>=90?"#ff4d4f":n>=75?"#faad14":"#52c41a",M=G(()=>{const n=p.value.map(y=>new Date(y.time).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})),e=p.value.map(y=>y.usedMemoryBytes||0),d=p.value.map(y=>y.committedMemoryBytes||0);return{tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:y=>{if(!Array.isArray(y)||y.length===0)return"";const $=y[0].dataIndex,T=p.value[$],g=y[0].name,w=T.usedMemoryBytes||0,P=T.committedMemoryBytes||0;return`
          <div style="font-size: 12px;">
            <div style="font-weight: bold; margin-bottom: 6px;">${g}</div>
            <div style="margin-bottom: 3px;">
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: #1890ff; border-radius: 50%;"></span>
              <span>使用量: ${k(w)}</span>
            </div>
            <div>
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: #faad14; border-radius: 50%;"></span>
              <span>提交量: ${k(P)}</span>
            </div>
          </div>
        `}},grid:{left:"10px",right:"30px",bottom:"50px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:n,axisLabel:{fontSize:13,rotate:0,color:"#595959"},axisLine:{lineStyle:{color:"#d9d9d9"}}},yAxis:{type:"value",axisLabel:{fontSize:13,color:"#595959",formatter:y=>k(y)},axisLine:{lineStyle:{color:"#d9d9d9"}},splitLine:{lineStyle:{color:"#f0f0f0"}}},series:[{name:"使用量",type:"line",data:e,smooth:!0,symbol:"circle",symbolSize:4,lineStyle:{color:"#1890ff",width:2},itemStyle:{color:"#1890ff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#1890ff40"},{offset:1,color:"#1890ff10"}]}}},{name:"提交量",type:"line",data:d,smooth:!0,symbol:"diamond",symbolSize:5,lineStyle:{color:"#faad14",width:2,type:"dashed"},itemStyle:{color:"#faad14"}}]}}),A=()=>{if(!x.value)return;const{clientWidth:n,clientHeight:e}=x.value;if(n===0||e===0){setTimeout(()=>A(),100);return}b&&b.dispose(),b=oe(x.value),b.setOption(M.value),window.addEventListener("resize",h)},r=()=>{b?b.setOption(M.value):A()},h=()=>{b&&b.resize()},s=async()=>{u.value&&await I()},o=n=>{u.value=n,n&&I()};return V(()=>c.jvmResourceId,async(n,e)=>{n&&n!==e&&(p.value=[],u.value&&await I())}),V(()=>p.value,()=>{X(()=>{r()})},{deep:!0}),pe(()=>{X(()=>{A()});const n=Date.now();u.value=[n-7200*1e3,n],c.jvmResourceId&&u.value&&I()}),ze(()=>{b&&(b.dispose(),b=null),window.removeEventListener("resize",h)}),(n,e)=>(E(),W("div",ca,[f.value?(E(),W("div",ua,[t(a(te),{size:24},{default:m(()=>[S("div",da,[e[1]||(e[1]=S("div",{class:"stat-label"},"当前使用率",-1)),S("div",{class:"stat-value",style:et({color:z(f.value.usagePercent)})},D(f.value.usagePercent.toFixed(2))+"% ",5)]),t(a(fe),{vertical:""}),S("div",ma,[e[2]||(e[2]=S("div",{class:"stat-label"},"已使用",-1)),S("div",pa,D(k(f.value.usedMemoryBytes)),1)]),t(a(fe),{vertical:""}),S("div",va,[e[3]||(e[3]=S("div",{class:"stat-label"},"已提交",-1)),S("div",ya,D(k(f.value.committedMemoryBytes)),1)]),t(a(fe),{vertical:""}),S("div",ha,[e[4]||(e[4]=S("div",{class:"stat-label"},"最大值",-1)),S("div",fa,D(f.value.maxMemoryBytes>0?k(f.value.maxMemoryBytes):"无限制"),1)])]),_:1})])):ge("",!0),S("div",ga,[S("div",xa,[t(a(Be),{value:u.value,"onUpdate:value":[e[0]||(e[0]=d=>u.value=d),o],type:"datetimerange",shortcuts:B,placeholder:"选择时间范围",size:"small",style:{width:"280px"},clearable:""},null,8,["value"]),t(a(le),{size:"small",onClick:s,loading:_.value},{icon:m(()=>[t(a(ne),{component:a(ve)},null,8,["component"])]),_:1},8,["loading"])])]),S("div",_a,[S("div",{ref_key:"chartRef",ref:x,style:{width:"100%",height:"300px"}},null,512)])]))}}),wa=ie(ba,[["__scopeId","data-v-4a0059b5"]]),Ta={class:"memory-pool-chart"},Sa={class:"chart-header"},Ca={class:"chart-content"},za=Z({__name:"MemoryPoolChart",props:{jvmResourceId:{}},setup(i){Re([Ie,Me,De,Ae,ke,Ne]);const c=i,l=_e(),_=C(!1),p=C([]),u=C(null),x=C();let b=null;const f={最近1小时:()=>{const s=Date.now();return[s-3600*1e3,s]},最近2小时:()=>{const s=Date.now();return[s-7200*1e3,s]},最近6小时:()=>{const s=Date.now();return[s-360*60*1e3,s]},最近12小时:()=>{const s=Date.now();return[s-720*60*1e3,s]},最近24小时:()=>{const s=Date.now();return[s-1440*60*1e3,s]},最近7天:()=>{const s=Date.now();return[s-10080*60*1e3,s]}},B=s=>{if(s<0)return"N/A";if(s===0)return"0 B";const o=1024,n=["B","KB","MB","GB","TB"],e=Math.floor(Math.log(s)/Math.log(o));return`${(s/Math.pow(o,e)).toFixed(2)} ${n[e]}`},I=async()=>{if(!(!c.jvmResourceId||!u.value)){_.value=!0;try{const[s,o]=u.value,n=await Lt({jvmResourceId:c.jvmResourceId,startTime:Y(s),endTime:Y(o)});if(K(n)){const e=Q(n,[]);p.value=e&&Array.isArray(e)?e:[]}else l.error(ee(n,"查询内存池列表失败"))}catch(s){console.error("查询内存池列表失败:",s),l.error("查询内存池列表失败")}finally{_.value=!1}}},k=G(()=>{if(!p.value||p.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const s=new Map,o=new Set;if(p.value.forEach(T=>{let g=T.poolName;g.toLowerCase().includes("eden")?g="Eden Space":g.toLowerCase().includes("survivor")?g="Survivor Space":g.toLowerCase().includes("old")&&!g.includes("CodeHeap")?g="Old Generation":g==="Metaspace"?g="Metaspace":g==="Compressed Class Space"?g="Compressed Class Space":g.includes("CodeHeap")&&(g.includes("non-nmethods")?g="CodeHeap (non-nmethods)":g.includes("profiled nmethods")||g.includes("profiled-nmethods")?g="CodeHeap (profiled)":g.includes("non-profiled")?g="CodeHeap (non-profiled)":g="Code Cache"),s.has(g)||s.set(g,new Map);const w=s.get(g),P=T.collectionTime;w.has(P)||w.set(P,[]),w.get(P).push(T),o.add(P)}),s.size===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const n=Array.from(o).sort(),e=n.map(T=>new Date(T).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),d=["#1890ff","#52c41a","#faad14","#722ed1","#13c2c2","#f5222d","#eb2f96","#fa8c16","#2db7f5"],y=[],$=Array.from(s.entries());return $.forEach(([T,g],w)=>{const P=n.map(j=>{const F=g.get(j)||[];return F.length===0?null:F.reduce((U,re)=>U+re.currentUsedBytes,0)});y.push({name:T,type:"line",data:P,smooth:!0,symbol:"circle",symbolSize:6,connectNulls:!0,lineStyle:{width:2,color:d[w%d.length]},itemStyle:{color:d[w%d.length]},poolsAtTime:Object.fromEntries(Array.from(g.entries()).map(([j,F])=>[j,F]))})}),{tooltip:{trigger:"axis",axisPointer:{type:"cross"},confine:!1,enterable:!0,appendToBody:!0,position:function(T,g,w,P,j){const F=j.viewSize[0],U=j.viewSize[1],re=j.contentSize[0],H=j.contentSize[1],de=T[0],ye=T[1];let ce=de+15,me=ye-H/2;return de>F*.5&&(ce=de-re-20),me<10?me=10:me+H>U-10&&(me=U-H-10),[ce,me]},formatter:T=>{if(!Array.isArray(T)||T.length===0)return"";const g=T[0].dataIndex,w=n[g],P=T[0].name,j=B;let F=`
          <div style="max-height: 400px; max-width: 350px; overflow-y: auto; font-size: 12px; padding: 8px; background: white; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
            <div style="font-weight: bold; margin-bottom: 10px; padding-bottom: 6px; border-bottom: 1px solid #eee; position: sticky; top: 0; background: white; z-index: 1;">${P}</div>
            <div style="display: grid; gap: 8px; padding-bottom: 4px;">
        `;return T.forEach(U=>{if(U.value===null)return;const H=y[U.seriesIndex].poolsAtTime[w];if(!H||H.length===0)return;const de=U.value,ye=H.reduce((be,R)=>be+R.currentCommittedBytes,0),ce=H.reduce((be,R)=>be+(R.currentMaxBytes>0?R.currentMaxBytes:0),0),me=ye>0?de/ye*100:0;F+=`
            <div style="border-left: 4px solid ${U.color}; padding-left: 10px; background: #fafafa; padding: 8px; border-radius: 3px;">
              <div style="font-weight: 600; margin-bottom: 6px; color: #333;">${U.seriesName}</div>
              <div style="font-size: 11px; color: #666; line-height: 1.8;">
                <div><strong>使用量:</strong> ${j(de)}</div>
                <div><strong>提交量:</strong> ${j(ye)}</div>
                ${ce>0?`<div><strong>最大值:</strong> ${j(ce)}</div>`:"<div><strong>最大值:</strong> 无限制</div>"}
                <div><strong>使用率:</strong> ${me.toFixed(1)}%</div>
              </div>
          `,H.length>1&&(F+=`<div style="margin-top: 6px; padding-top: 6px; border-top: 1px dashed #ddd; font-size: 10px; color: #999;">包含 ${H.length} 个内存池</div>`),F+="</div>"}),F+=`</div>
        </div>`,F}},legend:{type:"scroll",bottom:10,data:$.map(([T])=>T)},grid:{left:"10px",right:"30px",bottom:"80px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e,axisLabel:{fontSize:12,rotate:30,color:"#595959"},axisLine:{lineStyle:{color:"#d9d9d9"}}},yAxis:{type:"value",name:"内存使用量",nameTextStyle:{fontSize:13,color:"#595959"},axisLabel:{fontSize:13,color:"#595959",formatter:T=>B(T)},axisLine:{lineStyle:{color:"#d9d9d9"}},splitLine:{lineStyle:{color:"#f0f0f0"}},min:0},series:y}}),z=()=>{if(!x.value)return;const{clientWidth:s,clientHeight:o}=x.value;if(s===0||o===0){setTimeout(()=>z(),100);return}b&&b.dispose(),b=oe(x.value),b.setOption(k.value),window.addEventListener("resize",A)},M=()=>{b?b.setOption(k.value,{notMerge:!1}):z()},A=()=>{b&&b.resize()},r=s=>{u.value=s,s&&I()},h=()=>{u.value&&I()};return V(()=>p.value,()=>{X(()=>{M()})},{deep:!0}),V(()=>c.jvmResourceId,(s,o)=>{s&&s!==o&&(p.value=[],u.value&&I())}),pe(()=>{X(()=>{z()});const s=Date.now();u.value=[s-7200*1e3,s],c.jvmResourceId&&u.value&&I()}),ze(()=>{b&&(b.dispose(),b=null),window.removeEventListener("resize",A)}),(s,o)=>(E(),W("div",Ta,[S("div",Sa,[t(a(te),{size:12},{default:m(()=>[t(a(Be),{value:u.value,"onUpdate:value":[o[0]||(o[0]=n=>u.value=n),r],type:"datetimerange",shortcuts:f,placeholder:"选择时间范围",size:"small",style:{width:"280px"},clearable:""},null,8,["value"]),t(a(le),{size:"small",onClick:h,loading:_.value},{icon:m(()=>[t(a(ne),{component:a(ve)},null,8,["component"])]),default:m(()=>[o[1]||(o[1]=O(" 刷新 ",-1))]),_:1},8,["loading"])]),_:1})]),S("div",Ca,[S("div",{ref_key:"chartRef",ref:x,style:{width:"100%",height:"400px"}},null,512)])]))}}),$a=ie(za,[["__scopeId","data-v-25c14530"]]),Ra={class:"memory-monitor"},Ia=Z({__name:"MemoryMonitor",props:{jvmResourceId:{}},setup(i){const{t:c}=se("hub0042");return(l,_)=>{const p=qe,u=He,x=Ce;return E(),W("div",Ra,[t(x,{title:a(c)("memoryUsageTrend"),bordered:!1},{default:m(()=>[t(u,{type:"line",animated:""},{default:m(()=>[t(p,{name:"heap",tab:a(c)("heapMemory")},{default:m(()=>[t(ia,{"jvm-resource-id":i.jvmResourceId},null,8,["jvm-resource-id"])]),_:1},8,["tab"]),t(p,{name:"nonheap",tab:a(c)("nonHeapMemory")},{default:m(()=>[t(wa,{"jvm-resource-id":i.jvmResourceId},null,8,["jvm-resource-id"])]),_:1},8,["tab"])]),_:1})]),_:1},8,["title"]),t(x,{title:a(c)("memoryPoolUsageTrend"),bordered:!1,style:{"margin-top":"16px"}},{default:m(()=>[t($a,{"jvm-resource-id":i.jvmResourceId},null,8,["jvm-resource-id"])]),_:1},8,["title"])])}}}),Ma=ie(Ia,[["__scopeId","data-v-55cade51"]]),Da={class:"gc-monitor"},Aa={style:{"font-size":"14px"}},ka={style:{"font-size":"14px"}},Na={style:{"font-size":"14px"}},Ba=Z({__name:"GcMonitor",props:{jvmResourceId:{}},setup(i){Re([Ie,Me,De,Ae,ke,at,Ne]);const c=i,{t:l}=se("hub0042"),{loading:_,gcSnapshots:p,totalGcCount:u,youngGcCount:x,fullGcCount:b,avgGcTime:f,queryGcSnapshots:B}=qt(),I=C(null),k=C(),z=C();let M=null,A=null;const r={最近1小时:()=>{const g=Date.now();return[g-3600*1e3,g]},最近2小时:()=>{const g=Date.now();return[g-7200*1e3,g]},最近6小时:()=>{const g=Date.now();return[g-360*60*1e3,g]},最近12小时:()=>{const g=Date.now();return[g-720*60*1e3,g]},最近24小时:()=>{const g=Date.now();return[g-1440*60*1e3,g]}},h=G(()=>{if(!p.value||p.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const g=p.value.map(w=>new Date(w.collectionTime).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}));return{tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["Young GC次数","Full GC次数","Young GC时间","Full GC时间"],bottom:10},grid:{left:"10px",right:"10px",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:g,axisLabel:{fontSize:12,rotate:30,color:"#595959"}},yAxis:[{type:"value",name:"GC次数",position:"left",axisLabel:{fontSize:13,color:"#595959"}},{type:"value",name:"GC时间(s)",position:"right",axisLabel:{fontSize:13,color:"#595959",formatter:w=>w.toFixed(2)+"s"}}],series:[{name:"Young GC次数",type:"line",data:p.value.map(w=>w.ygc||0),smooth:!0,lineStyle:{color:"#52c41a",width:2},itemStyle:{color:"#52c41a"}},{name:"Full GC次数",type:"line",data:p.value.map(w=>w.fgc||0),smooth:!0,lineStyle:{color:"#ff4d4f",width:2},itemStyle:{color:"#ff4d4f"}},{name:"Young GC时间",type:"line",yAxisIndex:1,data:p.value.map(w=>w.ygct||0),smooth:!0,lineStyle:{color:"#1890ff",width:2,type:"dashed"},itemStyle:{color:"#1890ff"}},{name:"Full GC时间",type:"line",yAxisIndex:1,data:p.value.map(w=>w.fgct||0),smooth:!0,lineStyle:{color:"#faad14",width:2,type:"dashed"},itemStyle:{color:"#faad14"}}]}}),s=G(()=>{if(!p.value||p.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const g=p.value.map(w=>new Date(w.collectionTime).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}));return{tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:w=>{if(!Array.isArray(w)||w.length===0)return"";let P=`<div style="font-size: 12px;"><strong>${w[0].name}</strong><br/>`;return w.forEach(j=>{P+=`<span style="color: ${j.color};">●</span> ${j.seriesName}: ${j.value} KB<br/>`}),P+="</div>",P}},legend:{data:["Eden","Survivor","Old Gen","Metaspace"],bottom:10},grid:{left:"10px",right:"30px",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:g,axisLabel:{fontSize:12,rotate:30,color:"#595959"}},yAxis:{type:"value",name:"内存使用量(KB)",axisLabel:{fontSize:13,color:"#595959"}},series:[{name:"Eden",type:"line",data:p.value.map(w=>w.eu||0),smooth:!0,areaStyle:{opacity:.3},lineStyle:{color:"#52c41a",width:2},itemStyle:{color:"#52c41a"}},{name:"Survivor",type:"line",data:p.value.map(w=>(w.s0u||0)+(w.s1u||0)),smooth:!0,areaStyle:{opacity:.3},lineStyle:{color:"#1890ff",width:2},itemStyle:{color:"#1890ff"}},{name:"Old Gen",type:"line",data:p.value.map(w=>w.ou||0),smooth:!0,areaStyle:{opacity:.3},lineStyle:{color:"#faad14",width:2},itemStyle:{color:"#faad14"}},{name:"Metaspace",type:"line",data:p.value.map(w=>w.mu||0),smooth:!0,areaStyle:{opacity:.3},lineStyle:{color:"#722ed1",width:2},itemStyle:{color:"#722ed1"}}]}}),o=async()=>{if(!c.jvmResourceId||!I.value)return;const[g,w]=I.value;await B({jvmResourceId:c.jvmResourceId,startTime:Y(g),endTime:Y(w)})},n=g=>{I.value=g,g&&o()},e=()=>{I.value&&o()},d=()=>{if(!k.value)return;const{clientWidth:g,clientHeight:w}=k.value;if(g===0||w===0){setTimeout(()=>d(),100);return}M&&M.dispose(),M=oe(k.value),M.setOption(h.value),window.addEventListener("resize",T)},y=()=>{if(!z.value)return;const{clientWidth:g,clientHeight:w}=z.value;if(g===0||w===0){setTimeout(()=>y(),100);return}A&&A.dispose(),A=oe(z.value),A.setOption(s.value)},$=()=>{M&&M.setOption(h.value),A&&A.setOption(s.value)},T=()=>{M&&M.resize(),A&&A.resize()};return V(()=>p.value,()=>{X(()=>{$()})},{deep:!0}),V(()=>c.jvmResourceId,()=>{I.value&&o()}),pe(()=>{X(()=>{d(),y()});const g=Date.now();I.value=[g-7200*1e3,g],c.jvmResourceId&&I.value&&o()}),ze(()=>{M&&(M.dispose(),M=null),A&&(A.dispose(),A=null),window.removeEventListener("resize",T)}),(g,w)=>{const P=tt,j=Ce,F=bt,U=_t;return E(),W("div",Da,[t(U,{cols:4,"x-gap":16,"y-gap":16},{default:m(()=>[t(F,null,{default:m(()=>[t(j,{bordered:!1},{default:m(()=>[t(P,{label:a(l)("totalGcCount"),value:a(u)},{suffix:m(()=>[S("span",Aa,D(a(l)("times")),1)]),_:1},8,["label","value"])]),_:1})]),_:1}),t(F,null,{default:m(()=>[t(j,{bordered:!1},{default:m(()=>[t(P,{label:a(l)("youngGcCount"),value:a(x)},{suffix:m(()=>[S("span",ka,D(a(l)("times")),1)]),_:1},8,["label","value"])]),_:1})]),_:1}),t(F,null,{default:m(()=>[t(j,{bordered:!1},{default:m(()=>[t(P,{label:a(l)("fullGcCount"),value:a(b)},{suffix:m(()=>[S("span",Na,D(a(l)("times")),1)]),_:1},8,["label","value"])]),_:1})]),_:1}),t(F,null,{default:m(()=>[t(j,{bordered:!1},{default:m(()=>[t(P,{label:a(l)("avgGcTime"),value:a(f).toFixed(2)},{suffix:m(()=>[...w[1]||(w[1]=[S("span",{style:{"font-size":"14px"}},"ms",-1)])]),_:1},8,["label","value"])]),_:1})]),_:1})]),_:1}),t(a(te),{vertical:"",size:16,style:{"margin-top":"16px"}},{default:m(()=>[t(j,{bordered:!1,size:"small"},{default:m(()=>[t(a(te),{size:12},{default:m(()=>[t(a(Be),{value:I.value,"onUpdate:value":[w[0]||(w[0]=re=>I.value=re),n],type:"datetimerange",shortcuts:r,placeholder:"选择时间范围",size:"small",style:{width:"280px"},clearable:""},null,8,["value"]),t(a(le),{size:"small",onClick:e,loading:a(_)},{icon:m(()=>[t(a(ne),{component:a(ve)},null,8,["component"])]),default:m(()=>[w[2]||(w[2]=O(" 刷新 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1}),t(j,{title:a(l)("gcCountTimeTrend"),bordered:!1},{default:m(()=>[S("div",{ref_key:"gcTrendChartRef",ref:k,style:{width:"100%",height:"400px"}},null,512)]),_:1},8,["title"]),t(j,{title:a(l)("memoryRegionTrend"),bordered:!1},{default:m(()=>[S("div",{ref_key:"memoryTrendChartRef",ref:z,style:{width:"100%",height:"400px"}},null,512)]),_:1},8,["title"])]),_:1})])}}}),La=ie(Ba,[["__scopeId","data-v-70eb9aa1"]]),ja={class:"thread-monitor"},Ga={key:0,class:"deadlock-overview"},Pa={class:"overview-grid"},Oa={class:"stat-card"},Fa={class:"stat-label"},Ea={class:"stat-value"},Ha={class:"stat-suffix"},qa={class:"stat-card"},Ua={class:"stat-label"},Ja={class:"stat-suffix"},Wa={class:"status-card"},Va={class:"status-label"},Ya={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Ka={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Qa={class:"status-text"},Xa={key:1,style:{"margin-top":"16px"}},Za=Z({__name:"ThreadMonitor",props:{jvmResourceId:{}},setup(i){Re([Ie,Me,De,Ae,ke,at,Ne]);const c=i,{t:l}=se("hub0042"),{loading:_,threadInfo:p,deadlocks:u,hasDeadlock:x,threadTrendData:b,threadStateTrendData:f,queryThreadInfo:B,getThreadState:I,queryThreadStates:k,queryDeadlocks:z}=Ut(),M=C(null),A=C(),r=C(),h=C(),s=C();let o=null,n=null,e=null,d=null;const y={最近1小时:()=>{const R=Date.now();return[R-3600*1e3,R]},最近2小时:()=>{const R=Date.now();return[R-7200*1e3,R]},最近6小时:()=>{const R=Date.now();return[R-360*60*1e3,R]},最近12小时:()=>{const R=Date.now();return[R-720*60*1e3,R]},最近24小时:()=>{const R=Date.now();return[R-1440*60*1e3,R]}},$=R=>new Date(R).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),T=G(()=>!u.value||!Array.isArray(u.value)?0:u.value.filter(R=>(R==null?void 0:R.hasDeadlockFlag)==="Y").length),g=G(()=>{if(!b.value||b.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const R=b.value.map(v=>$((v==null?void 0:v.time)||""));return{tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["当前线程数","峰值线程数","守护线程数","用户线程数"],bottom:10},grid:{left:"10px",right:"10px",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:R,axisLabel:{fontSize:12,rotate:30,color:"#595959"}},yAxis:{type:"value",name:"线程数",axisLabel:{fontSize:13,color:"#595959"}},series:[{name:"当前线程数",type:"line",data:b.value.map(v=>(v==null?void 0:v.currentThreadCount)||0),smooth:!0,lineStyle:{color:"#1890ff",width:2},itemStyle:{color:"#1890ff"}},{name:"峰值线程数",type:"line",data:b.value.map(v=>(v==null?void 0:v.peakThreadCount)||0),smooth:!0,lineStyle:{color:"#ff4d4f",width:2,type:"dashed"},itemStyle:{color:"#ff4d4f"}},{name:"守护线程数",type:"line",data:b.value.map(v=>(v==null?void 0:v.daemonThreadCount)||0),smooth:!0,lineStyle:{color:"#52c41a",width:2},itemStyle:{color:"#52c41a"}},{name:"用户线程数",type:"line",data:b.value.map(v=>(v==null?void 0:v.userThreadCount)||0),smooth:!0,lineStyle:{color:"#faad14",width:2},itemStyle:{color:"#faad14"}}]}}),w=G(()=>{if(!f.value||f.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const R=f.value.map(v=>$((v==null?void 0:v.time)||""));return{tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:v=>{try{if(!Array.isArray(v)||v.length===0)return"";const J=v[0].dataIndex;if(!f.value||J>=f.value.length||J<0)return'<div style="font-size: 12px;">数据加载中...</div>';const N=f.value[J];if(!N)return'<div style="font-size: 12px;">数据不可用</div>';let q=`<div style="font-size: 12px;"><strong>${v[0].name}</strong><br/>`;const ue=N.totalThreadCount||0,Le=N.runnableThreadCount||0,we=N.timedWaitingThreadCount||0,je=N.waitingThreadCount||0,Te=N.blockedThreadCount||0,he=N.newThreadCount||0,Ke=N.terminatedThreadCount||0;q+=`<span style="color: #1890ff;">◆</span> 总线程数: <strong>${ue}</strong><br/>`,q+=`<span style="color: #52c41a;">●</span> RUNNABLE: ${Le}<br/>`,q+=`<span style="color: #fa8c16;">●</span> TIMED_WAITING: ${we}<br/>`,q+=`<span style="color: #faad14;">●</span> WAITING: ${je}<br/>`,q+=`<span style="color: #ff4d4f;">●</span> BLOCKED: ${Te}<br/>`,q+=`<span style="color: #d9d9d9;">●</span> NEW: ${he}<br/>`,q+=`<span style="color: #8c8c8c;">●</span> TERMINATED: ${Ke}<br/>`;const Qe=he+Le+Te+je+we+Ke;return Qe!==ue&&ue>0&&(q+=`<span style="color: #ff4d4f; font-size: 11px;">⚠️ 数据不一致: ${Qe} ≠ ${ue}</span>`),q+="</div>",q}catch(J){return console.error("Tooltip formatter error:",J),'<div style="font-size: 12px;">显示错误</div>'}}},legend:{data:["NEW","RUNNABLE","BLOCKED","WAITING","TIMED_WAITING","TERMINATED","总线程数"],bottom:10},grid:{left:"10px",right:"10px",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:R,axisLabel:{fontSize:12,rotate:30,color:"#595959"}},yAxis:{type:"value",name:"线程数",axisLabel:{fontSize:13,color:"#595959"}},series:[{name:"NEW",type:"line",data:f.value.map(v=>(v==null?void 0:v.newThreadCount)||0),smooth:!0,lineStyle:{color:"#d9d9d9",width:2},itemStyle:{color:"#d9d9d9"},symbol:"circle",symbolSize:4},{name:"RUNNABLE",type:"line",data:f.value.map(v=>(v==null?void 0:v.runnableThreadCount)||0),smooth:!0,lineStyle:{color:"#52c41a",width:2},itemStyle:{color:"#52c41a"},symbol:"circle",symbolSize:4},{name:"BLOCKED",type:"line",data:f.value.map(v=>(v==null?void 0:v.blockedThreadCount)||0),smooth:!0,lineStyle:{color:"#ff4d4f",width:2},itemStyle:{color:"#ff4d4f"},symbol:"circle",symbolSize:4},{name:"WAITING",type:"line",data:f.value.map(v=>(v==null?void 0:v.waitingThreadCount)||0),smooth:!0,lineStyle:{color:"#faad14",width:2},itemStyle:{color:"#faad14"},symbol:"circle",symbolSize:4},{name:"TIMED_WAITING",type:"line",data:f.value.map(v=>(v==null?void 0:v.timedWaitingThreadCount)||0),smooth:!0,lineStyle:{color:"#fa8c16",width:2},itemStyle:{color:"#fa8c16"},symbol:"circle",symbolSize:4},{name:"TERMINATED",type:"line",data:f.value.map(v=>(v==null?void 0:v.terminatedThreadCount)||0),smooth:!0,lineStyle:{color:"#8c8c8c",width:2},itemStyle:{color:"#8c8c8c"},symbol:"circle",symbolSize:4},{name:"总线程数",type:"line",data:f.value.map(v=>(v==null?void 0:v.totalThreadCount)||0),smooth:!0,lineStyle:{color:"#1890ff",width:3,type:"dashed"},itemStyle:{color:"#1890ff"},symbol:"diamond",symbolSize:6,z:10}]}}),P=G(()=>{if(!b.value||b.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const R=b.value.map(v=>$((v==null?void 0:v.time)||""));return{tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:v=>{if(!Array.isArray(v)||v.length===0)return"";let J=`<div style="font-size: 12px;"><strong>${v[0].name}</strong><br/>`;return v.forEach(N=>{J+=`<span style="color: ${N.color};">●</span> ${N.seriesName}: ${N.value.toFixed(2)}%<br/>`}),J+="</div>",J}},legend:{data:["活跃线程比例","阻塞线程比例","等待线程比例"],bottom:10},grid:{left:"10px",right:"10px",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:R,axisLabel:{fontSize:12,rotate:30,color:"#595959"}},yAxis:{type:"value",name:"比例(%)",max:100,axisLabel:{fontSize:13,color:"#595959",formatter:v=>`${v}%`}},series:[{name:"活跃线程比例",type:"line",data:b.value.map(v=>(v==null?void 0:v.activeThreadRatioPercent)||0),smooth:!0,lineStyle:{color:"#52c41a",width:2},itemStyle:{color:"#52c41a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#52c41a40"},{offset:1,color:"#52c41a10"}]}}},{name:"阻塞线程比例",type:"line",data:b.value.map(v=>(v==null?void 0:v.blockedThreadRatioPercent)||0),smooth:!0,lineStyle:{color:"#ff4d4f",width:2},itemStyle:{color:"#ff4d4f"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#ff4d4f40"},{offset:1,color:"#ff4d4f10"}]}}},{name:"等待线程比例",type:"line",data:b.value.map(v=>(v==null?void 0:v.waitingThreadRatioPercent)||0),smooth:!0,lineStyle:{color:"#faad14",width:2},itemStyle:{color:"#faad14"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#faad1440"},{offset:1,color:"#faad1410"}]}}}]}}),j=G(()=>{if(!u.value||!Array.isArray(u.value)||u.value.length===0)return{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]};const R=u.value.map(N=>$((N==null?void 0:N.collectionTime)||(N==null?void 0:N.detectionTime)||"")),v=u.value.map(N=>(N==null?void 0:N.hasDeadlockFlag)==="Y"?1:0),J=u.value.map(N=>(N==null?void 0:N.deadlockThreadCount)||0);return{tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:N=>{try{if(!Array.isArray(N)||N.length===0)return"";const q=N[0].dataIndex;if(!u.value||!Array.isArray(u.value)||q>=u.value.length||q<0)return'<div style="font-size: 12px;">数据加载中...</div>';const ue=u.value[q];if(!ue)return'<div style="font-size: 12px;">数据不可用</div>';const Le=N[0].name,we=ue.hasDeadlockFlag==="Y",je=we?"存在死锁":"无死锁",Te=ue.deadlockThreadCount||0;let he=`<div style="font-size: 12px;"><strong>${Le}</strong><br/>`;return he+=`<span style="color: ${we?"#ff4d4f":"#52c41a"};">●</span> 状态: ${je}<br/>`,Te>0&&(he+=`<span style="color: #faad14;">●</span> 涉及线程: ${Te}个<br/>`),ue.severityLevel&&(he+=`<span>严重程度: ${ue.severityLevel}</span><br/>`),he+="</div>",he}catch(q){return console.error("Deadlock tooltip formatter error:",q),'<div style="font-size: 12px;">显示错误</div>'}}},legend:{data:["死锁状态","涉及线程数"],bottom:10},grid:{left:"10px",right:"10px",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:R,axisLabel:{fontSize:12,rotate:30,color:"#595959"}},yAxis:[{type:"value",name:"死锁状态",position:"left",min:0,max:1,interval:1,axisLabel:{fontSize:13,color:"#595959",formatter:N=>N===1?"有死锁":"无死锁"}},{type:"value",name:"涉及线程数",position:"right",axisLabel:{fontSize:13,color:"#595959"}}],series:[{name:"死锁状态",type:"line",data:v,smooth:!1,step:"end",lineStyle:{color:"#ff4d4f",width:3},itemStyle:{color:N=>N.value===1?"#ff4d4f":"#52c41a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#ff4d4f40"},{offset:1,color:"#ff4d4f10"}]}},markPoint:{data:u.value.map((N,q)=>(N==null?void 0:N.hasDeadlockFlag)==="Y"?{coord:[q,1],symbol:"pin",symbolSize:50,itemStyle:{color:"#ff4d4f"}}:null).filter(Boolean)}},{name:"涉及线程数",type:"bar",yAxisIndex:1,data:J,barWidth:"40%",itemStyle:{color:"#faad14",borderRadius:[4,4,0,0]}}]}}),F=()=>{if(!A.value)return;const{clientWidth:R,clientHeight:v}=A.value;if(R===0||v===0){setTimeout(()=>F(),100);return}o&&o.dispose(),o=oe(A.value),o.setOption(g.value)},U=()=>{if(!r.value)return;const{clientWidth:R,clientHeight:v}=r.value;if(R===0||v===0){setTimeout(()=>U(),100);return}n&&n.dispose(),n=oe(r.value),n.setOption(w.value)},re=()=>{if(!h.value)return;const{clientWidth:R,clientHeight:v}=h.value;if(R===0||v===0){setTimeout(()=>re(),100);return}e&&e.dispose(),e=oe(h.value),e.setOption(P.value)},H=()=>{if(!s.value)return;const{clientWidth:R,clientHeight:v}=s.value;if(R===0||v===0){setTimeout(()=>H(),100);return}d&&d.dispose(),d=oe(s.value),d.setOption(j.value)},de=()=>{o&&o.setOption(g.value),n&&n.setOption(w.value),e&&e.setOption(P.value),d&&d.setOption(j.value)},ye=()=>{o&&o.resize(),n&&n.resize(),e&&e.resize(),d&&d.resize()},ce=async()=>{var v;if(!c.jvmResourceId)return;const R={jvmResourceId:c.jvmResourceId};if(M.value){const[J,N]=M.value;R.startTime=Y(J),R.endTime=Y(N)}M.value?await Promise.all([B(R),k(R),z(R)]):(await B(R),(v=p.value)!=null&&v.jvmThreadId&&await Promise.all([I(p.value.jvmThreadId),z(R)]))},me=R=>{M.value=R,R&&ce()},be=()=>{M.value&&ce()};return V(()=>c.jvmResourceId,()=>{M.value&&ce()},{immediate:!1}),V(()=>b.value,()=>{X(()=>{de()})},{deep:!0}),V(()=>f.value,()=>{X(()=>{de()})},{deep:!0}),V(()=>u.value,()=>{X(()=>{u.value&&u.value.length>0&&!d?H():d&&d.setOption(j.value)})},{deep:!0}),pe(()=>{X(()=>{F(),U(),re()});const R=Date.now();M.value=[R-7200*1e3,R],c.jvmResourceId&&M.value&&ce(),window.addEventListener("resize",ye)}),ze(()=>{o&&(o.dispose(),o=null),n&&(n.dispose(),n=null),e&&(e.dispose(),e=null),d&&(d.dispose(),d=null),window.removeEventListener("resize",ye)}),(R,v)=>{const J=Ce,N=At;return E(),W("div",ja,[t(J,{bordered:!1,size:"small"},{default:m(()=>[t(a(te),{size:12},{default:m(()=>[t(a(Be),{value:M.value,"onUpdate:value":[v[0]||(v[0]=q=>M.value=q),me],type:"datetimerange",shortcuts:y,placeholder:"选择时间范围",size:"small",style:{width:"280px"},clearable:""},null,8,["value"]),t(a(le),{size:"small",onClick:be,loading:a(_)},{icon:m(()=>[t(a(ne),{component:a(ve)},null,8,["component"])]),default:m(()=>[O(" "+D(a(l)("refresh")),1)]),_:1},8,["loading"])]),_:1})]),_:1}),t(J,{title:a(l)("threadCountTrend"),bordered:!1,style:{"margin-top":"16px"}},{default:m(()=>[S("div",{ref_key:"threadCountChartRef",ref:A,style:{width:"100%",height:"400px"}},null,512)]),_:1},8,["title"]),t(J,{title:a(l)("threadStateTrend"),bordered:!1,style:{"margin-top":"16px"}},{default:m(()=>[S("div",{ref_key:"threadStateChartRef",ref:r,style:{width:"100%",height:"400px"}},null,512)]),_:1},8,["title"]),t(J,{title:a(l)("threadRatioTrend"),bordered:!1,style:{"margin-top":"16px"}},{default:m(()=>[S("div",{ref_key:"threadRatioChartRef",ref:h,style:{width:"100%",height:"400px"}},null,512)]),_:1},8,["title"]),t(J,{title:a(l)("deadlockDetection"),bordered:!1,style:{"margin-top":"16px"}},{default:m(()=>[a(u)&&a(u).length>0?(E(),W("div",Ga,[S("div",Pa,[S("div",Oa,[S("div",Fa,D(a(l)("totalDetections")),1),S("div",Ea,D(a(u).length),1),S("div",Ha,D(a(l)("times")),1)]),S("div",qa,[S("div",Ua,D(a(l)("deadlockOccurrences")),1),S("div",{class:Xe(["stat-value",{danger:T.value>0,safe:T.value===0}])},D(T.value),3),S("div",Ja,D(a(l)("times")),1)]),S("div",Wa,[S("div",Va,D(a(l)("currentStatus")),1),S("div",{class:Xe(["status-badge",{error:a(x),success:!a(x)}])},[t(a(ne),{size:"16",class:"status-icon"},{default:m(()=>[a(x)?(E(),W("svg",Ya,[...v[1]||(v[1]=[S("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2M13 17h-2v-6h2zm0-8h-2V7h2z"},null,-1)])])):(E(),W("svg",Ka,[...v[2]||(v[2]=[S("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2m-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8z"},null,-1)])]))]),_:1}),S("span",Qa,D(a(x)?a(l)("deadlockDetected"):a(l)("noDeadlock")),1)],2)])])])):ge("",!0),a(u)&&a(u).length>0?(E(),W("div",Xa,[S("div",{ref_key:"deadlockChartRef",ref:s,style:{width:"100%",height:"300px"}},null,512)])):(E(),$e(N,{key:2,status:"success",title:a(l)("noDeadlock"),description:a(l)("noDeadlockDesc")},{icon:m(()=>[t(a(ne),{size:"60",color:"#52c41a"},{default:m(()=>[...v[3]||(v[3]=[S("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[S("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2m-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8z"})],-1)])]),_:1})]),_:1},8,["title","description"]))]),_:1},8,["title"])])}}}),eo=ie(Za,[["__scopeId","data-v-e9496ce4"]]),to={class:"threadpool-monitor"},ao=Z({__name:"ThreadPoolMonitor",props:{jvmResourceId:{}},setup(i){const c=i,{t:l}=se("hub0042"),_=C(),p=C(),u=C(!1),x=C([]),b=C([]),f=C(),B=C("1h"),I=G(()=>b.value.map(r=>({label:r,value:r}))),k=()=>{const r=Date.now(),h={"15m":900*1e3,"1h":3600*1e3,"6h":360*60*1e3,"24h":1440*60*1e3},s=r-h[B.value];return{startTime:Y(s),endTime:Y(r)}},z=async()=>{if(c.jvmResourceId){u.value=!0;try{const{startTime:r,endTime:h}=k(),s=await Ye({jvmResourceId:c.jvmResourceId,dataType:"THREAD_POOL",dataName:f.value,startTime:r,endTime:h});if(K(s)){const o=Q(s,[]);if(x.value=o.filter(n=>n.dataType==="THREAD_POOL"),!f.value){const n=[...new Set(x.value.map(e=>e.dataName))];b.value=n,n.length>0&&(f.value=n[0])}await X(),M()}}catch(r){console.error("加载线程池数据失败:",r)}finally{u.value=!1}}},M=()=>{if(!_.value||!f.value)return;p.value||(p.value=oe(_.value));const r=x.value.filter(e=>e.dataName===f.value).sort((e,d)=>new Date(e.collectionTime).getTime()-new Date(d.collectionTime).getTime());if(r.length===0){p.value.clear();return}const h=r.map(e=>new Date(e.collectionTime).toLocaleTimeString()),s=r.map(e=>{try{return JSON.parse(e.dataJson)}catch{return{}}}),o=e=>e==="Y"?{color:"#18a058",text:"健康",icon:"●"}:e==="N"?{color:"#f5222d",text:"异常",icon:"●"}:{color:"#faad14",text:"警告",icon:"●"},n={tooltip:{trigger:"item",formatter:e=>{const d=e.dataIndex,y=s[d],$=r[d],T=e.seriesName,g=e.value,w=o($.healthyFlag);return`
          <div style="font-size: 12px;">
            <div style="font-weight: bold; margin-bottom: 6px;">
              ${e.name}
              <span style="margin-left: 8px; color: ${w.color};">
                ${w.icon} ${w.text}
              </span>
            </div>
            <div style="margin: 3px 0;">
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: ${e.color}; border-radius: 50%;"></span>
              <span>${T}: <span style="font-weight: bold;">${g}</span></span>
            </div>
            <div style="color: #666; margin-top: 8px; padding-top: 8px; border-top: 1px solid #e8e8e8;">
              <div style="margin: 3px 0;">${l("active")}: ${y.activeCount||0}</div>
              <div style="margin: 3px 0;">${l("current")}: ${y.poolSize||0}</div>
              <div style="margin: 3px 0;">队列大小: ${y.queueSize||0}</div>
              <div style="margin: 3px 0;">核心线程数: ${y.corePoolSize||0}</div>
              <div style="margin: 3px 0;">最大线程数: ${y.maximumPoolSize||0}</div>
              <div style="margin: 3px 0;">队列容量: ${y.queueCapacity||0}</div>
              <div style="margin: 3px 0;">已完成任务: ${y.completedTaskCount||0}</div>
            </div>
          </div>
        `}},legend:{data:[l("active"),l("current"),"队列大小"],bottom:0},grid:{left:"3%",right:"4%",bottom:"60px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:h,axisLabel:{rotate:45,fontSize:11}},yAxis:{type:"value"},series:[{name:l("active"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#18a058"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#18a058"},data:s.map(e=>e.activeCount||0)},{name:l("current"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#2080f0"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#2080f0"},data:s.map(e=>e.poolSize||0)},{name:"队列大小",type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#faad14"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#faad14"},data:s.map(e=>e.queueSize||0)}]};p.value.setOption(n)};V(f,z),V(()=>c.jvmResourceId,z,{immediate:!0});const A=()=>{var r;return(r=p.value)==null?void 0:r.resize()};return pe(()=>window.addEventListener("resize",A)),Ue(()=>{var r;window.removeEventListener("resize",A),(r=p.value)==null||r.dispose()}),(r,h)=>{const s=Pe,o=ne,n=le,e=Ve,d=We,y=te,$=Je;return E(),W("div",to,[t(y,{style:{"margin-bottom":"16px"},align:"center"},{default:m(()=>[t(s,{value:f.value,"onUpdate:value":h[0]||(h[0]=T=>f.value=T),options:I.value,placeholder:a(l)("selectComponent"),style:{width:"300px"}},null,8,["value","options","placeholder"]),t(n,{onClick:z,loading:u.value},{icon:m(()=>[t(o,{component:a(ve)},null,8,["component"])]),default:m(()=>[O(" "+D(a(l)("refresh")),1)]),_:1},8,["loading"]),t(d,{value:B.value,"onUpdate:value":[h[1]||(h[1]=T=>B.value=T),z]},{default:m(()=>[t(e,{value:"15m"},{default:m(()=>[O(D(a(l)("last15Minutes")),1)]),_:1}),t(e,{value:"1h"},{default:m(()=>[O(D(a(l)("last1Hour")),1)]),_:1}),t(e,{value:"6h"},{default:m(()=>[O(D(a(l)("last6Hours")),1)]),_:1}),t(e,{value:"24h"},{default:m(()=>[O(D(a(l)("last24Hours")),1)]),_:1})]),_:1},8,["value"])]),_:1}),S("div",{ref_key:"chartRef",ref:_,style:{width:"100%",height:"400px"}},null,512),!u.value&&x.value.length===0?(E(),$e($,{key:0,description:a(l)("noData"),style:{"margin-top":"60px"}},null,8,["description"])):ge("",!0)])}}}),oo=ie(ao,[["__scopeId","data-v-e2f7caba"]]),no={class:"http-connection-pool-monitor"},lo=Z({__name:"HttpConnectionPoolMonitor",props:{jvmResourceId:{}},setup(i){const c=i,{t:l}=se("hub0042"),_=C(),p=C(),u=C(!1),x=C([]),b=C([]),f=C(),B=C("1h"),I=G(()=>b.value.map(r=>({label:r,value:r}))),k=()=>{const r=Date.now(),h={"15m":900*1e3,"1h":3600*1e3,"6h":360*60*1e3,"24h":1440*60*1e3},s=r-h[B.value];return{startTime:Y(s),endTime:Y(r)}},z=async()=>{if(c.jvmResourceId){u.value=!0;try{const{startTime:r,endTime:h}=k(),s=await Ye({jvmResourceId:c.jvmResourceId,dataType:"HTTP_CONNECTION_POOL",dataName:f.value,startTime:r,endTime:h});if(K(s)){const o=Q(s,[]);if(x.value=o.filter(n=>n.dataType==="HTTP_CONNECTION_POOL"),!f.value){const n=[...new Set(x.value.map(e=>e.dataName))];b.value=n,n.length>0&&(f.value=n[0])}await X(),M()}}catch(r){console.error("加载HTTP连接池数据失败:",r)}finally{u.value=!1}}},M=()=>{if(!_.value||!f.value)return;p.value||(p.value=oe(_.value));const r=x.value.filter(e=>e.dataName===f.value).sort((e,d)=>new Date(e.collectionTime).getTime()-new Date(d.collectionTime).getTime());if(r.length===0){p.value.clear();return}const h=r.map(e=>new Date(e.collectionTime).toLocaleTimeString()),s=r.map(e=>{try{return JSON.parse(e.dataJson)}catch{return{}}}),o=e=>e==="Y"?{color:"#18a058",text:"健康",icon:"●"}:e==="N"?{color:"#f5222d",text:"异常",icon:"●"}:{color:"#faad14",text:"警告",icon:"●"},n={tooltip:{trigger:"item",formatter:e=>{const d=e.dataIndex,y=s[d],$=r[d],T=e.seriesName,g=e.value,w=o($.healthyFlag);return`
          <div style="font-size: 12px;">
            <div style="font-weight: bold; margin-bottom: 6px;">
              ${e.name}
              <span style="margin-left: 8px; color: ${w.color};">
                ${w.icon} ${w.text}
              </span>
            </div>
            <div style="margin: 3px 0;">
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: ${e.color}; border-radius: 50%;"></span>
              <span>${T}: <span style="font-weight: bold;">${g}</span></span>
            </div>
            <div style="color: #666; margin-top: 8px; padding-top: 8px; border-top: 1px solid #e8e8e8;">
              <div style="margin: 3px 0;">${l("leased")}: ${y.totalLeased||0}</div>
              <div style="margin: 3px 0;">${l("available")}: ${y.totalAvailable||0}</div>
              <div style="margin: 3px 0;">${l("pending")}: ${y.totalPending||0}</div>
              <div style="margin: 3px 0;">最大连接数: ${y.totalMax||0}</div>
              <div style="margin: 3px 0;">总连接数: ${y.totalConnections||0}</div>
              <div style="margin: 3px 0;">使用率: ${((y.connectionUsageRatio||0)*100).toFixed(2)}%</div>
            </div>
          </div>
        `}},legend:{data:[l("leased"),l("available"),l("pending")],bottom:0},grid:{left:"3%",right:"4%",bottom:"60px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:h,axisLabel:{rotate:45,fontSize:11}},yAxis:{type:"value"},series:[{name:l("leased"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#18a058"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#18a058"},data:s.map(e=>e.totalLeased||0)},{name:l("available"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#2080f0"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#2080f0"},data:s.map(e=>e.totalAvailable||0)},{name:l("pending"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#f5222d"},itemStyle:{color:e=>(r[e.dataIndex].healthyFlag==="N","#f5222d")},data:s.map(e=>e.totalPending||0)}]};p.value.setOption(n)};V(f,z),V(()=>c.jvmResourceId,z,{immediate:!0});const A=()=>{var r;return(r=p.value)==null?void 0:r.resize()};return pe(()=>window.addEventListener("resize",A)),Ue(()=>{var r;window.removeEventListener("resize",A),(r=p.value)==null||r.dispose()}),(r,h)=>{const s=Pe,o=ne,n=le,e=Ve,d=We,y=te,$=Je;return E(),W("div",no,[t(y,{style:{"margin-bottom":"16px"},align:"center"},{default:m(()=>[t(s,{value:f.value,"onUpdate:value":h[0]||(h[0]=T=>f.value=T),options:I.value,placeholder:a(l)("selectComponent"),style:{width:"300px"}},null,8,["value","options","placeholder"]),t(n,{onClick:z,loading:u.value},{icon:m(()=>[t(o,{component:a(ve)},null,8,["component"])]),default:m(()=>[O(" "+D(a(l)("refresh")),1)]),_:1},8,["loading"]),t(d,{value:B.value,"onUpdate:value":[h[1]||(h[1]=T=>B.value=T),z]},{default:m(()=>[t(e,{value:"15m"},{default:m(()=>[O(D(a(l)("last15Minutes")),1)]),_:1}),t(e,{value:"1h"},{default:m(()=>[O(D(a(l)("last1Hour")),1)]),_:1}),t(e,{value:"6h"},{default:m(()=>[O(D(a(l)("last6Hours")),1)]),_:1}),t(e,{value:"24h"},{default:m(()=>[O(D(a(l)("last24Hours")),1)]),_:1})]),_:1},8,["value"])]),_:1}),S("div",{ref_key:"chartRef",ref:_,style:{width:"100%",height:"400px"}},null,512),!u.value&&x.value.length===0?(E(),$e($,{key:0,description:a(l)("noData"),style:{"margin-top":"60px"}},null,8,["description"])):ge("",!0)])}}}),ro=ie(lo,[["__scopeId","data-v-28937a76"]]),so={class:"druid-datasource-monitor"},io=Z({__name:"DruidDatasourceMonitor",props:{jvmResourceId:{}},setup(i){const c=i,{t:l}=se("hub0042"),_=C(),p=C(),u=C(!1),x=C([]),b=C([]),f=C(),B=C("1h"),I=G(()=>b.value.map(r=>({label:r,value:r}))),k=()=>{const r=Date.now(),h={"15m":900*1e3,"1h":3600*1e3,"6h":360*60*1e3,"24h":1440*60*1e3},s=r-h[B.value];return{startTime:Y(s),endTime:Y(r)}},z=async()=>{if(c.jvmResourceId){u.value=!0;try{const{startTime:r,endTime:h}=k(),s=await Ye({jvmResourceId:c.jvmResourceId,dataType:"DRUID_DATASOURCE",dataName:f.value,startTime:r,endTime:h});if(K(s)){const o=Q(s,[]);if(x.value=o.filter(n=>n.dataType==="DRUID_DATASOURCE"),!f.value){const n=[...new Set(x.value.map(e=>e.dataName))];b.value=n,n.length>0&&(f.value=n[0])}await X(),M()}}catch(r){console.error("加载Druid数据源数据失败:",r)}finally{u.value=!1}}},M=()=>{if(!_.value||!f.value)return;p.value||(p.value=oe(_.value));const r=x.value.filter(e=>e.dataName===f.value).sort((e,d)=>new Date(e.collectionTime).getTime()-new Date(d.collectionTime).getTime());if(r.length===0){p.value.clear();return}const h=r.map(e=>new Date(e.collectionTime).toLocaleTimeString()),s=r.map(e=>{try{return JSON.parse(e.dataJson)}catch{return{}}}),o=e=>e==="Y"?{color:"#18a058",text:"健康",icon:"●"}:e==="N"?{color:"#f5222d",text:"异常",icon:"●"}:{color:"#faad14",text:"警告",icon:"●"},n={tooltip:{trigger:"item",formatter:e=>{const d=e.dataIndex,y=s[d],$=r[d],T=e.seriesName,g=e.value,w=o($.healthyFlag);return`
          <div style="font-size: 12px;">
            <div style="font-weight: bold; margin-bottom: 6px;">
              ${e.name}
              <span style="margin-left: 8px; color: ${w.color};">
                ${w.icon} ${w.text}
              </span>
            </div>
            <div style="margin: 3px 0;">
              <span style="display: inline-block; margin-right: 4px; width: 10px; height: 10px; background-color: ${e.color}; border-radius: 50%;"></span>
              <span>${T}: <span style="font-weight: bold;">${g}</span></span>
            </div>
            <div style="color: #666; margin-top: 8px; padding-top: 8px; border-top: 1px solid #e8e8e8;">
              <div style="margin: 3px 0;">${l("active")}: ${y.activeCount||0}</div>
              <div style="margin: 3px 0;">${l("pooling")}: ${y.poolingCount||0}</div>
              <div style="margin: 3px 0;">等待线程: ${y.waitThreadCount||0}</div>
              <div style="margin: 3px 0;">最大连接数: ${y.maxActive||0}</div>
              <div style="margin: 3px 0;">最小空闲: ${y.minIdle||0}</div>
              <div style="margin: 3px 0;">错误率: ${((y.errorRate||0)*100).toFixed(2)}%</div>
            </div>
          </div>
        `}},legend:{data:[l("active"),l("pooling"),"等待线程"],bottom:0},grid:{left:"3%",right:"4%",bottom:"60px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:h,axisLabel:{rotate:45,fontSize:11}},yAxis:{type:"value"},series:[{name:l("active"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#18a058"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#18a058"},data:s.map(e=>e.activeCount||0)},{name:l("pooling"),type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#2080f0"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#2080f0"},data:s.map(e=>e.poolingCount||0)},{name:"等待线程",type:"line",smooth:!0,symbol:"circle",symbolSize:(e,d)=>r[d.dataIndex].healthyFlag==="N"?8:6,lineStyle:{width:2,color:"#faad14"},itemStyle:{color:e=>r[e.dataIndex].healthyFlag==="N"?"#f5222d":"#faad14"},data:s.map(e=>e.waitThreadCount||0)}]};p.value.setOption(n)};V(f,z),V(()=>c.jvmResourceId,z,{immediate:!0});const A=()=>{var r;return(r=p.value)==null?void 0:r.resize()};return pe(()=>window.addEventListener("resize",A)),Ue(()=>{var r;window.removeEventListener("resize",A),(r=p.value)==null||r.dispose()}),(r,h)=>{const s=Pe,o=ne,n=le,e=Ve,d=We,y=te,$=Je;return E(),W("div",so,[t(y,{style:{"margin-bottom":"16px"},align:"center"},{default:m(()=>[t(s,{value:f.value,"onUpdate:value":h[0]||(h[0]=T=>f.value=T),options:I.value,placeholder:a(l)("selectComponent"),style:{width:"300px"}},null,8,["value","options","placeholder"]),t(n,{onClick:z,loading:u.value},{icon:m(()=>[t(o,{component:a(ve)},null,8,["component"])]),default:m(()=>[O(" "+D(a(l)("refresh")),1)]),_:1},8,["loading"]),t(d,{value:B.value,"onUpdate:value":[h[1]||(h[1]=T=>B.value=T),z]},{default:m(()=>[t(e,{value:"15m"},{default:m(()=>[O(D(a(l)("last15Minutes")),1)]),_:1}),t(e,{value:"1h"},{default:m(()=>[O(D(a(l)("last1Hour")),1)]),_:1}),t(e,{value:"6h"},{default:m(()=>[O(D(a(l)("last6Hours")),1)]),_:1}),t(e,{value:"24h"},{default:m(()=>[O(D(a(l)("last24Hours")),1)]),_:1})]),_:1},8,["value"])]),_:1}),S("div",{ref_key:"chartRef",ref:_,style:{width:"100%",height:"400px"}},null,512),!u.value&&x.value.length===0?(E(),$e($,{key:0,description:a(l)("noData"),style:{"margin-top":"60px"}},null,8,["description"])):ge("",!0)])}}}),co=ie(io,[["__scopeId","data-v-ca4a07f7"]]),uo={class:"app-monitor"},mo=Z({__name:"AppMonitor",props:{jvmResourceId:{}},setup(i){const{t:c}=se("hub0042"),l=C("threadpool");return(_,p)=>{const u=qe,x=He;return E(),W("div",uo,[t(x,{value:l.value,"onUpdate:value":p[0]||(p[0]=b=>l.value=b),type:"card",animated:""},{default:m(()=>[t(u,{name:"threadpool",tab:a(c)("threadPool")},{default:m(()=>[t(oo,{"jvm-resource-id":i.jvmResourceId},null,8,["jvm-resource-id"])]),_:1},8,["tab"]),t(u,{name:"httppool",tab:a(c)("httpConnectionPool")},{default:m(()=>[t(ro,{"jvm-resource-id":i.jvmResourceId},null,8,["jvm-resource-id"])]),_:1},8,["tab"]),t(u,{name:"druid",tab:a(c)("druidDatasource")},{default:m(()=>[t(co,{"jvm-resource-id":i.jvmResourceId},null,8,["jvm-resource-id"])]),_:1},8,["tab"])]),_:1},8,["value"])])}}}),po=ie(mo,[["__scopeId","data-v-95c4f25b"]]),vo={class:"service-monitoring-page"},yo={class:"content-wrapper"},ho=Z({__name:"ServiceMonitoring",setup(i){const{t:c}=se("hub0042");nt();const l=C("list"),_=C("jvm"),p=C("memory"),u=C(""),x=C(null),b=async B=>{u.value=B.jvmResourceId,x.value=B,l.value="detail",_.value="jvm",p.value="memory"},f=()=>{l.value="list",u.value="",x.value=null};return(B,I)=>{const k=qe,z=Se,M=fe,A=ne,r=le,h=te,s=Ce,o=He;return E(),W("div",vo,[S("div",yo,[t(o,{value:l.value,"onUpdate:value":I[2]||(I[2]=n=>l.value=n),type:"line",animated:""},{default:m(()=>[t(k,{name:"list",tab:a(c)("jvmInstanceList")},{default:m(()=>[t(Vt,{onSelect:b})]),_:1},8,["tab"]),u.value?(E(),$e(k,{key:0,name:"detail",tab:a(c)("monitoringDetail")},{default:m(()=>[t(s,{bordered:!1,class:"detail-header"},{default:m(()=>[t(h,{align:"center"},{default:m(()=>{var n,e,d;return[t(z,{type:"info",size:"large"},{default:m(()=>{var y;return[O(D(((y=x.value)==null?void 0:y.applicationName)||a(c)("unknownApplication")),1)]}),_:1}),t(M,{vertical:""}),S("span",null,D(a(c)("host"))+": "+D(((n=x.value)==null?void 0:n.hostName)||"-"),1),t(M,{vertical:""}),S("span",null,D(a(c)("ip"))+": "+D(((e=x.value)==null?void 0:e.hostIpAddress)||"-"),1),t(M,{vertical:""}),t(z,{type:((d=x.value)==null?void 0:d.healthyFlag)==="Y"?"success":"error",size:"medium"},{default:m(()=>{var y;return[O(D(((y=x.value)==null?void 0:y.healthyFlag)==="Y"?a(c)("healthy"):a(c)("unhealthy")),1)]}),_:1},8,["type"]),t(M,{vertical:""}),t(r,{text:"",type:"primary",onClick:f},{icon:m(()=>[t(A,{component:a(St)},null,8,["component"])]),default:m(()=>[O(" "+D(a(c)("backToList")),1)]),_:1})]}),_:1})]),_:1}),t(o,{value:_.value,"onUpdate:value":I[1]||(I[1]=n=>_.value=n),type:"card",animated:"",style:{"margin-top":"16px"}},{default:m(()=>[t(k,{name:"jvm",tab:a(c)("jvmMonitoring")},{default:m(()=>[t(o,{value:p.value,"onUpdate:value":I[0]||(I[0]=n=>p.value=n),type:"line",animated:""},{default:m(()=>[t(k,{name:"memory",tab:a(c)("memoryMonitor")},{default:m(()=>[t(Ma,{"jvm-resource-id":u.value},null,8,["jvm-resource-id"])]),_:1},8,["tab"]),t(k,{name:"gc",tab:a(c)("gcMonitor")},{default:m(()=>[t(La,{"jvm-resource-id":u.value},null,8,["jvm-resource-id"])]),_:1},8,["tab"]),t(k,{name:"thread",tab:a(c)("threadMonitor")},{default:m(()=>[t(eo,{"jvm-resource-id":u.value},null,8,["jvm-resource-id"])]),_:1},8,["tab"])]),_:1},8,["value"])]),_:1},8,["tab"]),t(k,{name:"component",tab:a(c)("componentMonitoring")},{default:m(()=>[t(po,{"jvm-resource-id":u.value},null,8,["jvm-resource-id"])]),_:1},8,["tab"])]),_:1},8,["value"])]),_:1},8,["tab"])):ge("",!0)]),_:1},8,["value"])])])}}}),Ao=ie(ho,[["__scopeId","data-v-a6af6f43"]]);export{Ao as default};
