import{_ as we,a as Ce,b as Ee,c as De}from"./Switch-DV7n8EG8.js";import{d as Y,c as S,o as f,a3 as Ue,a as ee,r as M,f as se,g as R,O as xe,h as ve,m as _,B as Fe,a4 as z,w as y,q as w,t as q,a5 as le,a6 as te,a7 as ue,a8 as de,H as V,I as H,x as re,C as Se,E as Oe,_ as ce,n as v,a9 as j,v as ie,N as Be,aa as ze,ab as fe,a2 as me,ac as Me,ad as Ne,ae as Ie,af as ge,ag as ye,Y as Te,b as Ae,X as $e,ah as he}from"./index-BWGkTP3E.js";import{_ as Le,a as je}from"./DatePicker-Dt3b5FDl.js";import{a as Pe,b as Ve,c as Re,d as Ke,e as qe,_ as He}from"./DataTable-Wmy4yEx3.js";const We={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ye=Y({name:"ExpandOutline",render:function(C,i){return f(),S("svg",We,i[0]||(i[0]=[Ue('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M432 320v112H320"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M421.8 421.77L304 304"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M80 192V80h112"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M90.2 90.23L208 208"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M320 80h112v112"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M421.77 90.2L304 208"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M192 432H80V320"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M90.23 421.8L208 304"></path>',8)]))}}),Je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Qe=Y({name:"FilterOutline",render:function(C,i){return f(),S("svg",Je,i[0]||(i[0]=[ee("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 144h448"},null,-1),ee("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M112 256h288"},null,-1),ee("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M208 368h96"},null,-1)]))}}),Xe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Ge=Y({name:"EllipsisOutlined",render:function(C,i){return f(),S("svg",Xe,i[0]||(i[0]=[ee("path",{d:"M176 511a56 56 0 1 0 112 0a56 56 0 1 0-112 0zm280 0a56 56 0 1 0 112 0a56 56 0 1 0-112 0zm280 0a56 56 0 1 0 112 0a56 56 0 1 0-112 0z",fill:"currentColor"},null,-1)]))}}),Ze={class:"hh-form-container"},et={class:"form-actions"},tt=Y({__name:"HubForm",props:{config:{},modelValue:{},showButtons:{type:Boolean},formOperationType:{}},emits:["update:modelValue","submit","reset"],setup(p,{expose:C,emit:i}){const u=p,E=i,a=M(null),l=se({}),h=t=>{var r;return u.config.formOperationType==="add"||u.formOperationType==="add"?!1:u.config.formOperationType==="view"||u.formOperationType==="view"||u.config.formOperationType==="delete"||u.formOperationType==="delete"||(u.config.formOperationType==="edit"||u.formOperationType==="edit")&&t.primaryKey?!0:((r=t.props)==null?void 0:r.disabled)===!0},A=()=>{if(u.config.submitButtonText)return u.config.submitButtonText;switch(u.config.formOperationType||u.formOperationType){case"search":return"查询";case"add":return"新增";case"edit":return"更新";case"delete":return"删除";default:return"提交"}},F=R(()=>{if(u.config.formOperationType==="view"||u.formOperationType==="view")return!1;if(u.showButtons!==void 0)return u.showButtons}),D=R(()=>u.config.formOperationType==="delete"||u.formOperationType==="delete"?u.config.fields.filter(t=>t.primaryKey&&!t.hidden):u.config.fields.filter(t=>!t.hidden));xe(()=>u.modelValue,t=>{t&&(Object.keys(l).forEach(r=>{delete l[r]}),Object.assign(l,t))},{immediate:!0,deep:!0}),ve(()=>{if(u.modelValue)Object.keys(l).forEach(t=>{delete l[t]}),Object.assign(l,u.modelValue);else{const t={};u.config.fields.forEach(r=>{t[r.field]=r.value!==void 0?r.value:null}),Object.keys(l).forEach(r=>{delete l[r]}),Object.assign(l,t)}});const U=(t,r)=>{l[t]=r},N=t=>{if(!t)return null;if(typeof t=="number")return t;if(t instanceof Date)return t.getTime();if(typeof t=="string"){const r=new Date(t);return isNaN(r.getTime())?null:r.getTime()}return null},n=(t,r)=>{if(!r){l[t]=null;return}const b=new Date(r);isNaN(b.getTime())?l[t]=null:l[t]=b.toISOString()},m=()=>{var t;(t=a.value)==null||t.validate(r=>{r||E("submit",{...l})})},d=()=>new Promise((t,r)=>{if(!a.value){t(!0);return}a.value.validate(b=>{b?r(b):t({valid:!0})}).catch(()=>{})}),s=()=>{var r;(r=a.value)==null||r.restoreValidation();const t=u.modelValue?{...u.modelValue}:{};u.modelValue||u.config.fields.forEach(b=>{t[b.field]=b.value!==void 0?b.value:null}),Object.keys(l).forEach(b=>{b in t||(l[b]="")}),Object.entries(t).forEach(([b,I])=>{l[b]=I}),E("update:modelValue",{...t})};return C({validate:d,formData:l,resetFields:s}),(t,r)=>{const b=Oe,I=Pe,O=Le,L=je,W=Ee,ne=De,ae=Re,oe=Ve,J=qe,k=Ke,x=Se,$=Ce,Q=V,c=ue,g=we,T=Fe;return f(),S("div",Ze,[_(T,z({ref_key:"formRef",ref:a,model:l,"label-width":t.config.labelWidth||80,"label-placement":t.config.labelPlacement||"left",size:t.config.size||"small",inline:t.config.inline||!1},t.config.formProps||{},{"label-align":"right"}),{default:y(()=>[_(g,{cols:24,"x-gap":4},{default:y(()=>[(f(!0),S(le,null,te(D.value,e=>(f(),w($,{key:e.field,span:e.span||6},{default:y(()=>[_(x,{label:e.label,path:e.field,rule:e.rules},{default:y(()=>[e.type==="input"?(f(),w(b,z({key:0,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="textarea"?(f(),w(b,z({key:1,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,type:"textarea",placeholder:e.placeholder||`请输入${e.label}`,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="select"?(f(),w(I,z({key:2,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,options:e.groupOptions||e.options||[],placeholder:e.placeholder||`请选择${e.label}`,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","options","placeholder","disabled"])):e.type==="date"?(f(),w(O,z({key:3,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="time"?(f(),w(L,z({key:4,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="datetime"?(f(),w(O,z({key:5,type:"datetime",placeholder:e.placeholder||`请选择${e.label}`,value:N(l[e.field]),"onUpdate:value":o=>n(e.field,o),disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["placeholder","value","onUpdate:value","disabled"])):e.type==="number"?(f(),w(W,z({key:6,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="switch"?(f(),w(ne,z({key:7,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","disabled"])):e.type==="radio"?(f(),w(oe,z({key:8,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),{default:y(()=>[(f(!0),S(le,null,te(e.options||[],o=>(f(),w(ae,{key:String(o.value),value:o.value,disabled:o.disabled||h(e)},{default:y(()=>[H(re(o.label),1)]),_:2},1032,["value","disabled"]))),128))]),_:2},1040,["value","onUpdate:value","disabled"])):e.type==="checkbox"?(f(),w(k,z({key:9,value:l[e.field],"onUpdate:value":o=>l[e.field]=o,disabled:h(e),ref_for:!0},e.props||{},{size:"small"}),{default:y(()=>[(f(!0),S(le,null,te(e.options||[],o=>(f(),w(J,{key:String(o.value),value:o.value,disabled:o.disabled||h(e)},{default:y(()=>[H(re(o.label),1)]),_:2},1032,["value","disabled"]))),128))]),_:2},1040,["value","onUpdate:value","disabled"])):e.type==="custom"?de(t.$slots,e.field,{key:10,field:e,formData:l,disabled:h(e),updateValue:o=>U(e.field,o)},void 0,!0):q("",!0)]),_:2},1032,["label","path","rule"])]),_:2},1032,["span"]))),128)),F.value?(f(),w($,{key:0,span:24},{default:y(()=>[ee("div",et,[_(c,null,{default:y(()=>[de(t.$slots,"actions",{},void 0,!0),t.config.showSubmitButton!==!1?(f(),w(Q,z({key:0,type:"primary",onClick:m},t.config.submitButtonProps||{},{size:"small"}),{default:y(()=>[H(re(A()),1)]),_:1},16)):q("",!0),t.config.showResetButton!==!1?(f(),w(Q,z({key:1,onClick:s},t.config.resetButtonProps||{},{size:"small"}),{default:y(()=>[H(re(t.config.resetButtonText||"重置"),1)]),_:1},16)):q("",!0)]),_:3})])]),_:3})):q("",!0)]),_:3})]),_:3},16,["model","label-width","label-placement","size","inline"])])}}}),_e=ce(tt,[["__scopeId","data-v-a0fcf551"]]),nt={class:"hh-grid-container"},at=Y({__name:"HubGrid",props:{config:{},data:{}},emits:["update:pagination","action"],setup(p,{emit:C}){const i=p,u=C,E=M(null),a=R(()=>{if(i.config.rowKey){if(typeof i.config.rowKey=="string")return n=>n[i.config.rowKey];if(typeof i.config.rowKey=="function")return i.config.rowKey}return"primaryKey"in i.config&&Array.isArray(i.config.primaryKey)&&i.config.primaryKey.length>0?n=>i.config.primaryKey.map(d=>n[d]).join("_"):n=>n.id||n._id||JSON.stringify(n)}),l=R(()=>{if(!i.config.pagination)return!1;const n=i.config.pagination;return n?{page:n.pageIndex||1,pageSize:n.pageSize||10,itemCount:n.totalCount,pageCount:n.totalPageIndex,showSizePicker:n.showSizePicker||!0,pageSizes:n.pageSizes||[5,20,50,100],onUpdatePage:m=>{var d;u("update:pagination",{...n,pageIndex:m}),typeof((d=i.config.pagination)==null?void 0:d.onChange)=="function"&&i.config.pagination.onChange(m)},onUpdatePageSize:m=>{var d;u("update:pagination",{...n,pageIndex:1,pageSize:m}),typeof((d=i.config.pagination)==null?void 0:d.onUpdatePageSize)=="function"&&i.config.pagination.onUpdatePageSize(m)}}:!1});function h(n,m){return typeof n.disabled=="function"?n.disabled(m):!!n.disabled}function A(n,m){return typeof n.hidden=="function"?n.hidden(m):!!n.hidden}function F(n,m,d){var s;(s=n==null?void 0:n.onClick)==null||s.call(n,m,d),u("action",n.id,m,d)}function D(){return(n,m)=>{var r,b;const s=(((r=i.config.action)==null?void 0:r.buttons)||[]).filter(I=>!A(I,n)),t=((b=i.config.action)==null?void 0:b.maxVisibleButtons)||2;if(s.length<=t){const I=s.map(O=>j(V,{size:"small",type:O.type||"primary",disabled:h(O,n),onClick:()=>F(O,n,m)},()=>O.text));return j(ue,{justify:"center",size:"small",align:"center"},()=>I)}else{const I=[...s].sort((k,x)=>{const $=k.priority!==void 0?k.priority:999,Q=x.priority!==void 0?x.priority:999;return $-Q}),O=Math.max(1,t-1),L=I.slice(0,O),W=I.slice(O),ne=L.map(k=>j(V,{size:"small",type:k.type||"primary",disabled:h(k,n),onClick:()=>F(k,n,m)},()=>k.text)),ae=W.map(k=>({key:k.text,label:k.text,disabled:h(k,n)})),oe=j(Be,{options:ae,trigger:"click",size:"medium",style:{minWidth:"80px"},renderOption:k=>{const x=W.find($=>$.text===k.option.key);return x?j("div",{style:{padding:"4px 8px"}},[j(V,{size:"small",type:x.type||"primary",disabled:h(x,n),style:{width:"100%",textAlign:"center",margin:"0 auto"},onClick:()=>F(x,n,m)},()=>x.text)]):null},onSelect:k=>{const x=W.find($=>$.text===k);x&&F(x,n,m)}},{default:()=>j(V,{size:"small",type:"info",style:{margin:"0",borderRadius:"3px"}},{default:()=>"更多",icon:()=>j(ie,null,()=>j(Ge))})}),J=[...ne,oe];return j(ue,{justify:"center",size:"small",align:"center"},()=>J)}}}const U=R(()=>{var n,m,d;if(((n=i.config.action)==null?void 0:n.show)!==!1){const s={key:"action",title:((m=i.config.action)==null?void 0:m.title)||"操作",width:((d=i.config.action)==null?void 0:d.width)||150,fixed:"right",align:"center",render:D()};return[...i.config.columns.map(t=>({...t,width:t.width||150,align:t.align||"center",ellipsis:{tooltip:!0}})),s]}return i.config.columns.map(s=>({...s,width:s.width||150,ellipsis:{tooltip:!0}}))}),N=R(()=>{var d,s;const n=i.config.columns.reduce((t,r)=>t+(r.width||150),0),m=((d=i.config.action)==null?void 0:d.show)!==!1?((s=i.config.action)==null?void 0:s.width)||150:0;return n+m+100});return(n,m)=>(f(),S("div",nt,[_(v(He),{ref_key:"tableRef",ref:E,columns:U.value,data:n.data,pagination:l.value,"single-line":!1,bordered:n.config.bordered!==!1,striped:n.config.striped,size:n.config.size||"small",loading:n.config.loading,"row-key":a.value,"scroll-x":N.value,"table-layout":"fixed"},null,8,["columns","data","pagination","bordered","striped","size","loading","row-key","scroll-x"])]))}}),ot=ce(at,[["__scopeId","data-v-f7d7da4f"]]),rt={class:"hh-grid-form-container",id:"search-area-drawer"},it={class:"header-actions"},lt={key:0,class:"filter-button-area"},st={key:1,class:"toolbar-container"},ut=Y({__name:"HubGridForm",props:{config:{},tableData:{},loading:{type:Boolean,default:!1},pagination:{}},emits:["search","action","update:pagination","update:table-data"],setup(p,{expose:C,emit:i}){const u=p,E=i,a=M(),l=M(),h=se({}),A=R(()=>({pageIndex:1,pageSize:10,...u.pagination})),F=R(()=>({...u.config.grid,loading:u.loading,pagination:A.value})),D=M(!1),U=M(),N=se({}),n=M(!1),m=M(-1),d=M(""),s=R(()=>{switch(d.value){case"edit":return"编辑";case"add":return"新增";case"view":return"查看";case"delete":return"删除确认";default:return m.value===-1?"新增":"编辑"}}),t=M(!1),r=()=>{t.value=!t.value},b=R(()=>t.value?{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",maxWidth:"100vw",margin:0,borderRadius:0}:{width:"80%",maxWidth:"1024px"}),I=(c,g=null)=>typeof c.disabled=="function"?c.disabled(g):!!c.disabled,O=(c,g=null)=>typeof c.hidden=="function"?c.hidden(g):!!c.hidden,L=M(!1),W=()=>{Object.assign(h,a.value.formData),ne({...a.value.formData}),L.value=!1},ne=c=>{E("search",{...c,...A.value})},ae=()=>{Object.keys(h).forEach(c=>{h[c]=void 0})},oe=c=>{E("update:pagination",c),E("search",{...h,...c})},J=(c=null,g=-1,T="edit")=>{m.value=g,d.value=T,c?Object.assign(N,c):Object.keys(N).forEach(e=>{N[e]=void 0}),D.value=!0},k=()=>{D.value=!1},x=async()=>{if(U.value)try{n.value=!0,await U.value.validate(),E("action",d.value,{...U.value.formData},m.value),k()}catch{}finally{n.value=!1}},$=(c,g,T)=>{if(c.id==="add"||c.id==="edit"||c.id==="view"||c.id==="delete"||c.modal===!0){J(g,T,c.id);return}typeof c.onClick=="function"?c.onClick(g,T):E("action",c.id,g,T)},Q=(c,g,T)=>{var o,B,X;const e=(X=(B=(o=u.config.grid)==null?void 0:o.action)==null?void 0:B.buttons)==null?void 0:X.find(ke=>ke.id===c);e&&!O(e,g)&&$(e,g,T)};return C({getSearchFormData:()=>({...h}),resetSearchForm:()=>{a.value&&a.value.resetFields()},openEditModal:J,closeEditModal:k}),(c,g)=>{var T,e;return f(),S("div",rt,[ee("div",it,[c.config.searchForm?(f(),S("div",lt,[_(v(V),{size:"small",onClick:g[0]||(g[0]=o=>L.value=!L.value)},{icon:y(()=>[_(v(ie),null,{default:y(()=>[_(v(Qe))]),_:1})]),default:y(()=>[g[5]||(g[5]=H(" 筛选条件 ")),_(v(ie),{style:{"margin-left":"4px"}},{default:y(()=>[(f(),w(me(L.value?"chevron-up-outline":"chevron-down-outline")))]),_:1})]),_:1})])):q("",!0),(e=(T=c.config.toolbar)==null?void 0:T.buttons)!=null&&e.length?(f(),S("div",st,[_(v(ue),null,{default:y(()=>[(f(!0),S(le,null,te(c.config.toolbar.buttons,o=>(f(),S(le,{key:o.id},[O(o)?q("",!0):(f(),w(v(V),{key:0,type:o.type,disabled:I(o),size:"small",onClick:B=>$(o,null,-1)},{default:y(()=>[o.icon?(f(),w(v(ie),{key:0},{default:y(()=>[(f(),w(me(o.icon)))]),_:2},1024)):q("",!0),H(" "+re(o.text),1)]),_:2},1032,["type","disabled","onClick"]))],64))),128))]),_:1})])):q("",!0)]),_(v(Ne),{show:L.value,"onUpdate:show":g[2]||(g[2]=o=>L.value=o),placement:"top",to:"#search-area-drawer","show-mask":!1},{default:y(()=>[_(v(Me),{closable:!0,title:"筛选条件"},{default:y(()=>{var o;return[_(_e,{ref_key:"searchFormRef",ref:a,config:c.config.searchForm,"model-value":h,"onUpdate:modelValue":g[1]||(g[1]=B=>Object.assign(h,B)),"show-buttons":!0,onSubmit:W,onReset:ae},fe({_:2},[te((o=c.config.searchForm)==null?void 0:o.fields,B=>({name:B.field,fn:y(X=>[de(c.$slots,`search-${B.field}`,ge(ye(X)),void 0,!0)])}))]),1032,["config","model-value"])]}),_:3})]),_:3},8,["show"]),_(ot,{ref_key:"gridRef",ref:l,config:F.value,data:u.tableData,"onUpdate:pagination":oe,onAction:Q},null,8,["config","data"]),_(v(Ie),{show:D.value,"onUpdate:show":g[4]||(g[4]=o=>D.value=o),title:s.value,preset:"card",style:ze(b.value),draggable:!0,"transform-origin":"center",size:"medium"},fe({"header-extra":y(()=>[_(v(V),{quaternary:"",circle:"",size:"small",type:"tertiary",onClick:r},{icon:y(()=>[_(v(ie),{size:"18"},{default:y(()=>[_(v(Ye))]),_:1})]),_:1})]),default:y(()=>{var o;return[_(_e,{ref_key:"editFormRef",ref:U,config:c.config.editForm,"model-value":N,"onUpdate:modelValue":g[3]||(g[3]=B=>Object.assign(N,B)),"show-buttons":!1,"form-operation-type":d.value},fe({_:2},[te((o=c.config.editForm)==null?void 0:o.fields,B=>({name:B.field,fn:y(X=>[de(c.$slots,`edit-${B.field}`,ge(ye(X)),void 0,!0)])}))]),1032,["config","model-value","form-operation-type"])]}),_:2},[d.value!=="view"?{name:"action",fn:y(()=>[_(v(ue),null,{default:y(()=>[_(v(V),{type:"primary",loading:n.value,onClick:x},{default:y(()=>g[6]||(g[6]=[H("提交")])),_:1},8,["loading"]),_(v(V),{onClick:k},{default:y(()=>g[7]||(g[7]=[H("关闭")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["show","title","style"])])}}}),dt=ce(ut,[["__scopeId","data-v-36e17e04"]]),pe=Te("/gateway/hub0002");async function ct(p){return pe.post("/queryUsers",p)}async function pt(p,C){return pe.post("/deleteUser",{userId:p,tenantId:C})}async function ft(p){return pe.post("/editUser",p)}async function mt(p){return pe.post("/addUser",p)}var G=(p=>(p.ENABLED="Y",p.DISABLED="N",p))(G||{}),Z=(p=>(p[p.UNKNOWN=0]="UNKNOWN",p[p.MALE=1]="MALE",p[p.FEMALE=2]="FEMALE",p))(Z||{}),P=(p=>(p.YES="Y",p.NO="N",p))(P||{});function be(){const p=M(),C={searchForm:{fields:[{field:"userName",label:"用户名",type:"input",span:4},{field:"realName",label:"姓名",type:"input",span:4},{field:"mobile",label:"手机号",type:"input",span:4},{field:"email",label:"邮箱",type:"input",span:4},{field:"statusFlag",label:"状态",type:"select",options:[{label:"启用",value:G.ENABLED},{label:"禁用",value:G.DISABLED}]}],submitButtonText:"查询"},editForm:{fields:[{field:"userId",label:"用户ID",type:"input",primaryKey:!0,props:{}},{field:"tenantId",label:"租户ID",type:"input",primaryKey:!0,props:{}},{field:"userName",label:"用户名",type:"input",rules:[{required:!0,message:"请输入用户名"}]},{field:"password",label:"密码",type:"input",placeholder:"不修改请留空",props:{type:"password"}},{field:"realName",label:"姓名",type:"input",rules:[{required:!0,message:"请输入姓名"}]},{field:"deptId",label:"部门ID",type:"input",rules:[{required:!0,message:"请输入部门ID"}]},{field:"email",label:"邮箱",type:"input",rules:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入正确的邮箱格式"}]},{field:"mobile",label:"手机号",type:"input",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码"}]},{field:"avatar",label:"头像",type:"input",placeholder:"请输入头像URL"},{field:"gender",label:"性别",type:"select",options:[{label:"男",value:Z.MALE},{label:"女",value:Z.FEMALE},{label:"未知",value:Z.UNKNOWN}]},{field:"statusFlag",label:"状态",type:"select",rules:[{required:!0,message:"请选择状态"}],options:[{label:"启用",value:G.ENABLED},{label:"禁用",value:G.DISABLED}]},{field:"userExpireDate",label:"过期时间",type:"datetime",rules:[{required:!0,message:"请选择用户过期时间"}],props:{format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"}},{field:"deptAdminFlag",label:"部门管理员",type:"select",rules:[{required:!0,message:"请选择是否为部门管理员"}],options:[{label:"是",value:P.YES},{label:"否",value:P.NO}]},{field:"tenantAdminFlag",label:"租户管理员",type:"select",rules:[{required:!0,message:"请选择是否为租户管理员"}],options:[{label:"是",value:P.YES},{label:"否",value:P.NO}]},{field:"activeFlag",label:"活动状态",type:"select",rules:[{required:!0,message:"请选择活动状态"}],options:[{label:"活动",value:P.YES},{label:"非活动",value:P.NO}]},{field:"noteText",label:"备注",type:"textarea",span:24}],labelWidth:100,labelPlacement:"left",showResetButton:!0,resetButtonText:"重置"},grid:{columns:[{key:"userId",title:"用户ID",width:100},{key:"tenantId",title:"租户ID",width:100},{key:"userName",title:"用户名"},{key:"realName",title:"姓名"},{key:"deptId",title:"部门ID",width:100},{key:"mobile",title:"手机号"},{key:"email",title:"邮箱"},{key:"avatar",title:"头像",width:80,render:a=>a.avatar?"有":"无"},{key:"gender",title:"性别",width:80,render:a=>{switch(a.gender){case Z.MALE:return"男";case Z.FEMALE:return"女";default:return"未知"}}},{key:"statusFlag",title:"状态",width:80,render:a=>a.statusFlag===G.ENABLED?"启用":"禁用"},{key:"userExpireDate",title:"过期时间",width:150,render:a=>a.userExpireDate?new Date(a.userExpireDate).toLocaleString():"永不过期"},{key:"deptAdminFlag",title:"部门管理员",width:100,render:a=>a.deptAdminFlag===P.YES?"是":"否"},{key:"tenantAdminFlag",title:"租户管理员",width:100,render:a=>a.tenantAdminFlag===P.YES?"是":"否"},{key:"lastLoginTime",title:"最后登录时间",width:150,render:a=>a.lastLoginTime?new Date(a.lastLoginTime).toLocaleString():"未登录"},{key:"lastLoginIp",title:"最后登录IP",width:120},{key:"addTime",title:"创建时间",width:150,render:a=>a.addTime?new Date(a.addTime).toLocaleString():""},{key:"addWho",title:"创建人",width:100},{key:"editTime",title:"修改时间",width:150,render:a=>a.editTime?new Date(a.editTime).toLocaleString():""},{key:"editWho",title:"修改人",width:100},{key:"oprSeqFlag",title:"操作序列",width:100},{key:"currentVersion",title:"版本号",width:80},{key:"activeFlag",title:"活动状态",width:80,render:a=>a.activeFlag===P.YES?"活动":"非活动"},{key:"noteText",title:"备注",width:150}],action:{show:!0,width:200,title:"操作",buttons:[{id:"edit",text:"编辑",type:"primary"},{id:"delete",text:"删除",type:"error"},{id:"view",text:"查看",type:"primary"}]}},toolbar:{show:!0,buttons:[{id:"add",text:"新增",type:"primary"}]}},i=se({pageIndex:1,pageSize:5,totalCount:0,baseData:"",curPageCount:0,dbsId:"",mainKey:"",orderByList:"",otherData:"",paramObjectsJson:"",timeTypeFieldNames:"",totalPageIndex:0}),u=se([]),E=M(0);return{gridFormRef:p,formConfig:C,pagination:i,userList:u,totalCount:E}}const K=$e("UserManagement");function gt(p){const C=p||be(),{userList:i,pagination:u,totalCount:E}=C,a=Ae(),l=d=>{if(d.bizData)try{return JSON.parse(d.bizData)}catch(s){throw K.error("解析JsonDataObj失败",s),a.error("解析数据失败"),new Error("解析数据失败")}return{}},h=d=>{if(d.pageQueryData)try{return JSON.parse(d.pageQueryData)}catch(s){throw K.error("解析分页信息失败",s),a.error("解析分页信息失败"),new Error("解析分页信息失败")}return{}},A=async d=>{try{const s=await ct(d),t=l(s),r=h(s);i.length=0,t&&Array.isArray(t)&&i.push(...t),r&&(Object.assign(u,r),r.totalCount&&(E.value=r.totalCount))}catch(s){K.error("加载用户数据失败",s),a.error("加载用户数据失败")}},F=async(d={})=>{await A({...d,pageIndex:u.pageIndex,pageSize:u.pageSize})},D=async d=>{Object.assign(u,d),await F()},U=async(d,s)=>{try{const t=await ft(d);if(t.oK&&t.state){const r=l(t);return s!==-1&&r&&(i[s]=r),a.success(t.popMsg||"编辑用户成功"),r}else return a.error(t.popMsg||"编辑用户失败"),null}catch(t){return K.error("编辑用户出错",t),a.error("编辑用户请求失败"),null}},N=async(d,s,t)=>{try{const r=await pt(d,s);return r.oK&&r.state?(i.splice(t,1),a.success(r.popMsg||"删除用户成功"),!0):(a.error(r.popMsg||"删除用户失败"),!1)}catch(r){return K.error("删除用户出错",r),a.error("删除用户请求失败"),!1}},n=async d=>{try{const s=await mt(d);if(s.oK&&s.state){const t=l(s);return i.push(t),a.success(s.popMsg||"添加用户成功"),t}else return a.error(s.popMsg||"添加用户失败"),null}catch(s){return K.error("添加用户出错",s),a.error("添加用户请求失败"),null}};return{loadUserData:A,handleSearch:F,handlePaginationChange:D,handleAction:async(d,s,t)=>{try{switch(d){case"edit":await U(s,t);break;case"delete":s.userId&&s.tenantId&&await N(s.userId,s.tenantId,t);break;case"add":await n(s);break;case"view":a.info(`查看用户: ${s.realName||s.userName}`);break;default:K.warn(`Unhandled action: ${d}`);return}}catch(r){K.error(`Failed to ${d} user:`,r),a.error(`执行 ${d} 操作失败`)}},editUser:U,deleteUser:N,addUser:n}}const yt={class:"user-management-container"},ht=Y({__name:"UserManagement",setup(p){const C=be(),{userList:i,pagination:u,formConfig:E,gridFormRef:a}=C,{handleSearch:l,handlePaginationChange:h,handleAction:A}=gt(C);return ve(async()=>{try{await l()}catch(F){console.error("Failed to load initial data:",F)}}),(F,D)=>(f(),S("div",yt,[_(dt,{ref_key:"gridFormRef",ref:a,"table-data":v(i),"onUpdate:tableData":D[0]||(D[0]=U=>he(i)?i.value=U:null),pagination:v(u),"onUpdate:pagination":D[1]||(D[1]=U=>he(u)?u.value=U:null),config:v(E),onSearch:v(l),onPaginationChange:v(h),onAction:v(A)},null,8,["table-data","pagination","config","onSearch","onPaginationChange","onAction"])]))}}),wt=ce(ht,[["__scopeId","data-v-bc1ab220"]]);export{wt as default};
