import{_ as he,a as _e}from"./Grid-DtPWGMN9.js";import{d as L,c as C,o as s,ad as ve,a as Q,r as M,f as se,g as R,R as ye,h as me,m as g,B as ke,ae as B,w as c,q as y,t as K,aa as oe,ab as X,a7 as ae,af as ie,I as V,J as H,x as te,C as be,E as we,_ as re,n as h,ag as N,v as ne,N as Ce,ah as ze,ai as le,a4 as ue,aj as xe,ak as Oe,al as Be,am as de,an as ce,ao as pe}from"./index-CzIbiPcR.js";import{N as Se,_ as Fe}from"./DatePicker-B9xNNxDH.js";import{N as Ue}from"./InputNumber-DYqA-vrb.js";import{a as je,b as Te,_ as $e}from"./DataTable-CMD0QL_W.js";import{_ as De,a as Me,b as Ee}from"./RadioGroup-BBKwhzSS.js";import{N as Ne}from"./Switch-DmPX386B.js";import{u as Ve,a as Re}from"./useUserManagement-CZMqE6dr.js";const Pe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ie=L({name:"ExpandOutline",render:function(T,i){return s(),C("svg",Pe,i[0]||(i[0]=[ve('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M432 320v112H320"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M421.8 421.77L304 304"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M80 192V80h112"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M90.2 90.23L208 208"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M320 80h112v112"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M421.77 90.2L304 208"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M192 432H80V320"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M90.23 421.8L208 304"></path>',8)]))}}),Ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ke=L({name:"FilterOutline",render:function(T,i){return s(),C("svg",Ae,i[0]||(i[0]=[Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 144h448"},null,-1),Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M112 256h288"},null,-1),Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M208 368h96"},null,-1)]))}}),He={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},We=L({name:"EllipsisOutlined",render:function(T,i){return s(),C("svg",He,i[0]||(i[0]=[Q("path",{d:"M176 511a56 56 0 1 0 112 0a56 56 0 1 0-112 0zm280 0a56 56 0 1 0 112 0a56 56 0 1 0-112 0zm280 0a56 56 0 1 0 112 0a56 56 0 1 0-112 0z",fill:"currentColor"},null,-1)]))}}),Le={class:"hh-form-container"},Ge={class:"form-actions"},qe=L({__name:"HubForm",props:{config:{},modelValue:{},showButtons:{type:Boolean},formOperationType:{}},emits:["update:modelValue","submit","reset"],setup(P,{expose:T,emit:i}){const r=P,S=i,b=M(null),a=se({}),f=t=>{var u;return r.config.formOperationType==="add"||r.formOperationType==="add"?!1:r.config.formOperationType==="view"||r.formOperationType==="view"||r.config.formOperationType==="delete"||r.formOperationType==="delete"||(r.config.formOperationType==="edit"||r.formOperationType==="edit")&&t.primaryKey?!0:((u=t.props)==null?void 0:u.disabled)===!0},A=()=>{if(r.config.submitButtonText)return r.config.submitButtonText;switch(r.config.formOperationType||r.formOperationType){case"search":return"查询";case"add":return"新增";case"edit":return"更新";case"delete":return"删除";default:return"提交"}},$=R(()=>{if(r.config.formOperationType==="view"||r.formOperationType==="view")return!1;if(r.showButtons!==void 0)return r.showButtons}),z=R(()=>r.config.formOperationType==="delete"||r.formOperationType==="delete"?r.config.fields.filter(t=>t.primaryKey&&!t.hidden):r.config.fields.filter(t=>!t.hidden));ye(()=>r.modelValue,t=>{t&&(Object.keys(a).forEach(u=>{delete a[u]}),Object.assign(a,t))},{immediate:!0,deep:!0}),me(()=>{if(r.modelValue)Object.keys(a).forEach(t=>{delete a[t]}),Object.assign(a,r.modelValue);else{const t={};r.config.fields.forEach(u=>{t[u.field]=u.value!==void 0?u.value:null}),Object.keys(a).forEach(u=>{delete a[u]}),Object.assign(a,t)}});const F=(t,u)=>{a[t]=u},I=t=>{if(!t)return null;if(typeof t=="number")return t;if(t instanceof Date)return t.getTime();if(typeof t=="string"){const u=new Date(t);return isNaN(u.getTime())?null:u.getTime()}return null},n=(t,u)=>{if(!u){a[t]=null;return}const _=new Date(u);isNaN(_.getTime())?a[t]=null:a[t]=_.toISOString()},p=()=>{var t;(t=b.value)==null||t.validate(u=>{u||S("submit",{...a})})},m=()=>new Promise((t,u)=>{if(!b.value){t(!0);return}b.value.validate(_=>{_?u(_):t({valid:!0})}).catch(()=>{})}),k=()=>{var u;(u=b.value)==null||u.restoreValidation();const t=r.modelValue?{...r.modelValue}:{};r.modelValue||r.config.fields.forEach(_=>{t[_.field]=_.value!==void 0?_.value:null}),Object.keys(a).forEach(_=>{_ in t||(a[_]="")}),Object.entries(t).forEach(([_,U])=>{a[_]=U}),S("update:modelValue",{...t})};return T({validate:m,formData:a,resetFields:k}),(t,u)=>{const _=we,U=De,x=Se,E=Fe,W=Ue,Y=Ne,Z=Ee,ee=Me,G=Te,v=je,w=be,D=_e,q=V,l=ae,d=he,j=ke;return s(),C("div",Le,[g(j,B({ref_key:"formRef",ref:b,model:a,"label-width":t.config.labelWidth||80,"label-placement":t.config.labelPlacement||"left",size:t.config.size||"small",inline:t.config.inline||!1},t.config.formProps||{},{"label-align":"right"}),{default:c(()=>[g(d,{cols:24,"x-gap":4},{default:c(()=>[(s(!0),C(oe,null,X(z.value,e=>(s(),y(D,{key:e.field,span:e.span||6},{default:c(()=>[g(w,{label:e.label,path:e.field,rule:e.rules},{default:c(()=>[e.type==="input"?(s(),y(_,B({key:0,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="textarea"?(s(),y(_,B({key:1,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,type:"textarea",placeholder:e.placeholder||`请输入${e.label}`,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="select"?(s(),y(U,B({key:2,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,options:e.groupOptions||e.options||[],placeholder:e.placeholder||`请选择${e.label}`,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","options","placeholder","disabled"])):e.type==="date"?(s(),y(x,B({key:3,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="time"?(s(),y(E,B({key:4,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="datetime"?(s(),y(x,B({key:5,type:"datetime",placeholder:e.placeholder||`请选择${e.label}`,value:I(a[e.field]),"onUpdate:value":o=>n(e.field,o),disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["placeholder","value","onUpdate:value","disabled"])):e.type==="number"?(s(),y(W,B({key:6,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","placeholder","disabled"])):e.type==="switch"?(s(),y(Y,B({key:7,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),null,16,["value","onUpdate:value","disabled"])):e.type==="radio"?(s(),y(ee,B({key:8,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),{default:c(()=>[(s(!0),C(oe,null,X(e.options||[],o=>(s(),y(Z,{key:String(o.value),value:o.value,disabled:o.disabled||f(e)},{default:c(()=>[H(te(o.label),1)]),_:2},1032,["value","disabled"]))),128))]),_:2},1040,["value","onUpdate:value","disabled"])):e.type==="checkbox"?(s(),y(v,B({key:9,value:a[e.field],"onUpdate:value":o=>a[e.field]=o,disabled:f(e),ref_for:!0},e.props||{},{size:"small"}),{default:c(()=>[(s(!0),C(oe,null,X(e.options||[],o=>(s(),y(G,{key:String(o.value),value:o.value,disabled:o.disabled||f(e)},{default:c(()=>[H(te(o.label),1)]),_:2},1032,["value","disabled"]))),128))]),_:2},1040,["value","onUpdate:value","disabled"])):e.type==="custom"?ie(t.$slots,e.field,{key:10,field:e,formData:a,disabled:f(e),updateValue:o=>F(e.field,o)},void 0,!0):K("",!0)]),_:2},1032,["label","path","rule"])]),_:2},1032,["span"]))),128)),$.value?(s(),y(D,{key:0,span:24},{default:c(()=>[Q("div",Ge,[g(l,null,{default:c(()=>[ie(t.$slots,"actions",{},void 0,!0),t.config.showSubmitButton!==!1?(s(),y(q,B({key:0,type:"primary",onClick:p},t.config.submitButtonProps||{},{size:"small"}),{default:c(()=>[H(te(A()),1)]),_:1},16)):K("",!0),t.config.showResetButton!==!1?(s(),y(q,B({key:1,onClick:k},t.config.resetButtonProps||{},{size:"small"}),{default:c(()=>[H(te(t.config.resetButtonText||"重置"),1)]),_:1},16)):K("",!0)]),_:3})])]),_:3})):K("",!0)]),_:3})]),_:3},16,["model","label-width","label-placement","size","inline"])])}}}),fe=re(qe,[["__scopeId","data-v-a0fcf551"]]),Je={class:"hh-grid-container"},Qe=L({__name:"HubGrid",props:{config:{},data:{}},emits:["update:pagination","action"],setup(P,{emit:T}){const i=P,r=T,S=M(null),b=R(()=>{if(i.config.rowKey){if(typeof i.config.rowKey=="string")return n=>n[i.config.rowKey];if(typeof i.config.rowKey=="function")return i.config.rowKey}return"primaryKey"in i.config&&Array.isArray(i.config.primaryKey)&&i.config.primaryKey.length>0?n=>i.config.primaryKey.map(m=>n[m]).join("_"):n=>n.id||n._id||JSON.stringify(n)}),a=R(()=>{if(!i.config.pagination)return!1;const n=i.config.pagination;return n?{page:n.pageIndex||1,pageSize:n.pageSize||10,itemCount:n.totalCount,pageCount:n.totalPageIndex,showSizePicker:n.showSizePicker||!0,pageSizes:n.pageSizes||[5,20,50,100],onUpdatePage:p=>{var m;r("update:pagination",{...n,pageIndex:p}),typeof((m=i.config.pagination)==null?void 0:m.onChange)=="function"&&i.config.pagination.onChange(p)},onUpdatePageSize:p=>{var m;r("update:pagination",{...n,pageIndex:1,pageSize:p}),typeof((m=i.config.pagination)==null?void 0:m.onUpdatePageSize)=="function"&&i.config.pagination.onUpdatePageSize(p)}}:!1});function f(n,p){return typeof n.disabled=="function"?n.disabled(p):!!n.disabled}function A(n,p){return typeof n.hidden=="function"?n.hidden(p):!!n.hidden}function $(n,p,m){var k;(k=n==null?void 0:n.onClick)==null||k.call(n,p,m),r("action",n.id,p,m)}function z(){return(n,p)=>{var u,_;const k=(((u=i.config.action)==null?void 0:u.buttons)||[]).filter(U=>!A(U,n)),t=((_=i.config.action)==null?void 0:_.maxVisibleButtons)||2;if(k.length<=t){const U=k.map(x=>N(V,{size:"small",type:x.type||"primary",disabled:f(x,n),onClick:()=>$(x,n,p)},()=>x.text));return N(ae,{justify:"center",size:"small",align:"center"},()=>U)}else{const U=[...k].sort((v,w)=>{const D=v.priority!==void 0?v.priority:999,q=w.priority!==void 0?w.priority:999;return D-q}),x=Math.max(1,t-1),E=U.slice(0,x),W=U.slice(x),Y=E.map(v=>N(V,{size:"small",type:v.type||"primary",disabled:f(v,n),onClick:()=>$(v,n,p)},()=>v.text)),Z=W.map(v=>({key:v.text,label:v.text,disabled:f(v,n)})),ee=N(Ce,{options:Z,trigger:"click",size:"medium",style:{minWidth:"80px"},renderOption:v=>{const w=W.find(D=>D.text===v.option.key);return w?N("div",{style:{padding:"4px 8px"}},[N(V,{size:"small",type:w.type||"primary",disabled:f(w,n),style:{width:"100%",textAlign:"center",margin:"0 auto"},onClick:()=>$(w,n,p)},()=>w.text)]):null},onSelect:v=>{const w=W.find(D=>D.text===v);w&&$(w,n,p)}},{default:()=>N(V,{size:"small",type:"info",style:{margin:"0",borderRadius:"3px"}},{default:()=>"更多",icon:()=>N(ne,null,()=>N(We))})}),G=[...Y,ee];return N(ae,{justify:"center",size:"small",align:"center"},()=>G)}}}const F=R(()=>{var n,p,m;if(((n=i.config.action)==null?void 0:n.show)!==!1){const k={key:"action",title:((p=i.config.action)==null?void 0:p.title)||"操作",width:((m=i.config.action)==null?void 0:m.width)||150,fixed:"right",align:"center",render:z()};return[...i.config.columns.map(t=>({...t,width:t.width||150,align:t.align||"center",ellipsis:{tooltip:!0}})),k]}return i.config.columns.map(k=>({...k,width:k.width||150,ellipsis:{tooltip:!0}}))}),I=R(()=>{var m,k;const n=i.config.columns.reduce((t,u)=>t+(u.width||150),0),p=((m=i.config.action)==null?void 0:m.show)!==!1?((k=i.config.action)==null?void 0:k.width)||150:0;return n+p+100});return(n,p)=>(s(),C("div",Je,[g(h($e),{ref_key:"tableRef",ref:S,columns:F.value,data:n.data,pagination:a.value,"single-line":!1,bordered:n.config.bordered!==!1,striped:n.config.striped,size:n.config.size||"small",loading:n.config.loading,"row-key":b.value,"scroll-x":I.value,"table-layout":"fixed"},null,8,["columns","data","pagination","bordered","striped","size","loading","row-key","scroll-x"])]))}}),Xe=re(Qe,[["__scopeId","data-v-f7d7da4f"]]),Ye={class:"hh-grid-form-container",id:"search-area-drawer"},Ze={class:"header-actions"},et={key:0,class:"filter-button-area"},tt={key:1,class:"toolbar-container"},nt=L({__name:"HubGridForm",props:{config:{},tableData:{},loading:{type:Boolean,default:!1},pagination:{}},emits:["search","action","update:pagination","update:table-data"],setup(P,{expose:T,emit:i}){const r=P,S=i,b=M(),a=M(),f=se({}),A=R(()=>({pageIndex:1,pageSize:10,...r.pagination})),$=R(()=>({...r.config.grid,loading:r.loading,pagination:A.value})),z=M(!1),F=M(),I=se({}),n=M(!1),p=M(-1),m=M(""),k=R(()=>{switch(m.value){case"edit":return"编辑";case"add":return"新增";case"view":return"查看";case"delete":return"删除确认";default:return p.value===-1?"新增":"编辑"}}),t=M(!1),u=()=>{t.value=!t.value},_=R(()=>t.value?{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",maxWidth:"100vw",margin:0,borderRadius:0}:{width:"80%",maxWidth:"1024px"}),U=(l,d=null)=>typeof l.disabled=="function"?l.disabled(d):!!l.disabled,x=(l,d=null)=>typeof l.hidden=="function"?l.hidden(d):!!l.hidden,E=M(!1),W=()=>{Object.assign(f,b.value.formData),Y({...b.value.formData}),E.value=!1},Y=l=>{S("search",{...l,...A.value})},Z=()=>{Object.keys(f).forEach(l=>{f[l]=void 0})},ee=l=>{S("update:pagination",l),S("search",{...f,...l})},G=(l=null,d=-1,j="edit")=>{p.value=d,m.value=j,l?Object.assign(I,l):Object.keys(I).forEach(e=>{I[e]=void 0}),z.value=!0},v=()=>{z.value=!1},w=async()=>{if(F.value)try{n.value=!0,await F.value.validate(),S("action",m.value,{...F.value.formData},p.value),v()}catch{}finally{n.value=!1}},D=(l,d,j)=>{if(l.id==="add"||l.id==="edit"||l.id==="view"||l.id==="delete"||l.modal===!0){G(d,j,l.id);return}typeof l.onClick=="function"?l.onClick(d,j):S("action",l.id,d,j)},q=(l,d,j)=>{var o,O,J;const e=(J=(O=(o=r.config.grid)==null?void 0:o.action)==null?void 0:O.buttons)==null?void 0:J.find(ge=>ge.id===l);e&&!x(e,d)&&D(e,d,j)};return T({getSearchFormData:()=>({...f}),resetSearchForm:()=>{b.value&&b.value.resetFields()},openEditModal:G,closeEditModal:v}),(l,d)=>{var j,e;return s(),C("div",Ye,[Q("div",Ze,[l.config.searchForm?(s(),C("div",et,[g(h(V),{size:"small",onClick:d[0]||(d[0]=o=>E.value=!E.value)},{icon:c(()=>[g(h(ne),null,{default:c(()=>[g(h(Ke))]),_:1})]),default:c(()=>[d[5]||(d[5]=H(" 筛选条件 ")),g(h(ne),{style:{"margin-left":"4px"}},{default:c(()=>[(s(),y(ue(E.value?"chevron-up-outline":"chevron-down-outline")))]),_:1})]),_:1})])):K("",!0),(e=(j=l.config.toolbar)==null?void 0:j.buttons)!=null&&e.length?(s(),C("div",tt,[g(h(ae),null,{default:c(()=>[(s(!0),C(oe,null,X(l.config.toolbar.buttons,o=>(s(),C(oe,{key:o.id},[x(o)?K("",!0):(s(),y(h(V),{key:0,type:o.type,disabled:U(o),size:"small",onClick:O=>D(o,null,-1)},{default:c(()=>[o.icon?(s(),y(h(ne),{key:0},{default:c(()=>[(s(),y(ue(o.icon)))]),_:2},1024)):K("",!0),H(" "+te(o.text),1)]),_:2},1032,["type","disabled","onClick"]))],64))),128))]),_:1})])):K("",!0)]),g(h(Oe),{show:E.value,"onUpdate:show":d[2]||(d[2]=o=>E.value=o),placement:"top",to:"#search-area-drawer","show-mask":!1},{default:c(()=>[g(h(xe),{closable:!0,title:"筛选条件"},{default:c(()=>{var o;return[g(fe,{ref_key:"searchFormRef",ref:b,config:l.config.searchForm,"model-value":f,"onUpdate:modelValue":d[1]||(d[1]=O=>Object.assign(f,O)),"show-buttons":!0,onSubmit:W,onReset:Z},le({_:2},[X((o=l.config.searchForm)==null?void 0:o.fields,O=>({name:O.field,fn:c(J=>[ie(l.$slots,`search-${O.field}`,de(ce(J)),void 0,!0)])}))]),1032,["config","model-value"])]}),_:3})]),_:3},8,["show"]),g(Xe,{ref_key:"gridRef",ref:a,config:$.value,data:r.tableData,"onUpdate:pagination":ee,onAction:q},null,8,["config","data"]),g(h(Be),{show:z.value,"onUpdate:show":d[4]||(d[4]=o=>z.value=o),title:k.value,preset:"card",style:ze(_.value),draggable:!0,"transform-origin":"center",size:"medium"},le({"header-extra":c(()=>[g(h(V),{quaternary:"",circle:"",size:"small",type:"tertiary",onClick:u},{icon:c(()=>[g(h(ne),{size:"18"},{default:c(()=>[g(h(Ie))]),_:1})]),_:1})]),default:c(()=>{var o;return[g(fe,{ref_key:"editFormRef",ref:F,config:l.config.editForm,"model-value":I,"onUpdate:modelValue":d[3]||(d[3]=O=>Object.assign(I,O)),"show-buttons":!1,"form-operation-type":m.value},le({_:2},[X((o=l.config.editForm)==null?void 0:o.fields,O=>({name:O.field,fn:c(J=>[ie(l.$slots,`edit-${O.field}`,de(ce(J)),void 0,!0)])}))]),1032,["config","model-value","form-operation-type"])]}),_:2},[m.value!=="view"?{name:"action",fn:c(()=>[g(h(ae),null,{default:c(()=>[g(h(V),{type:"primary",loading:n.value,onClick:w},{default:c(()=>d[6]||(d[6]=[H("提交")])),_:1},8,["loading"]),g(h(V),{onClick:v},{default:c(()=>d[7]||(d[7]=[H("关闭")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["show","title","style"])])}}}),ot=re(nt,[["__scopeId","data-v-36e17e04"]]),at={class:"user-management-container"},it=L({__name:"UserManagement",setup(P){const T=Ve(),{userList:i,pagination:r,formConfig:S,gridFormRef:b}=T,{handleSearch:a,handlePaginationChange:f,handleAction:A}=Re(T);return me(async()=>{try{await a()}catch($){console.error("Failed to load initial data:",$)}}),($,z)=>(s(),C("div",at,[g(ot,{ref_key:"gridFormRef",ref:b,"table-data":h(i),"onUpdate:tableData":z[0]||(z[0]=F=>pe(i)?i.value=F:null),pagination:h(r),"onUpdate:pagination":z[1]||(z[1]=F=>pe(r)?r.value=F:null),config:h(S),onSearch:h(a),onPaginationChange:h(f),onAction:h(A)},null,8,["table-data","pagination","config","onSearch","onPaginationChange","onAction"])]))}}),mt=re(it,[["__scopeId","data-v-bc1ab220"]]);export{mt as default};
