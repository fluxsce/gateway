import{P as ke}from"./index-DR_R-bYe.js";import{d as L,cx as Ee,c as b,f as n,b as S,o as u,e as G,_ as W,cy as Ne,cz as ne,y as re,cA as Ae,j as oe,a5 as E,h as f,ah as H,N as qe,w as z,J as _e,cv as se,K as Z,t as J,ag as Fe,cB as Me,a4 as ue,n as M,i as F,g as Y,aQ as V,bR as N,cC as Ve,r as le,cD as Je,am as P,cE as Re,cF as De,ci as He,v as Le,E as We,F as we,G as ze,T as X}from"./index-DjxxKbEp.js";/* empty css                                                                    */import{R as Ge}from"./RefreshOutline-RMMvHLjq.js";import{E as Ye,O as je}from"./OptionsOutline-CJ-6A-d8.js";import"./GPane-CsXIYqCJ.js";import{c as Qe,N as q}from"./DatePicker-CHfUawd3.js";import{I as Xe}from"./InformationCircleOutline-Co9yRxRj.js";import{_ as Ze,a as Be}from"./Grid-DuzVlp9K.js";import{_ as Se}from"./Select-DKaQ0jI7.js";import{N as Ie}from"./InputNumber-CTlCGkXq.js";import{N as Pe}from"./Switch-CTvADbq_.js";const Ke={class:"g-pagination"},et=L({name:"GPagination",__name:"GPagination",props:{pageInfo:{},currentPage:{default:1},pageSize:{default:20},total:{default:0},pageSizes:{default:()=>[10,20,50,100,200]},layouts:{default:()=>["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},align:{default:"right"},background:{type:Boolean,default:!0},perfect:{type:Boolean,default:!0},showJumper:{type:Boolean,default:!0},showTotal:{type:Boolean,default:!0},pagerOptions:{}},emits:["page-change","update:currentPage","update:pageSize"],setup(_,{expose:r,emit:c}){const t=Ee.getComponent("VxePager"),y=_,k=c,s=b(()=>{const h=n(y.pageInfo);return h?h.pageIndex:y.currentPage}),I=b(()=>{const h=n(y.pageInfo);return h?h.pageSize:y.pageSize}),U=b(()=>{const h=n(y.pageInfo);return h?h.totalCount:y.total}),R=b(()=>{const h=[...y.layouts];if(!y.showJumper){const w=h.indexOf("FullJump");w>-1&&h.splice(w,1)}return h}),$=b(()=>Math.ceil(U.value/I.value)),d=({currentPage:h,pageSize:w})=>{k("page-change",{currentPage:h,pageSize:w}),k("update:currentPage",h),k("update:pageSize",w)};return r({getTotalPages:()=>$.value,goToPage:h=>{h>=1&&h<=$.value&&d({currentPage:h,pageSize:I.value})},prevPage:()=>{s.value>1&&d({currentPage:s.value-1,pageSize:I.value})},nextPage:()=>{s.value<$.value&&d({currentPage:s.value+1,pageSize:I.value})}}),(h,w)=>(u(),S("div",Ke,[G(n(t),{"current-page":s.value,"page-size":I.value,total:U.value,"page-sizes":h.pageSizes,layouts:R.value,align:h.align,size:"mini",onPageChange:d},null,8,["current-page","page-size","total","page-sizes","layouts","align"])]))}}),tt=W(et,[["__scopeId","data-v-2c35df38"]]);function Et(_,r){return{pageIndex:_??ke.DEFAULT_PAGE_INDEX,pageSize:r??ke.DEFAULT_PAGE_SIZE}}function Ue(_,r="已复制到剪贴板",c="复制失败"){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(_).then(()=>{console.log(r)}).catch(t=>{console.error(c,t),$e(_,r,c)}):$e(_,r,c)}function $e(_,r,c){const t=document.createElement("textarea");t.value=_,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",t.style.opacity="0",t.style.pointerEvents="none",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")?console.log(r):console.error(c)}catch(y){console.error(c,y)}finally{document.body.removeChild(t)}}const at={class:"toolbar-button-wrapper"},ot=L({__name:"ToolbarButton",props:{button:{},moduleId:{}},emits:["click","dropdown-select"],setup(_,{emit:r}){const c=_,t=r,y=b(()=>{if(!c.button.icon)return null;if(typeof c.button.icon=="string"){const d=Ne(c.button.icon);return ne(d)}return c.button.icon}),k=b(()=>c.moduleId?`${c.moduleId}:${c.button.key}`:""),s=b(()=>{if(c.button.key==="more")return!0;const d=k.value;return d?re.user.hasButton(d):!0}),I=b(()=>c.button.disabled||!s.value),U=b(()=>c.button.dropdownOptions?c.button.dropdownOptions.map(d=>{let h=d.disabled;if(c.moduleId){const D=`${c.moduleId}:${d.key}`;re.user.hasButton(D)||(h=!0)}const w={key:d.key,label:d.label,disabled:h};return d.icon&&(w.icon=Ae(d.icon,oe)),d.divider&&(w.type="divider"),w}):[]),R=()=>{!I.value&&!c.button.loading&&t("click",c.button.key)},$=d=>{t("dropdown-select",c.button.key,d)};return(d,h)=>(u(),S("div",at,[E(d.$slots,"prefix",{},void 0,!0),d.button.render?(u(),f(H(d.button.render()),{key:0})):d.button.dropdown&&d.button.dropdownOptions?(u(),f(n(qe),{key:1,options:U.value,onSelect:$,trigger:"click"},{default:z(()=>[G(n(_e),{type:d.button.type||"default",size:d.button.size||"small",disabled:I.value,loading:d.button.loading,quaternary:""},se({default:z(()=>[Z(" "+J(d.button.label),1)]),_:2},[d.button.icon?{name:"icon",fn:z(()=>[G(n(oe),null,{default:z(()=>[(u(),f(H(y.value)))]),_:1})]),key:"0"}:void 0]),1032,["type","size","disabled","loading"])]),_:1},8,["options"])):(u(),f(n(Fe),{key:2,disabled:!d.button.tooltip,trigger:"hover"},{trigger:z(()=>[G(n(_e),{type:d.button.type||"default",size:d.button.size||"small",disabled:I.value,loading:d.button.loading,quaternary:"",onClick:R},se({default:z(()=>[Z(" "+J(d.button.label),1)]),_:2},[d.button.icon?{name:"icon",fn:z(()=>[G(n(oe),null,{default:z(()=>[(u(),f(H(y.value)))]),_:1})]),key:"0"}:void 0]),1032,["type","size","disabled","loading"])]),default:z(()=>[Z(" "+J(d.button.tooltip),1)]),_:1},8,["disabled"])),E(d.$slots,"suffix",{},void 0,!0)]))}}),ae=W(ot,[["__scopeId","data-v-e3e64b2d"]]),lt={key:0,class:"g-toolbar__title"},nt={class:"g-toolbar__title-text"},rt={key:1,class:"g-toolbar__left"},st={class:"g-toolbar__content"},ut={key:0,class:"g-toolbar__group-title"},it={class:"g-toolbar__group-buttons"},dt={key:2,class:"g-toolbar__center"},ct={key:3,class:"g-toolbar__right"},pt={key:0,class:"g-toolbar__group-title"},gt={class:"g-toolbar__group-buttons"},bt=L({name:"GToolbar",__name:"GToolbar",props:{moduleId:{},title:{},buttons:{},groups:{},align:{default:"left"},bordered:{type:Boolean,default:!0},shadow:{type:Boolean,default:!1},height:{}},emits:["button-click","dropdown-select"],setup(_,{expose:r,emit:c}){const t=_,y=c,k=Me(),s=b(()=>({height:t.height||"var(--g-toolbar-height)"})),I=b(()=>{var i;return((i=t.buttons)==null?void 0:i.filter(g=>g.show!==!1))||[]}),U=b(()=>I.value.filter(i=>i.atEnd===!0)),R=b(()=>I.value.filter(i=>i.atEnd!==!0)),$=b(()=>{var i;return((i=t.groups)==null?void 0:i.map(g=>({...g,buttons:g.buttons.filter(v=>v.show!==!1)})).filter(g=>g.buttons.length>0))||[]}),d=b(()=>$.value.map(i=>({...i,buttons:i.buttons.filter(g=>g.atEnd===!0)})).filter(i=>i.buttons.length>0)),h=b(()=>$.value.map(i=>({...i,buttons:i.buttons.filter(g=>g.atEnd!==!0)})).filter(i=>i.buttons.length>0)),w=async i=>{y("button-click",i);const g=x(i);g!=null&&g.onClick&&await g.onClick(i)},D=async(i,g)=>{var T;y("dropdown-select",i,g);const v=x(i),B=(T=v==null?void 0:v.dropdownOptions)==null?void 0:T.find(O=>O.key===g);B!=null&&B.onClick&&await B.onClick(g)},x=i=>{if(t.buttons)return t.buttons.find(g=>g.key===i);if(t.groups)for(const g of t.groups){const v=g.buttons.find(B=>B.key===i);if(v)return v}};return r({findButton:x}),(i,g)=>(u(),S("div",{class:M(["g-toolbar",[`g-toolbar--${i.align}`,{"g-toolbar--bordered":i.bordered,"g-toolbar--shadow":i.shadow}]]),style:ue(s.value)},[i.title||n(k).title?(u(),S("div",lt,[E(i.$slots,"title",{},()=>[Y("span",nt,J(i.title),1)],!0)])):F("",!0),n(k).left?(u(),S("div",rt,[E(i.$slots,"left",{},void 0,!0)])):F("",!0),Y("div",st,[E(i.$slots,"default",{},()=>[i.groups&&i.groups.length>0?(u(!0),S(V,{key:0},N(h.value,(v,B)=>(u(),S("div",{key:v.key,class:M(["g-toolbar__group",{"g-toolbar__group--divider":v.divider&&B>0}])},[v.title?(u(),S("span",ut,J(v.title),1)):F("",!0),Y("div",it,[(u(!0),S(V,null,N(v.buttons,(T,O)=>(u(),f(ae,{key:T.key,button:T,"module-id":t.moduleId,class:M({"g-toolbar__button--divider":O>0}),onClick:w,onDropdownSelect:D},null,8,["button","module-id","class"]))),128))])],2))),128)):i.buttons&&i.buttons.length>0?(u(!0),S(V,{key:1},N(R.value,(v,B)=>(u(),f(ae,{key:v.key,button:v,"module-id":t.moduleId,class:M({"g-toolbar__button--divider":B>0}),onClick:w,onDropdownSelect:D},null,8,["button","module-id","class"]))),128)):F("",!0)],!0)]),n(k).center?(u(),S("div",dt,[E(i.$slots,"center",{},void 0,!0)])):F("",!0),U.value.length>0||d.value.length>0||n(k).right?(u(),S("div",ct,[i.groups&&i.groups.length>0?(u(!0),S(V,{key:0},N(d.value,(v,B)=>(u(),S("div",{key:v.key,class:M(["g-toolbar__group",{"g-toolbar__group--divider":v.divider&&B>0}])},[v.title?(u(),S("span",pt,J(v.title),1)):F("",!0),Y("div",gt,[(u(!0),S(V,null,N(v.buttons,(T,O)=>(u(),f(ae,{key:T.key,button:T,"module-id":t.moduleId,class:M({"g-toolbar__button--divider":O>0}),onClick:w,onDropdownSelect:D},null,8,["button","module-id","class"]))),128))])],2))),128)):i.buttons&&i.buttons.length>0?(u(!0),S(V,{key:1},N(U.value,(v,B)=>(u(),f(ae,{key:v.key,button:v,"module-id":t.moduleId,class:M({"g-toolbar__button--divider":B>0}),onClick:w,onDropdownSelect:D},null,8,["button","module-id","class"]))),128)):F("",!0),E(i.$slots,"right",{},void 0,!0)])):F("",!0)],6))}}),Oe=W(bt,[["__scopeId","data-v-98c08beb"]]);function ft(_){const{props:r,emit:c,gridRef:t}=_,y=a=>{c("toolbar-button-click",a)},k=()=>{c("refresh")},s=()=>{t.value&&t.value.zoom()},I=()=>{if(t.value){const a=t.value.getCheckboxRecords();c("checkbox-change",a)}},U=a=>{c("cell-click",a)},R=a=>{c("cell-dblclick",a)},$=a=>{c("row-click",a)},d=a=>{c("sort-change",a)},h=a=>{c("filter-change",a)},w=({menu:a,row:m,column:l})=>{var e;const p=a==null?void 0:a.code;if(p==="copyRow"){const o=JSON.stringify(m,null,2);Ue(o)}else if(p==="copyCell"){const o=m==null?void 0:m[l==null?void 0:l.field];Ue(String(o??""))}c("menu-click",{code:p,row:m,column:l}),(e=r.menuConfig)!=null&&e.onMenuClick&&r.menuConfig.onMenuClick({code:p,row:m,column:l})},D=a=>{c("edit-actived",a)},x=a=>{c("edit-closed",a)},i=b(()=>{var a;return((a=r.toolbarConfig)==null?void 0:a.show)===!0}),g=b(()=>{var m,l,p,e;const a=[];return(m=r.toolbarConfig)!=null&&m.buttons&&a.push(...r.toolbarConfig.buttons),((l=r.toolbarConfig)==null?void 0:l.showRefresh)!==!1&&a.push({key:"refresh",label:"刷新",icon:Ge,tooltip:"刷新数据",onClick:k}),(p=r.toolbarConfig)!=null&&p.showColumnSetting&&a.push({key:"column-setting",label:"列设置",icon:Ve,tooltip:"列设置"}),(e=r.toolbarConfig)!=null&&e.showFullscreen&&a.push({key:"fullscreen",label:"全屏",icon:Ye,tooltip:"全屏显示",onClick:s}),a}),v=b(()=>{const a=[];return r.showCheckbox&&a.push({type:"checkbox",field:"__checkbox",width:50,align:"center",fixed:"left",resizable:!1}),r.showSeq&&a.push({type:"seq",field:"__seq",title:"序号",width:60,align:"center",resizable:!1,...r.seqConfig}),a.push(...r.columns.filter(m=>m.visible!==!1)),a}),B=b(()=>{if(!r.menuConfig||r.menuConfig.enabled===!1)return;const a=o=>{if(!r.moduleId)return!0;const A=`${r.moduleId}:${o}`;return re.user.hasButton(A)},m=[];r.menuConfig.showCopyRow!==!1&&m.push({code:"copyRow",name:"复制行数据",prefixIcon:"vxe-icon-copy",visible:!0}),r.menuConfig.showCopyCell!==!1&&m.push({code:"copyCell",name:"复制单元格",prefixIcon:"vxe-icon-copy",visible:!0});const l=(r.menuConfig.customMenus||[]).map(o=>{var ee;const A=a(o.code);return{...o,disabled:o.disabled||!A,children:(ee=o.children)==null?void 0:ee.map(C=>{const te=a(C.code);return{...C,disabled:C.disabled||!te}})}}),p=[],e=[...m];return e.length&&p.push(e),l.length&&p.push(l),{transfer:!0,body:{options:p},visibleMethod:({options:o})=>Array.isArray(o)&&o.some(A=>Array.isArray(A)&&A.length>0)}}),T=b(()=>{var m;const a=(m=r.gridOptions)==null?void 0:m.rowConfig;return{keyField:r.rowId,isHover:!0,isCurrent:(a==null?void 0:a.isCurrent)!==!1,...a}}),O=b(()=>r.showCheckbox?{checkField:"__checked",reserve:!0,highlight:!0}:void 0),j=b(()=>r.showSeq?{startIndex:0,...r.seqConfig}:void 0),Q=b(()=>{const a=r.gridOptions||{},m={resizable:!0,minWidth:120,...a.columnConfig},l={enabled:!0,gt:0,oSize:5,immediate:!0,scrollToTopOnChange:!0},p={showHeaderOverflow:a.showHeaderOverflow??!0,showOverflow:a.showOverflow??"tooltip",...a,columnConfig:m,virtualYConfig:a.virtualYConfig?{...l,...a.virtualYConfig}:l};return a.expandConfig&&(p.expandConfig=a.expandConfig),p});return{showToolbar:i,toolbarButtonsComputed:g,columnsComputed:v,menuConfigComputed:B,rowConfigComputed:T,checkboxConfigComputed:O,seqConfigComputed:j,gridPropsComputed:Q,handleToolbarClick:y,handleRefresh:k,handleFullscreen:s,handleCheckboxChange:I,handleCellClick:U,handleCellDblclick:R,handleRowClick:$,handleSortChange:d,handleFilterChange:h,handleMenuClick:w,handleEditActived:D,handleEditClosed:x,gridMethods:{getGridInstance:()=>t.value,refresh:k,getCheckboxRecords:()=>{var a;return((a=t.value)==null?void 0:a.getCheckboxRecords())||[]},getCurrentRecord:()=>{var a;return((a=t.value)==null?void 0:a.getCurrentRecord())||null},setCheckboxRow:(a,m)=>{t.value&&t.value.setCheckboxRow(a,m)},clearCheckboxRow:()=>{t.value&&t.value.clearCheckboxRow()},getTableData:()=>{var a;return((a=t.value)==null?void 0:a.getTableData().fullData)||[]},insert:async a=>{if(t.value)return await t.value.insert(a)},insertAt:async(a,m)=>{if(t.value)return await t.value.insertAt(a,m)},remove:async a=>{if(t.value)return await t.value.remove(a)},removeCheckboxRow:async()=>{if(t.value){const a=t.value.getCheckboxRecords();return await t.value.remove(a)}},getRecordset:()=>t.value?t.value.getRecordset():{insertRecords:[],removeRecords:[],updateRecords:[]},clearData:async()=>{t.value&&await t.value.clearData()},reloadData:async a=>{t.value&&await t.value.reloadData(a)},exportData:async a=>{if(t.value)return await t.value.exportData(a)},print:a=>{t.value&&t.value.print(a)},zoom:()=>{t.value&&t.value.zoom()},validate:async a=>{if(t.value){const m=await t.value.validate(a);return typeof m=="object"&&m!==null?!1:m}return Promise.resolve(!1)}}}}const ht={class:"g-grid"},vt={class:"g-grid__table-wrapper"},mt=L({name:"GGrid",__name:"GGrid",props:{moduleId:{},data:{},columns:{},loading:{type:Boolean,default:!1},toolbarConfig:{},menuConfig:{},paginationConfig:{},border:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},height:{},maxHeight:{},autoResize:{type:Boolean,default:!1},rowId:{default:"id"},showCheckbox:{type:Boolean,default:!1},showSeq:{type:Boolean,default:!0},seqConfig:{},showFooter:{type:Boolean,default:!1},footerData:{},footerMethod:{},sortConfig:{},filterConfig:{},editConfig:{},treeConfig:{},expandConfig:{},exportConfig:{},printConfig:{},gridOptions:{}},emits:["toolbar-button-click","checkbox-change","cell-click","cell-dblclick","row-click","sort-change","filter-change","refresh","menu-click","edit-actived","edit-closed","page-change"],setup(_,{expose:r,emit:c}){const t=_,y=c,k=le(),s=b(()=>ne(t.data)||[]),I=b(()=>ne(t.loading)||!1),U=b(()=>t.treeConfig?!1:t.stripe),{showToolbar:R,toolbarButtonsComputed:$,columnsComputed:d,menuConfigComputed:h,rowConfigComputed:w,checkboxConfigComputed:D,seqConfigComputed:x,gridPropsComputed:i,handleToolbarClick:g,handleCheckboxChange:v,handleCellClick:B,handleCellDblclick:T,handleRowClick:O,handleSortChange:j,handleFilterChange:Q,handleMenuClick:K,handleEditActived:a,handleEditClosed:m,gridMethods:l}=ft({props:t,emit:y,gridRef:k}),p=b(()=>{var C;return((C=t.paginationConfig)==null?void 0:C.show)===!0}),e=b(()=>{var C;return((C=t.paginationConfig)==null?void 0:C.currentPage)||1}),o=b(()=>{var C;return((C=t.paginationConfig)==null?void 0:C.pageSize)||20}),A=b(()=>{var C;return((C=t.paginationConfig)==null?void 0:C.total)||0}),ee=({currentPage:C,pageSize:te})=>{y("page-change",{currentPage:C,pageSize:te})};return r(l),(C,te)=>{var ie,de,ce,pe,ge,be,fe,he,ve,me,Ce;return u(),S("div",ht,[n(R)?(u(),f(Oe,{key:0,"module-id":C.moduleId,buttons:n($),align:((ie=C.toolbarConfig)==null?void 0:ie.align)||"right",bordered:!1,compact:!0,class:"g-grid__toolbar",onButtonClick:n(g)},null,8,["module-id","buttons","align","onButtonClick"])):F("",!0),Y("div",vt,[G(n(Je),P({ref_key:"gridRef",ref:k,class:"g-grid__table"},n(i),{data:s.value,columns:n(d),loading:I.value,"menu-config":n(h),border:C.border,stripe:U.value,height:C.height||"100%","max-height":C.maxHeight,"auto-resize":C.autoResize,"row-config":n(w),"checkbox-config":n(D),"seq-config":n(x),"sort-config":t.sortConfig||((de=t.gridOptions)==null?void 0:de.sortConfig)||{},"filter-config":t.filterConfig||((ce=t.gridOptions)==null?void 0:ce.filterConfig),"edit-config":t.editConfig||((pe=t.gridOptions)==null?void 0:pe.editConfig),"tree-config":t.treeConfig||((ge=t.gridOptions)==null?void 0:ge.treeConfig),"expand-config":t.expandConfig||((be=t.gridOptions)==null?void 0:be.expandConfig),"export-config":t.exportConfig||((fe=t.gridOptions)==null?void 0:fe.exportConfig),"print-config":t.printConfig||((he=t.gridOptions)==null?void 0:he.printConfig),"show-footer":C.showFooter,"footer-data":C.footerData,"footer-method":C.footerMethod,size:"mini",onCheckboxChange:n(v),onCheckboxAll:n(v),onCellClick:n(B),onCellDblclick:n(T),onCurrentChange:n(O),onSortChange:n(j),onFilterChange:n(Q),onEditActived:n(a),onEditClosed:n(m),onMenuClick:n(K)}),se({_:2},[N(C.$slots,(Bt,ye)=>({name:ye,fn:z(xe=>[E(C.$slots,ye,Re(De(xe||{})),void 0,!0)])}))]),1040,["data","columns","loading","menu-config","border","stripe","height","max-height","auto-resize","row-config","checkbox-config","seq-config","sort-config","filter-config","edit-config","tree-config","expand-config","export-config","print-config","show-footer","footer-data","footer-method","onCheckboxChange","onCheckboxAll","onCellClick","onCellDblclick","onCurrentChange","onSortChange","onFilterChange","onEditActived","onEditClosed","onMenuClick"])]),p.value?(u(),f(tt,{key:1,class:"g-grid__pagination","current-page":e.value,"page-size":o.value,total:A.value,"page-sizes":(ve=C.paginationConfig)==null?void 0:ve.pageSizes,align:(me=C.paginationConfig)==null?void 0:me.align,"page-info":(Ce=C.paginationConfig)==null?void 0:Ce.pageInfo,onPageChange:ee},null,8,["current-page","page-size","total","page-sizes","align","page-info"])):F("",!0)])}}}),Nt=W(mt,[["__scopeId","data-v-71ef0803"]]),Ct=L({name:"GEllipsis",__name:"GEllipsis",props:{text:{default:""}},setup(_){const r=_,c=b(()=>{const{text:t,...y}=r;return y});return(t,y)=>(u(),f(n(Qe),Re(De(c.value)),{default:z(()=>[E(t.$slots,"default",{},()=>[Z(J(t.text),1)],!0)]),_:3},16))}}),Te=W(Ct,[["__scopeId","data-v-e2749707"]]),yt={class:"g-tips__content"},kt=L({name:"GTips",__name:"GTips",props:{content:{default:""},trigger:{default:"hover"},placement:{default:"top"},showArrow:{type:Boolean,default:!0},maxWidth:{default:320},delay:{default:0},duration:{default:100},iconSize:{default:16},iconStyle:{default:()=>({})}},setup(_){return(r,c)=>(u(),f(n(Fe),{trigger:r.trigger,placement:r.placement,"show-arrow":r.showArrow,style:ue({maxWidth:`${r.maxWidth}px`}),delay:r.delay,duration:r.duration},{trigger:z(()=>[G(n(oe),{size:r.iconSize,class:M(["g-tips__icon",`g-tips__icon--${r.iconSize}`]),style:ue(r.iconStyle)},{default:z(()=>[G(n(Xe))]),_:1},8,["size","class","style"])]),default:z(()=>[Y("div",yt,[E(r.$slots,"default",{},()=>[Z(J(r.content),1)],!0)])]),_:3},8,["trigger","placement","show-arrow","style","delay","duration"]))}}),_t=W(kt,[["__scopeId","data-v-ff25cb35"]]),wt={class:"search-form"},zt=L({name:"SearchForm",__name:"SearchForm",props:{fields:{},moreFields:{},labelWidth:{default:"auto"},labelPlacement:{default:"left"},labelAlign:{default:"left"},size:{default:"small"},inline:{type:Boolean,default:!1},cols:{default:24},xGap:{default:8},yGap:{default:8},moreButtonText:{default:"更多条件"},toolbarButtons:{},showSearchButton:{type:Boolean,default:!0},showResetButton:{type:Boolean,default:!0},searchButtonText:{default:"查询"},resetButtonText:{default:"重置"},toolbarAlign:{default:"right"},showToolbar:{type:Boolean,default:!0},moduleId:{}},emits:["search","field-change","toolbar-click"],setup(_,{expose:r,emit:c}){const t=_,y=c,k=le(),s=le({}),I=le(!1),U=()=>{I.value=!I.value},R=()=>{const l={};t.fields.forEach(p=>{if(p.defaultValue!==void 0)l[p.field]=p.defaultValue;else switch(p.type){case"number":l[p.field]=null;break;case"switch":l[p.field]=!1;break;default:l[p.field]=""}}),t.moreFields&&t.moreFields.forEach(p=>{if(p.defaultValue!==void 0)l[p.field]=p.defaultValue;else switch(p.type){case"number":l[p.field]=null;break;case"switch":l[p.field]=!1;break;default:l[p.field]=""}}),s.value=l},$=b(()=>t.fields.filter(l=>l.show!==!1)),d=b(()=>t.moreFields||[]),h=b(()=>d.value.length>0),w=b(()=>Math.floor(t.cols/4)),D=l=>typeof l.label=="function"?l.label(s.value):l.label,x=l=>{const p=D(l);return l.tips?()=>X("span",{class:"search-form-label-with-tips"},[X(Te,{text:p}),X("span",{class:"search-form-label-tips"},[(()=>{if(!l.tips)return null;let e;return typeof l.tips=="function"?e=l.tips(s.value):e=l.tips,typeof e=="string"?X(_t,{content:e}):e})()])]):()=>X(Te,{text:p})},i=b(()=>{const l=[];return t.toolbarButtons&&t.toolbarButtons.length>0&&l.push(...t.toolbarButtons),t.showSearchButton&&(l.some(e=>e.key==="search")||l.push({key:"search",label:t.searchButtonText,icon:He,type:"primary",onClick:v})),t.showResetButton&&(l.some(e=>e.key==="reset")||l.push({key:"reset",label:t.resetButtonText,icon:Ge,onClick:B})),h.value&&l.push({key:"more",label:t.moreButtonText,icon:je,onClick:U}),l}),g=(l,p)=>{y("field-change",l,p)},v=async()=>{var l;try{await((l=k.value)==null?void 0:l.validate()),y("search",{...s.value})}catch(p){console.error("表单验证失败:",p)}},B=()=>{R()},T=l=>{const p=i.value.find(e=>e.key===l);p!=null&&p.onClick||y("toolbar-click",l)},O=()=>k.value,j=()=>s.value,Q=l=>{s.value={...s.value,...l}},K=B,a=async()=>{k.value&&await k.value.validate()},m=v;return Le(()=>{R()}),r({getFormRef:O,getFormData:j,setFormData:Q,resetForm:K,validate:a,submit:m,toggleMoreFields:U}),(l,p)=>(u(),S("div",wt,[l.showToolbar?(u(),f(Oe,{key:0,"module-id":l.moduleId,buttons:i.value,align:l.toolbarAlign,bordered:!1,class:"search-form__toolbar",onButtonClick:T},null,8,["module-id","buttons","align"])):F("",!0),G(n(We),{ref_key:"formRef",ref:k,model:s.value,"label-placement":l.labelPlacement,"label-align":l.labelAlign,size:l.size,inline:l.inline,class:"search-form__form"},{default:z(()=>[G(n(Ze),{cols:l.cols,"x-gap":l.xGap,"y-gap":l.yGap,class:"search-form__grid"},{default:z(()=>[(u(!0),S(V,null,N($.value,e=>(u(),f(n(Be),{key:e.field,span:e.span||w.value},{default:z(()=>[G(n(we),{path:e.field,rule:e.rules,required:e.required},{label:z(()=>[(u(),f(H(x(e))))]),default:z(()=>[e.type==="input"||!e.type?(u(),f(n(ze),P({key:0,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="select"?(u(),f(n(Se),P({key:1,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,options:e.options||[],disabled:e.disabled,clearable:e.clearable!==!1,size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","options","disabled","clearable"])):e.type==="date"?(u(),f(n(q),P({key:2,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"date",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="daterange"?(u(),f(n(q),P({key:3,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"daterange",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="datetime"?(u(),f(n(q),P({key:4,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"datetime",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="datetimerange"?(u(),f(n(q),P({key:5,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"datetimerange",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="number"?(u(),f(n(Ie),P({key:6,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="switch"?(u(),f(n(Pe),P({key:7,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,disabled:e.disabled,ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","disabled"])):e.type==="custom"&&e.render?(u(),f(H(e.render(s.value)),{key:8})):F("",!0)]),_:2},1032,["path","rule","required"])]),_:2},1032,["span"]))),128)),I.value?(u(!0),S(V,{key:0},N(d.value,e=>(u(),f(n(Be),{key:e.field,span:e.span||w.value},{default:z(()=>[G(n(we),{path:e.field,rule:e.rules,required:e.required},{label:z(()=>[(u(),f(H(x(e))))]),default:z(()=>[e.type==="input"||!e.type?(u(),f(n(ze),P({key:0,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="select"?(u(),f(n(Se),P({key:1,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,options:e.options||[],disabled:e.disabled,clearable:e.clearable!==!1,size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","options","disabled","clearable"])):e.type==="date"?(u(),f(n(q),P({key:2,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"date",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="daterange"?(u(),f(n(q),P({key:3,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"daterange",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="datetime"?(u(),f(n(q),P({key:4,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"datetime",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="datetimerange"?(u(),f(n(q),P({key:5,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请选择${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,type:"datetimerange",size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="number"?(u(),f(n(Ie),P({key:6,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,placeholder:e.placeholder||`请输入${e.label}`,disabled:e.disabled,clearable:e.clearable!==!1,size:"small",ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","placeholder","disabled","clearable"])):e.type==="switch"?(u(),f(n(Pe),P({key:7,value:s.value[e.field],"onUpdate:value":o=>s.value[e.field]=o,disabled:e.disabled,ref_for:!0},e.props,{"onUpdate:value":o=>g(e.field,o)}),null,16,["value","onUpdate:value","disabled"])):e.type==="custom"&&e.render?(u(),f(H(e.render(s.value)),{key:8})):F("",!0)]),_:2},1032,["path","rule","required"])]),_:2},1032,["span"]))),128)):F("",!0)]),_:1},8,["cols","x-gap","y-gap"])]),_:1},8,["model","label-placement","label-align","size","inline"])]))}}),At=W(zt,[["__scopeId","data-v-3c80de7f"]]);export{Nt as G,At as S,_t as a,Ue as b,Et as c,Te as d,tt as e};
