import{d as se,c as H,o as I,a as f,e as Ae,r as C,g as q,R as ue,h as pe,T as ye,q as we,w,t as ee,m as g,n as t,H as be,U as fe,I as Me,J as oe,x as Z,v as ie,V as ge,W as E,_ as De,X as Ne,Y as We,f as Ke,Z as Fe,$ as je,b as Ge,a0 as ce,a1 as le,a2 as de,a3 as ke,a4 as Je}from"./index-2fJuYE9W.js";import{N as Te}from"./DatePicker-DwaoePDV.js";import{u as Se,i as $e,a as Ce,b as ze,c as Ie,d as Le,e as Pe,f as Re,g as He,L as Qe}from"./installCanvasRenderer-BddeS-3K.js";import{_ as Xe}from"./DataTable-j6x_03X-.js";import{u as Ze}from"./usePagination-Cqr38X3-.js";import{_ as et}from"./RadioGroup-BZdw_79m.js";import"./index-C9U1NGvg.js";const tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},qe=se({name:"AndroidOutlined",render:function(x,e){return I(),H("svg",tt,e[0]||(e[0]=[f("path",{d:"M448.3 225.2c-18.6 0-32 13.4-32 31.9s13.5 31.9 32 31.9c18.6 0 32-13.4 32-31.9c.1-18.4-13.4-31.9-32-31.9zm393.9 96.4c-13.8-13.8-32.7-21.5-53.2-21.5c-3.9 0-7.4.4-10.7 1v-1h-3.6c-5.5-30.6-18.6-60.5-38.1-87.4c-18.7-25.7-43-47.9-70.8-64.9l25.1-35.8v-3.3c0-.8.4-2.3.7-3.8c.6-2.4 1.4-5.5 1.4-8.9c0-18.5-13.5-31.9-32-31.9c-9.8 0-19.5 5.7-25.9 15.4l-29.3 42.1c-30-9.8-62.4-15-93.8-15c-31.3 0-63.7 5.2-93.8 15L389 79.4c-6.6-9.6-16.1-15.4-26-15.4c-18.6 0-32 13.4-32 31.9c0 6.2 2.5 12.8 6.7 17.4l22.6 32.3c-28.7 17-53.5 39.4-72.2 65.1c-19.4 26.9-32 56.8-36.7 87.4h-5.5v1c-3.2-.6-6.7-1-10.7-1c-20.3 0-39.2 7.5-53.1 21.3c-13.8 13.8-21.5 32.6-21.5 53v235c0 20.3 7.5 39.1 21.4 52.9c13.8 13.8 32.8 21.5 53.2 21.5c3.9 0 7.4-.4 10.7-1v93.5c0 29.2 23.9 53.1 53.2 53.1H331v58.3c0 20.3 7.5 39.1 21.4 52.9c13.8 13.8 32.8 21.5 53.2 21.5c20.3 0 39.2-7.5 53.1-21.3c13.8-13.8 21.5-32.6 21.5-53v-58.2H544v58.1c0 20.3 7.5 39.1 21.4 52.9c13.8 13.8 32.8 21.5 53.2 21.5c20.4 0 39.2-7.5 53.1-21.6c13.8-13.8 21.5-32.6 21.5-53v-58.2h31.9c29.3 0 53.2-23.8 53.2-53.1v-91.4c3.2.6 6.7 1 10.7 1c20.3 0 39.2-7.5 53.1-21.3c13.8-13.8 21.5-32.6 21.5-53v-235c-.1-20.3-7.6-39-21.4-52.9zM246 609.6c0 6.8-3.9 10.6-10.7 10.6c-6.8 0-10.7-3.8-10.7-10.6V374.5c0-6.8 3.9-10.6 10.7-10.6c6.8 0 10.7 3.8 10.7 10.6v235.1zm131.1-396.8c37.5-27.3 85.3-42.3 135-42.3s97.5 15.1 135 42.5c32.4 23.7 54.2 54.2 62.7 87.5H314.4c8.5-33.4 30.5-64 62.7-87.7zm39.3 674.7c-.6 5.6-4.4 8.7-10.5 8.7c-6.8 0-10.7-3.8-10.7-10.6v-58.2h21.2v60.1zm202.3 8.7c-6.8 0-10.7-3.8-10.7-10.6v-58.2h21.2v60.1c-.6 5.6-4.3 8.7-10.5 8.7zm95.8-132.6H309.9V364h404.6v399.6zm85.2-154c0 6.8-3.9 10.6-10.7 10.6c-6.8 0-10.7-3.8-10.7-10.6V374.5c0-6.8 3.9-10.6 10.7-10.6c6.8 0 10.7 3.8 10.7 10.6v235.1zM576.1 225.2c-18.6 0-32 13.4-32 31.9s13.5 31.9 32 31.9c18.6 0 32.1-13.4 32.1-32c-.1-18.6-13.4-31.8-32.1-31.8z",fill:"currentColor"},null,-1)]))}}),at={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},rt=se({name:"AppleOutlined",render:function(x,e){return I(),H("svg",at,e[0]||(e[0]=[f("path",{d:"M747.4 535.7c-.4-68.2 30.5-119.6 92.9-157.5c-34.9-50-87.7-77.5-157.3-82.8c-65.9-5.2-138 38.4-164.4 38.4c-27.9 0-91.7-36.6-141.9-36.6C273.1 298.8 163 379.8 163 544.6c0 48.7 8.9 99 26.7 150.8c23.8 68.2 109.6 235.3 199.1 232.6c46.8-1.1 79.9-33.2 140.8-33.2c59.1 0 89.7 33.2 141.9 33.2c90.3-1.3 167.9-153.2 190.5-221.6c-121.1-57.1-114.6-167.2-114.6-170.7zm-10.6 267c-14.3 19.9-28.7 35.6-41.9 45.7c-10.5 8-18.6 11.4-24 11.6c-9-.1-17.7-2.3-34.7-8.8c-1.2-.5-2.5-1-4.2-1.6l-4.4-1.7c-17.4-6.7-27.8-10.3-41.1-13.8c-18.6-4.8-37.1-7.4-56.9-7.4c-20.2 0-39.2 2.5-58.1 7.2c-13.9 3.5-25.6 7.4-42.7 13.8c-.7.3-8.1 3.1-10.2 3.9c-3.5 1.3-6.2 2.3-8.7 3.2c-10.4 3.6-17 5.1-22.9 5.2c-.7 0-1.3-.1-1.8-.2c-1.1-.2-2.5-.6-4.1-1.3c-4.5-1.8-9.9-5.1-16-9.8c-14-10.9-29.4-28-45.1-49.9c-27.5-38.6-53.5-89.8-66-125.7c-15.4-44.8-23-87.7-23-128.6c0-60.2 17.8-106 48.4-137.1c26.3-26.6 61.7-41.5 97.8-42.3c5.9.1 14.5 1.5 25.4 4.5c8.6 2.3 18 5.4 30.7 9.9c3.8 1.4 16.9 6.1 18.5 6.7c7.7 2.8 13.5 4.8 19.2 6.6c18.2 5.8 32.3 9 47.6 9c15.5 0 28.8-3.3 47.7-9.8c7.1-2.4 32.9-12 37.5-13.6c25.6-9.1 44.5-14 60.8-15.2c4.8-.4 9.1-.4 13.2-.1c22.7 1.8 42.1 6.3 58.6 13.8c-37.6 43.4-57 96.5-56.9 158.4c-.3 14.7.9 31.7 5.1 51.8c6.4 30.5 18.6 60.7 37.9 89c14.7 21.5 32.9 40.9 54.7 57.8c-11.5 23.7-25.6 48.2-40.4 68.8zm-94.5-572c50.7-60.2 46.1-115 44.6-134.7c-44.8 2.6-96.6 30.5-126.1 64.8c-32.5 36.8-51.6 82.3-47.5 133.6c48.4 3.7 92.6-21.2 129-63.7z",fill:"currentColor"},null,-1)]))}}),st={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},nt=se({name:"CloudServerOutlined",render:function(x,e){return I(),H("svg",st,e[0]||(e[0]=[f("path",{d:"M704 446H320c-4.4 0-8 3.6-8 8v402c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8V454c0-4.4-3.6-8-8-8zm-328 64h272v117H376V510zm272 290H376V683h272v117z",fill:"currentColor"},null,-1),f("path",{d:"M424 748a32 32 0 1 0 64 0a32 32 0 1 0-64 0zm0-178a32 32 0 1 0 64 0a32 32 0 1 0-64 0z",fill:"currentColor"},null,-1),f("path",{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6C64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9c-27-3.4-52.5-15.2-72.1-34.5c-24-23.5-37.2-55.1-37.2-88.6c0-28 9.1-54.4 26.2-76.4c16.7-21.4 40.2-36.9 66.1-43.7l37.9-10l13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5c14.9-19.2 32.6-36 52.4-50c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50c15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6l37.8 10c54.2 14.4 92.1 63.7 92.1 120c0 33.6-13.2 65.1-37.2 88.6c-19.5 19.2-44.9 31.1-71.9 34.5c-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8c101.7-9.2 182.5-94 183.2-198.2c.6-93.4-62.7-172.1-148.6-194.9z",fill:"currentColor"},null,-1)]))}}),ot={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},it=se({name:"DatabaseOutlined",render:function(x,e){return I(),H("svg",ot,e[0]||(e[0]=[f("path",{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1 0 80 0a40 40 0 1 0-80 0zm0 272a40 40 0 1 0 80 0a40 40 0 1 0-80 0zm0 272a40 40 0 1 0 80 0a40 40 0 1 0-80 0z",fill:"currentColor"},null,-1)]))}}),ct={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Ve=se({name:"DesktopOutlined",render:function(x,e){return I(),H("svg",ct,e[0]||(e[0]=[f("path",{d:"M928 140H96c-17.7 0-32 14.3-32 32v496c0 17.7 14.3 32 32 32h380v112H304c-8.8 0-16 7.2-16 16v48c0 4.4 3.6 8 8 8h432c4.4 0 8-3.6 8-8v-48c0-8.8-7.2-16-16-16H548V700h380c17.7 0 32-14.3 32-32V172c0-17.7-14.3-32-32-32zm-40 488H136V212h752v416z",fill:"currentColor"},null,-1)]))}}),lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},dt=se({name:"GlobalOutlined",render:function(x,e){return I(),H("svg",lt,e[0]||(e[0]=[f("path",{d:"M854.4 800.9c.2-.3.5-.6.7-.9C920.6 722.1 960 621.7 960 512s-39.4-210.1-104.8-288c-.2-.3-.5-.5-.7-.8c-1.1-1.3-2.1-2.5-3.2-3.7c-.4-.5-.8-.9-1.2-1.4l-4.1-4.7l-.1-.1c-1.5-1.7-3.1-3.4-4.6-5.1l-.1-.1c-3.2-3.4-6.4-6.8-9.7-10.1l-.1-.1l-4.8-4.8l-.3-.3c-1.5-1.5-3-2.9-4.5-4.3c-.5-.5-1-1-1.6-1.5c-1-1-2-1.9-3-2.8c-.3-.3-.7-.6-1-1C736.4 109.2 629.5 64 512 64s-224.4 45.2-304.3 119.2c-.3.3-.7.6-1 1c-1 .9-2 1.9-3 2.9c-.5.5-1 1-1.6 1.5c-1.5 1.4-3 2.9-4.5 4.3l-.3.3l-4.8 4.8l-.1.1c-3.3 3.3-6.5 6.7-9.7 10.1l-.1.1c-1.6 1.7-3.1 3.4-4.6 5.1l-.1.1c-1.4 1.5-2.8 3.1-4.1 4.7c-.4.5-.8.9-1.2 1.4c-1.1 1.2-2.1 2.5-3.2 3.7c-.2.3-.5.5-.7.8C103.4 301.9 64 402.3 64 512s39.4 210.1 104.8 288c.2.3.5.6.7.9l3.1 3.7c.4.5.8.9 1.2 1.4l4.1 4.7c0 .1.1.1.1.2c1.5 1.7 3 3.4 4.6 5l.1.1c3.2 3.4 6.4 6.8 9.6 10.1l.1.1c1.6 1.6 3.1 3.2 4.7 4.7l.3.3c3.3 3.3 6.7 6.5 10.1 9.6c80.1 74 187 119.2 304.5 119.2s224.4-45.2 304.3-119.2a300 300 0 0 0 10-9.6l.3-.3c1.6-1.6 3.2-3.1 4.7-4.7l.1-.1c3.3-3.3 6.5-6.7 9.6-10.1l.1-.1c1.5-1.7 3.1-3.3 4.6-5c0-.1.1-.1.1-.2c1.4-1.5 2.8-3.1 4.1-4.7c.4-.5.8-.9 1.2-1.4a99 99 0 0 0 3.3-3.7zm4.1-142.6c-13.8 32.6-32 62.8-54.2 90.2a444.07 444.07 0 0 0-81.5-55.9c11.6-46.9 18.8-98.4 20.7-152.6H887c-3 40.9-12.6 80.6-28.5 118.3zM887 484H743.5c-1.9-54.2-9.1-105.7-20.7-152.6c29.3-15.6 56.6-34.4 81.5-55.9A373.86 373.86 0 0 1 887 484zM658.3 165.5c39.7 16.8 75.8 40 107.6 69.2a394.72 394.72 0 0 1-59.4 41.8c-15.7-45-35.8-84.1-59.2-115.4c3.7 1.4 7.4 2.9 11 4.4zm-90.6 700.6c-9.2 7.2-18.4 12.7-27.7 16.4V697a389.1 389.1 0 0 1 115.7 26.2c-8.3 24.6-17.9 47.3-29 67.8c-17.4 32.4-37.8 58.3-59 75.1zm59-633.1c11 20.6 20.7 43.3 29 67.8A389.1 389.1 0 0 1 540 327V141.6c9.2 3.7 18.5 9.1 27.7 16.4c21.2 16.7 41.6 42.6 59 75zM540 640.9V540h147.5c-1.6 44.2-7.1 87.1-16.3 127.8l-.3 1.2A445.02 445.02 0 0 0 540 640.9zm0-156.9V383.1c45.8-2.8 89.8-12.5 130.9-28.1l.3 1.2c9.2 40.7 14.7 83.5 16.3 127.8H540zm-56 56v100.9c-45.8 2.8-89.8 12.5-130.9 28.1l-.3-1.2c-9.2-40.7-14.7-83.5-16.3-127.8H484zm-147.5-56c1.6-44.2 7.1-87.1 16.3-127.8l.3-1.2c41.1 15.6 85 25.3 130.9 28.1V484H336.5zM484 697v185.4c-9.2-3.7-18.5-9.1-27.7-16.4c-21.2-16.7-41.7-42.7-59.1-75.1c-11-20.6-20.7-43.3-29-67.8c37.2-14.6 75.9-23.3 115.8-26.1zm0-370a389.1 389.1 0 0 1-115.7-26.2c8.3-24.6 17.9-47.3 29-67.8c17.4-32.4 37.8-58.4 59.1-75.1c9.2-7.2 18.4-12.7 27.7-16.4V327zM365.7 165.5c3.7-1.5 7.3-3 11-4.4c-23.4 31.3-43.5 70.4-59.2 115.4c-21-12-40.9-26-59.4-41.8c31.8-29.2 67.9-52.4 107.6-69.2zM165.5 365.7c13.8-32.6 32-62.8 54.2-90.2c24.9 21.5 52.2 40.3 81.5 55.9c-11.6 46.9-18.8 98.4-20.7 152.6H137c3-40.9 12.6-80.6 28.5-118.3zM137 540h143.5c1.9 54.2 9.1 105.7 20.7 152.6a444.07 444.07 0 0 0-81.5 55.9A373.86 373.86 0 0 1 137 540zm228.7 318.5c-39.7-16.8-75.8-40-107.6-69.2c18.5-15.8 38.4-29.7 59.4-41.8c15.7 45 35.8 84.1 59.2 115.4c-3.7-1.4-7.4-2.9-11-4.4zm292.6 0c-3.7 1.5-7.3 3-11 4.4c23.4-31.3 43.5-70.4 59.2-115.4c21 12 40.9 26 59.4 41.8a373.81 373.81 0 0 1-107.6 69.2z",fill:"currentColor"},null,-1)]))}}),ut={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},_e=se({name:"ReloadOutlined",render:function(x,e){return I(),H("svg",ut,e[0]||(e[0]=[f("path",{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92C290 92 102.3 279.5 102 511.5C101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1c1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 0 0-10.1 4.8c-1.8 5-3.8 10-5.9 14.9c-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 0 1 655.9 829c-42.3 17.9-87.4 27-133.8 27c-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 0 1 279 755.2a342.16 342.16 0 0 1-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4c31.6-31.6 68.4-56.4 109.3-73.8c42.3-17.9 87.4-27 133.8-27c46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 0 1 109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 0 0 3 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z",fill:"currentColor"},null,-1)]))}}),mt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},ht=se({name:"WindowsOutlined",render:function(x,e){return I(),H("svg",mt,e[0]||(e[0]=[f("path",{d:"M120.1 770.6L443 823.2V543.8H120.1v226.8zm63.4-163.5h196.2v141.6l-196.2-31.9V607.1zm340.3 226.5l382 62.2v-352h-382v289.8zm63.4-226.5h255.3v214.4l-255.3-41.6V607.1zm-63.4-415.7v288.8h382V128.1l-382 63.3zm318.7 225.5H587.3V245l255.3-42.3v214.2zm-722.4 63.3H443V201.9l-322.9 53.5v224.8zM183.5 309l196.2-32.5v140.4H183.5V309z",fill:"currentColor"},null,-1)]))}}),ft={class:"card-extra"},gt={class:"chart-container"},vt={key:0,class:"chart-loading"},pt={key:1,class:"chart-empty"},yt=se({__name:"CpuMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},cpuDetailData:{type:Array,default:()=>[]},userColor:{type:String,default:"#1890ff"},systemColor:{type:String,default:"#52c41a"},idleColor:{type:String,default:"#d9d9d9"}},emits:["refresh","time-range-change"],setup(a,{emit:x}){Se([Ce,ze,Ie,Le,Pe,Re,He]);const{t:e}=Ae("hub0000"),M=C(null);let u=null;const _=a,k=x,S=Date.now(),U=S-3600*1e3,z=C([U,S]),O=q(()=>({[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const r=Date.now();return[r-3600*1e3,r]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const r=Date.now();return[r-6*3600*1e3,r]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const r=Date.now();return[r-12*3600*1e3,r]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const r=Date.now();return[r-24*3600*1e3,r]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const r=Date.now();return[r-7*24*3600*1e3,r]}})),G=()=>{M.value&&(u=$e(M.value),window.addEventListener("resize",Y),N())},N=()=>{if(!u)return;if(!_.data||!Array.isArray(_.data)||_.data.length===0){u.setOption({title:{show:!1}});return}const r=_.data.map(d=>d.collectTime).sort(),o=new Map;_.data.forEach(d=>{o.set(d.collectTime,d)});const s=[{name:e("hub0000.cpu.usage"),type:"line",data:r.map(d=>{const n=o.get(d);return{value:n?n.usagePercent:0,detail:n}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:_.userColor}},{name:e("hub0000.cpu.userUsage"),type:"line",data:r.map(d=>{const n=o.get(d);return{value:n?n.userPercent:0,detail:n}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:_.systemColor}},{name:e("hub0000.cpu.systemUsage"),type:"line",data:r.map(d=>{const n=o.get(d);return{value:n?n.systemPercent:0,detail:n}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:_.idleColor}}],i={tooltip:{trigger:"axis",formatter:d=>{const n=d[0].data.detail;let v="";return n&&(v+=`${e("hub0000.cpu.detailTitle")}:<br/>`,v+=`${e("hub0000.cpu.serverId")}: ${n.metricServerId}<br/>`,v+=`${e("hub0000.cpu.coreCount")}: ${n.coreCount}<br/>`,v+=`${e("hub0000.cpu.logicalCount")}: ${n.logicalCount}<br/>`,v+=`${e("hub0000.cpu.loadAvg1")}: ${n.loadAvg1.toFixed(2)}<br/>`,v+=`${e("hub0000.cpu.loadAvg5")}: ${n.loadAvg5.toFixed(2)}<br/>`,v+=`${e("hub0000.cpu.loadAvg15")}: ${n.loadAvg15.toFixed(2)}<br/>`,v+=`${e("hub0000.cpu.ioWaitUsage")}: ${n.ioWaitPercent.toFixed(2)}%<br/>`,v+=`${e("hub0000.cpu.irqUsage")}: ${n.irqPercent.toFixed(2)}%<br/>`,v+=`${e("hub0000.cpu.softIrqUsage")}: ${n.softIrqPercent.toFixed(2)}%<br/>`,v+="<br/>"),d.forEach(p=>{const D=p.marker,l=p.seriesName,y=`${p.value.toFixed(2)}%`;v+=`${D} ${l}: ${y}<br/>`}),v},axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:[e("hub0000.cpu.usage"),e("hub0000.cpu.userUsage"),e("hub0000.cpu.systemUsage")],type:"scroll",bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:r.map(d=>E(d,"HH:mm:ss")),axisLabel:{interval:Math.floor(r.length/10)}},yAxis:{type:"value",axisLabel:{formatter:d=>d.toFixed(2)+"%"},max:100,min:0},series:s};u.setOption(i,!0)},Y=()=>{u==null||u.resize()},te=()=>{k("refresh")},m=r=>{k("time-range-change",r)};return ue(()=>_.data,()=>{N()},{deep:!0}),pe(()=>{G(),k("time-range-change",z.value)}),ye(()=>{u&&(u.dispose(),u=null),window.removeEventListener("resize",Y)}),(r,o)=>(I(),we(t(ge),{title:t(e)("hub0000.cpu.title"),bordered:!1,class:"monitor-card"},{"header-extra":w(()=>[f("div",ft,[g(t(Te),{value:z.value,"onUpdate:value":[o[0]||(o[0]=s=>z.value=s),m],type:"datetimerange",shortcuts:O.value,placeholder:t(e)("hub0000.common.selectTimeRange"),size:"small"},null,8,["value","shortcuts","placeholder"]),g(t(Me),{size:"small",onClick:te,loading:a.loading},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[oe(" "+Z(t(e)("hub0000.common.refresh")),1)]),_:1},8,["loading"])])]),default:w(()=>[f("div",gt,[f("div",{ref_key:"chartRef",ref:M,class:"chart-element"},null,512),a.loading?(I(),H("div",vt,[g(t(be),{size:"large"})])):ee("",!0),!a.loading&&(!a.data||!Array.isArray(a.data)||a.data.length===0)?(I(),H("div",pt,[g(t(fe),{description:t(e)("hub0000.common.noData")},null,8,["description"])])):ee("",!0)])]),_:1},8,["title"]))}}),wt=De(yt,[["__scopeId","data-v-1a9fce1b"]]),bt={class:"card-extra"},Mt={class:"chart-container"},Dt={key:0,class:"chart-loading"},_t={key:1,class:"chart-empty"},kt=se({__name:"MemoryMonitor",props:{title:{type:String,default:"内存使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},memoryDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(a,{emit:x}){Se([Ce,ze,Ie,Le,Pe,Re,He]);const{t:e}=Ae("hub0000"),M=a,u=q(()=>M.title||e("hub0000.memory.title")),_=q(()=>M.warningThreshold),k=q(()=>M.dangerThreshold),S=x,U=C(null);let z=null;const O=Date.now(),G=O-3600*1e3,N=C([G,O]),Y=q(()=>({[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const n=Date.now();return[n-3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const n=Date.now();return[n-6*3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const n=Date.now();return[n-12*3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const n=Date.now();return[n-24*3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const n=Date.now();return[n-7*24*3600*1e3,n]}})),te=q(()=>{if(!M.data||M.data.length===0)return[];const n=new Map;return M.data.forEach(p=>{const D=p.collectTime;n.has(D)||n.set(D,[]),n.get(D).push(p.usagePercent)}),Array.from(n.entries()).map(([p,D])=>{const l=M.data.find(y=>y.collectTime===p);return{time:p,value:Math.round(D.reduce((y,$)=>y+$,0)/D.length*100)/100,detail:l?{totalMemory:l.totalMemory,usedMemory:l.usedMemory,availableMemory:l.availableMemory,freeMemory:l.freeMemory,cachedMemory:l.cachedMemory,buffersMemory:l.buffersMemory,swapTotal:l.swapTotal,swapUsed:l.swapUsed,swapFree:l.swapFree,swapUsagePercent:l.swapUsagePercent}:null}}).sort((p,D)=>new Date(p.time).getTime()-new Date(D.time).getTime())}),m=n=>{if(n===0)return"0 B";const v=["B","KB","MB","GB","TB","PB"],p=Math.floor(Math.log(n)/Math.log(1024));return`${(n/Math.pow(1024,p)).toFixed(2)} ${v[p]}`},r=()=>{S("refresh")},o=n=>{S("time-range-change",n)},s=()=>{U.value&&(z=$e(U.value),window.addEventListener("resize",d),i())},i=()=>{if(!z)return;const n=te.value;if(n.length===0){z.setOption({title:{show:!1}});return}const v={title:{show:!1},tooltip:{trigger:"axis",formatter:function(p){const D=p[0],l=D.data.detail;if(!l)return`${D.marker}${D.seriesName}: ${D.data.value}%`;let y="";return y+=`${D.marker}${e("hub0000.memory.usage")}: <b>${D.data.value}%</b><br/>`,y+=`<br/>${e("hub0000.memory.details")}:<br/>`,y+=`${e("hub0000.memory.total")}: ${m(l.totalMemory)}<br/>`,y+=`${e("hub0000.memory.used")}: ${m(l.usedMemory)}<br/>`,y+=`${e("hub0000.memory.available")}: ${m(l.availableMemory)}<br/>`,y+=`${e("hub0000.memory.free")}: ${m(l.freeMemory)}<br/>`,y+=`${e("hub0000.memory.cached")}: ${m(l.cachedMemory)}<br/>`,y+=`${e("hub0000.memory.buffers")}: ${m(l.buffersMemory)}<br/>`,y+=`<br/>${e("hub0000.memory.swap")}:<br/>`,y+=`${e("hub0000.memory.swapTotal")}: ${m(l.swapTotal)}<br/>`,y+=`${e("hub0000.memory.swapUsed")}: ${m(l.swapUsed)}<br/>`,y+=`${e("hub0000.memory.swapFree")}: ${m(l.swapFree)}<br/>`,y+=`${e("hub0000.memory.swapUsage")}: ${l.swapUsagePercent.toFixed(1)}%`,y}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:n.map(p=>E(new Date(p.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:e("hub0000.memory.usage"),type:"line",data:n.map(p=>({value:p.value,detail:p.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#52c41a"},itemStyle:{color:function(p){const D=p.data.value;return D>=k.value?"#ff4d4f":D>=_.value?"#faad14":"#52c41a"}},areaStyle:{color:new Qe(0,0,0,1,[{offset:0,color:"rgba(82, 196, 26, 0.3)"},{offset:1,color:"rgba(82, 196, 26, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:_.value,label:{formatter:`${e("hub0000.memory.warning")} ${_.value}%`,position:"start"}},{yAxis:k.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`${e("hub0000.memory.danger")} ${k.value}%`,position:"start"}}]}}]};z.setOption(v)},d=()=>{z==null||z.resize()};return ue(()=>M.data,()=>{i()},{deep:!0}),pe(()=>{s(),S("time-range-change",N.value)}),ye(()=>{z&&(z.dispose(),z=null),window.removeEventListener("resize",d)}),(n,v)=>(I(),we(t(ge),{title:u.value,bordered:!1,class:"monitor-card"},{"header-extra":w(()=>[f("div",bt,[g(t(Te),{value:N.value,"onUpdate:value":[v[0]||(v[0]=p=>N.value=p),o],type:"datetimerange",shortcuts:Y.value,placeholder:t(e)("common.selectTimeRange"),size:"small"},null,8,["value","shortcuts","placeholder"]),g(t(Me),{size:"small",onClick:r,loading:a.loading},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[oe(" "+Z(t(e)("common.refresh")),1)]),_:1},8,["loading"])])]),default:w(()=>[f("div",Mt,[f("div",{ref_key:"chartRef",ref:U,class:"chart-element"},null,512),a.loading?(I(),H("div",Dt,[g(t(be),{size:"large"})])):ee("",!0),!a.loading&&!te.value.length?(I(),H("div",_t,[g(t(fe),{description:t(e)("common.noData")},null,8,["description"])])):ee("",!0)])]),_:1},8,["title"]))}}),xt=De(kt,[["__scopeId","data-v-962f57a3"]]),Tt={class:"card-extra"},St={class:"chart-container"},$t={key:0,class:"chart-loading"},Ct={key:1,class:"chart-empty"},zt=se({__name:"DiskMonitor",props:{title:{type:String,default:"磁盘使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},diskDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(a,{emit:x}){Se([Ce,ze,Ie,Le,Pe,Re,He]);const{t:e}=Ae("hub0000"),M=a,u=q(()=>M.title||e("hub0000.disk.title")),_=x,k=C(null);let S=null;const U=Date.now(),z=U-3600*1e3,O=C([z,U]),G=q(()=>({[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const i=Date.now();return[i-3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const i=Date.now();return[i-6*3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const i=Date.now();return[i-12*3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const i=Date.now();return[i-24*3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const i=Date.now();return[i-7*24*3600*1e3,i]}})),N=q(()=>{if(!M.data||M.data.length===0)return[];const i=new Map;return M.data.forEach(d=>{const n=d.collectTime;i.has(n)||i.set(n,{values:[],partitions:[]});const v=i.get(n);v.values.push(d.usagePercent),v.partitions.push(d)}),Array.from(i.entries()).map(([d,n])=>({time:d,value:Math.round(n.values.reduce((v,p)=>v+p,0)/n.values.length*100)/100,detail:{partitions:n.partitions,partitionCount:n.partitions.length,totalSpace:n.partitions.reduce((v,p)=>v+p.totalSpace,0),usedSpace:n.partitions.reduce((v,p)=>v+p.usedSpace,0),freeSpace:n.partitions.reduce((v,p)=>v+p.freeSpace,0),avgUsagePercent:Math.round(n.values.reduce((v,p)=>v+p,0)/n.values.length*100)/100}}))}),Y=i=>{if(i===0)return"0 B";const d=["B","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(i)/Math.log(1024));return`${(i/Math.pow(1024,n)).toFixed(2)} ${d[n]}`},te=()=>{_("refresh")},m=i=>{_("time-range-change",i)},r=()=>{k.value&&(S=$e(k.value),window.addEventListener("resize",s),o())},o=()=>{if(!S)return;const i=N.value;if(i.length===0){S.setOption({title:{show:!1}});return}const d=q(()=>M.warningThreshold??80),n=q(()=>M.dangerThreshold??90),v={title:{show:!1},tooltip:{trigger:"axis",formatter:function(p){const D=p[0],l=D.data.detail;let y="";return y+=`${D.marker}${e("hub0000.disk.usage")}: <b>${D.data.value}%</b><br/>`,y+=`<br/>${e("hub0000.disk.details")}:<br/>`,y+=`${e("hub0000.disk.partitionCount")}: ${l.partitionCount}<br/>`,y+=`${e("hub0000.disk.totalSpace")}: ${Y(l.totalSpace)}<br/>`,y+=`${e("hub0000.disk.usedSpace")}: ${Y(l.usedSpace)}<br/>`,y+=`${e("hub0000.disk.freeSpace")}: ${Y(l.freeSpace)}<br/>`,l.partitions.length>0&&(y+=`<br/>${e("hub0000.disk.partitionDetails")}:<br/>`,l.partitions.slice(0,3).forEach(L=>{y+=`${L.mountPoint}: ${L.usagePercent.toFixed(1)}% (${Y(L.usedSpace)}/${Y(L.totalSpace)})<br/>`}),l.partitions.length>3&&(y+=`... ${e("hub0000.disk.morePartitions",{count:l.partitions.length-3})}`)),y}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:i.map(p=>E(new Date(p.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:e("hub0000.disk.usage"),type:"line",data:i.map(p=>({value:p.value,detail:p.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#faad14"},itemStyle:{color:function(p){const D=p.data.value;return D>=n.value?"#ff4d4f":(D>=d.value,"#faad14")}},areaStyle:{color:new Qe(0,0,0,1,[{offset:0,color:"rgba(250, 173, 20, 0.3)"},{offset:1,color:"rgba(250, 173, 20, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:d.value,label:{formatter:`${e("hub0000.disk.warning")} ${d.value}%`,position:"start"}},{yAxis:n.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`${e("hub0000.disk.danger")} ${n.value}%`,position:"start"}}]}}]};S.setOption(v)},s=()=>{S==null||S.resize()};return ue(()=>M.data,()=>{o()},{deep:!0}),pe(()=>{r(),_("time-range-change",O.value)}),ye(()=>{S&&(S.dispose(),S=null),window.removeEventListener("resize",s)}),(i,d)=>(I(),we(t(ge),{title:u.value,bordered:!1,class:"monitor-card"},{"header-extra":w(()=>[f("div",Tt,[g(t(Te),{value:O.value,"onUpdate:value":[d[0]||(d[0]=n=>O.value=n),m],type:"datetimerange",shortcuts:G.value,placeholder:t(e)("hub0000.common.selectTimeRange"),size:"small"},null,8,["value","shortcuts","placeholder"]),g(t(Me),{size:"small",onClick:te,loading:a.loading},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[oe(" "+Z(t(e)("hub0000.common.refresh")),1)]),_:1},8,["loading"])])]),default:w(()=>[f("div",St,[f("div",{ref_key:"chartRef",ref:k,class:"chart-element"},null,512),a.loading?(I(),H("div",$t,[g(t(be),{size:"large"})])):ee("",!0),!a.loading&&!N.value.length?(I(),H("div",Ct,[g(t(fe),{description:t(e)("hub0000.common.noData")},null,8,["description"])])):ee("",!0)])]),_:1},8,["title"]))}}),It=De(zt,[["__scopeId","data-v-60e9d7dd"]]),Lt={class:"card-extra"},Pt={class:"chart-container"},Rt={key:0,class:"chart-loading"},Ht={key:1,class:"chart-empty"},At={key:0,class:"detail-section"},Ot=se({__name:"DiskIOMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},diskIODetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(a,{emit:x}){Se([Ce,ze,Ie,Le,Pe,Re,He]);const{t:e}=Ae("hub0000"),M=C(null);let u=null;const _=a,k=x,S=Date.now(),U=S-3600*1e3,z=C([U,S]),O={[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const i=Date.now();return[i-3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const i=Date.now();return[i-6*3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const i=Date.now();return[i-12*3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const i=Date.now();return[i-24*3600*1e3,i]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const i=Date.now();return[i-7*24*3600*1e3,i]}},G={pageSize:5,page:1},N=q(()=>[{title:e("hub0000.diskIO.deviceName"),key:"deviceName"},{title:e("hub0000.diskIO.readBytesRate"),key:"readRate",render:i=>Ne(i.readRate)+"/s"},{title:e("hub0000.diskIO.writeBytesRate"),key:"writeRate",render:i=>Ne(i.writeRate)+"/s"},{title:e("hub0000.diskIO.readCount"),key:"readCount"},{title:e("hub0000.diskIO.writeCount"),key:"writeCount"},{title:e("hub0000.diskIO.collectTime"),key:"collectTime",render:i=>E(i.collectTime)}]),Y=q(()=>{if(!_.diskIODetailData)return[];const i=new Map;return _.diskIODetailData.forEach(d=>{const n=i.get(d.deviceName);(!n||new Date(d.collectTime)>new Date(n.collectTime))&&i.set(d.deviceName,d)}),Array.from(i.values())}),te=()=>{M.value&&(u=$e(M.value),window.addEventListener("resize",r),m())},m=()=>{if(!u)return;if(!_.data||!Array.isArray(_.data)||_.data.length===0){u.setOption({title:{show:!1}});return}const i=new Map;_.data.forEach(l=>{var y;i.has(l.collectTime)||i.set(l.collectTime,new Map),(y=i.get(l.collectTime))==null||y.set(l.deviceName,l)});const d=Array.from(i.keys()).sort(),n=new Set;_.data.forEach(l=>n.add(l.deviceName));const v=[{read:"#1890ff",write:"#36cfc9"},{read:"#722ed1",write:"#eb2f96"},{read:"#fa8c16",write:"#faad14"},{read:"#52c41a",write:"#a0d911"},{read:"#f5222d",write:"#ff7a45"}],p=[];Array.from(n).forEach((l,y)=>{const $=y%v.length,L=v[$],J=[],Q=[];d.forEach(V=>{var ae;const B=(ae=i.get(V))==null?void 0:ae.get(l);J.push(B?B.readRate:0),Q.push(B?B.writeRate:0)}),p.push({name:`${l} ${e("hub0000.diskIO.read")}`,type:"line",data:J,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:L.read}}),p.push({name:`${l} ${e("hub0000.diskIO.write")}`,type:"line",data:Q,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:L.write}})});const D={title:{show:!1},tooltip:{trigger:"axis",formatter:l=>{const y=Array.isArray(l)?l[0]:l,$=d[y.dataIndex];let L=E($,"YYYY-MM-DD HH:mm:ss")+"<br/>";const J=new Map;return l.forEach(Q=>{var ae;const B=Q.seriesName.split(" ")[0];J.has(B)||J.set(B,[]),(ae=J.get(B))==null||ae.push(Q)}),J.forEach((Q,V)=>{L+=`<div style="margin-top: 3px;"><b>${V}</b></div>`,Q.forEach(B=>{const ae=B.color,W=B.seriesName.includes(e("hub0000.diskIO.read")),K=e(W?"hub0000.diskIO.read":"hub0000.diskIO.write"),h=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${ae};border:1px solid ${ae}"></span>`;L+=`<div style="padding-left: 12px;line-height:18px">${h}${K}: ${Ne(Number(B.value))}/s</div>`})}),L}},legend:{type:"scroll",bottom:0,padding:[10,20],selected:p.reduce((l,y)=>(l[y.name]=!0,l),{}),formatter:l=>{const y=l.split(" ")[0],$=l.includes(e("hub0000.diskIO.read"))?e("hub0000.diskIO.read"):e("hub0000.diskIO.write");return`${y} ${$}`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:d.map(l=>E(l,"HH:mm:ss")),axisLabel:{interval:Math.floor(d.length/10)}},yAxis:{type:"value",axisLabel:{formatter:l=>Ne(l)+"/s"}},series:p};u.setOption(D,!0)},r=()=>{u==null||u.resize()},o=()=>{k("refresh")},s=i=>{k("time-range-change",i)};return ue(()=>_.data,()=>{m()},{deep:!0}),pe(()=>{te(),k("time-range-change",z.value)}),ye(()=>{u&&(u.dispose(),u=null),window.removeEventListener("resize",r)}),(i,d)=>(I(),we(t(ge),{title:t(e)("hub0000.diskIO.title"),bordered:!1,class:"monitor-card"},{"header-extra":w(()=>[f("div",Lt,[g(t(Te),{value:z.value,"onUpdate:value":[d[0]||(d[0]=n=>z.value=n),s],type:"datetimerange",shortcuts:O,placeholder:t(e)("common.selectTimeRange"),size:"small"},null,8,["value","placeholder"]),g(t(Me),{size:"small",onClick:o,loading:a.loading},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[oe(" "+Z(t(e)("common.refresh")),1)]),_:1},8,["loading"])])]),default:w(()=>[f("div",Pt,[f("div",{ref_key:"chartRef",ref:M,class:"chart-element"},null,512),a.loading?(I(),H("div",Rt,[g(t(be),{size:"large"})])):ee("",!0),!a.loading&&(!a.data||!Array.isArray(a.data)||a.data.length===0)?(I(),H("div",Ht,[g(t(fe),{description:t(e)("common.noData")},null,8,["description"])])):ee("",!0)]),a.diskIODetailData&&a.diskIODetailData.length>0?(I(),H("div",At,[g(t(We),null,{default:w(()=>[oe(Z(t(e)("hub0000.diskIO.detailTitle")),1)]),_:1}),g(t(Xe),{columns:N.value,data:Y.value,pagination:G,bordered:!1,size:"small"},null,8,["columns","data"])])):ee("",!0)]),_:1},8,["title"]))}}),Nt=De(Ot,[["__scopeId","data-v-b62c81d8"]]),Yt={class:"card-extra"},Et={class:"chart-container"},Ut={key:0,class:"chart-loading"},Bt={key:1,class:"chart-empty"},qt=se({__name:"NetworkMonitor",props:{title:{},data:{},loading:{type:Boolean},uploadColor:{},downloadColor:{}},emits:["refresh","time-range-change"],setup(a,{emit:x}){Se([Ce,ze,Ie,Le,Pe,Re,He]);const e=a,M={title:"网络流量"},u=x,_=C(null);let k=null;const S=Date.now(),U=S-3600*1e3,z=C([U,S]),O={最近1小时:()=>{const s=Date.now();return[s-3600*1e3,s]},最近6小时:()=>{const s=Date.now();return[s-6*3600*1e3,s]},最近12小时:()=>{const s=Date.now();return[s-12*3600*1e3,s]},最近24小时:()=>{const s=Date.now();return[s-24*3600*1e3,s]},最近7天:()=>{const s=Date.now();return[s-7*24*3600*1e3,s]}},G=q(()=>{if(!e.data||e.data.length===0)return[];const s=new Map;return e.data.forEach(i=>{const d=i.collectTime;s.has(d)||s.set(d,{interfaces:[]}),s.get(d).interfaces.push(i)}),Array.from(s.entries()).sort((i,d)=>new Date(i[0]).getTime()-new Date(d[0]).getTime()).map(([i,d])=>({time:i,detail:{interfaces:d.interfaces,interfaceCount:d.interfaces.length}}))}),N=s=>s===0?"0 B/s":s<1024?`${s.toFixed(2)} B/s`:s<1024*1024?`${(s/1024).toFixed(2)} KB/s`:s<1024*1024*1024?`${(s/(1024*1024)).toFixed(2)} MB/s`:`${(s/(1024*1024*1024)).toFixed(2)} GB/s`,Y=()=>{u("refresh")},te=s=>{u("time-range-change",s)},m=()=>{_.value&&(k=$e(_.value),window.addEventListener("resize",o),r())},r=()=>{if(!k)return;const s=G.value;if(s.length===0){k.setOption({title:{show:!1}});return}const i=s.map($=>E(new Date($.time),"HH:mm:ss")),d=new Set,n=[],v=[];s.forEach($=>{$.detail.interfaces.forEach(L=>{d.has(L.interfaceName)||(L.ipAddresses&&L.ipAddresses.includes(".")&&!L.ipAddresses.includes(":")||L.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?n.push(L.interfaceName):v.push(L.interfaceName),d.add(L.interfaceName))})});const p=[...n,...v],D=[{send:"#fa541c",receive:"#73d13d"},{send:"#722ed1",receive:"#13c2c2"},{send:"#f5222d",receive:"#52c41a"},{send:"#fa8c16",receive:"#1890ff"},{send:"#eb2f96",receive:"#fadb14"}],l=[];p.forEach(($,L)=>{const J=L%D.length,Q=D[J],V=s.map(W=>{const K=W.detail.interfaces.find(h=>h.interfaceName===$);return K?Math.round(K.sendRate/(1024*1024)*100)/100:0}),B=s.map(W=>{const K=W.detail.interfaces.find(h=>h.interfaceName===$);return K?Math.round(K.receiveRate/(1024*1024)*100)/100:0}),ae=n.includes($)?2:1;l.push({name:`${$} 上传`,type:"line",data:V,smooth:!0,showSymbol:!1,lineStyle:{width:ae,type:"solid"},itemStyle:{color:Q.send},emphasis:{focus:"series"},tooltip:{valueFormatter:W=>`${W} MB/s`}}),l.push({name:`${$} 下载`,type:"line",data:B,smooth:!0,showSymbol:!1,lineStyle:{width:ae,type:"dashed"},itemStyle:{color:Q.receive},emphasis:{focus:"series"},tooltip:{valueFormatter:W=>`${W} MB/s`}})});const y={title:{show:!1},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function($){var ae;const L=$[0].axisValue,J=i.indexOf(L),Q=(ae=s[J])==null?void 0:ae.detail;let V=`${L}<br/>`;const B=new Map;if($.forEach(W=>{const h=W.seriesName.split(" ")[0];B.has(h)||B.set(h,[]),B.get(h).push(W)}),Q){const W=new Set;B.forEach((R,F)=>{W.add(F)}),Q.interfaces.forEach(R=>{W.add(R.interfaceName)}),V+=`接口总数: ${Q.interfaceCount}<br/>`;const K=[],h=[];Array.from(W).forEach(R=>{const F=Q.interfaces.find(Oe=>Oe.interfaceName===R);if(!F)return;F.ipAddresses&&F.ipAddresses.includes(".")&&!F.ipAddresses.includes(":")||F.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?K.push(R):h.push(R)});const b=[...K,...h];b.length>0&&(V+="<br/>接口详情:<br/>",b.forEach(R=>{const F=Q.interfaces.find(Oe=>Oe.interfaceName===R);if(!F)return;V+='<div style="padding:3px 0;border-bottom:1px solid #eee;">',V+=`<b>${R}</b>: `,K.includes(R)&&(V+='<span style="color:#1890ff;">[IPv4]</span> '),V+=`<br/><span style="padding-left:10px;color:#ff4d4f;">↑${N(F.sendRate)}</span> `,V+=`<span style="padding-left:5px;color:#52c41a;">↓${N(F.receiveRate)}</span>`,(F.errorsReceived>0||F.errorsSent>0)&&(V+=` <span style="color:#ff7875;">(错误: ${F.errorsReceived+F.errorsSent})</span>`),F.ipAddresses&&(V+=`<br/><span style="padding-left:10px;color:#999;font-size:12px;">IP: ${F.ipAddresses}</span>`),V+="</div>"}))}return V}},legend:{type:"scroll",data:l.map($=>$.name),bottom:0,padding:[5,10],selected:l.reduce(($,L)=>{const J=L.name.split(" ")[0];return $[L.name]=n.includes(J),$},{})},grid:{left:"3%",right:"4%",bottom:"40px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:i,axisLabel:{rotate:45}},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:$=>$.toFixed(2)+" MB/s"}},series:l};k.setOption(y)},o=()=>{k==null||k.resize()};return ue(()=>e.data,()=>{r()},{deep:!0}),pe(()=>{m(),u("time-range-change",z.value)}),ye(()=>{k&&(k.dispose(),k=null),window.removeEventListener("resize",o)}),(s,i)=>(I(),we(t(ge),{title:s.title||M.title,bordered:!1,class:"monitor-card"},{"header-extra":w(()=>[f("div",Yt,[g(t(Te),{value:z.value,"onUpdate:value":[i[0]||(i[0]=d=>z.value=d),te],type:"datetimerange",shortcuts:O,placeholder:"选择时间范围",size:"small"},null,8,["value"]),g(t(Me),{size:"small",onClick:Y,loading:s.loading},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[i[1]||(i[1]=oe(" 刷新 "))]),_:1},8,["loading"])])]),default:w(()=>[f("div",Et,[f("div",{ref_key:"chartRef",ref:_,class:"chart-element"},null,512),s.loading?(I(),H("div",Ut,[g(t(be),{size:"large"})])):ee("",!0),!s.loading&&!G.value.length?(I(),H("div",Bt,[g(t(fe),{description:"暂无数据"})])):ee("",!0)])]),_:1},8,["title"]))}}),Vt=De(qt,[["__scopeId","data-v-048ecb0c"]]),Ft={class:"card-extra"},Gt={class:"chart-container"},Qt={key:0,class:"chart-loading"},Wt={key:1,class:"chart-empty"},Kt=se({__name:"ProcessMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},processDetailData:{type:Array,default:()=>[]},cpuColor:{type:String,default:"#1890ff"},memoryColor:{type:String,default:"#52c41a"}},emits:["refresh","time-range-change"],setup(a,{emit:x}){Se([Ce,ze,Ie,Le,Pe,Re,He]);const{t:e}=Ae("hub0000"),M=C(null);let u=null;const _=a,k=x,S=Date.now(),U=S-3600*1e3,z=C([U,S]),O={最近1小时:()=>{const r=Date.now();return[r-3600*1e3,r]},最近6小时:()=>{const r=Date.now();return[r-6*3600*1e3,r]},最近12小时:()=>{const r=Date.now();return[r-12*3600*1e3,r]},最近24小时:()=>{const r=Date.now();return[r-24*3600*1e3,r]},最近7天:()=>{const r=Date.now();return[r-7*24*3600*1e3,r]}},G=()=>{M.value&&(u=$e(M.value),window.addEventListener("resize",Y),N())},N=()=>{if(!u)return;if(!_.data||_.data.length===0){u.setOption({title:{show:!1}});return}const r=new Map;_.data.forEach(n=>{var v;r.has(n.collectTime)||r.set(n.collectTime,[]),(v=r.get(n.collectTime))==null||v.push(n)});const o=Array.from(r.keys()).sort(),s=[],i=[];o.forEach(n=>{const v=r.get(n)||[];if(v.length>0){const p=v.reduce((l,y)=>l+y.cpuPercent,0)/v.length,D=v.reduce((l,y)=>l+y.memoryPercent,0)/v.length;s.push(Number(p.toFixed(2))),i.push(Number(D.toFixed(2)))}else s.push(0),i.push(0)});const d={tooltip:{trigger:"axis",formatter:n=>{const v=n[0].dataIndex,p=r.get(o[v])||[];let D=E(o[v],"YYYY-MM-DD HH:mm:ss")+"<br/>";return n.forEach(l=>{const $=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${l.color};"></span>`;D+=$+l.seriesName+": "+l.value+"%<br/>"}),p.length>0&&(D+=`<span style="color:#666;">进程数量: ${p.length}</span><br/>`),p.length>0&&(D+="<br/><b>"+e("hub0000.process.detailTitle")+"</b><br/>",[...p].sort((y,$)=>$.cpuPercent-y.cpuPercent).slice(0,5).forEach((y,$)=>{D+='<div style="padding-left:10px;margin:2px 0;">',D+=`<b>${$+1}. ${y.processName}</b> <span style="color:#666;">(PID: ${y.processId})</span><br/>`,D+=`<span style="padding-left:15px;">CPU: ${y.cpuPercent.toFixed(2)}%, `,D+=`内存: ${y.memoryPercent.toFixed(2)}%, `,D+=`线程: ${y.threadCount}</span>`,D+="</div>"}),p.length>5&&(D+=`<div style="padding-left:10px;color:#999;">... 以及 ${p.length-5} 个其他进程</div>`)),D}},legend:{data:[e("hub0000.process.avgCpu"),e("hub0000.process.avgMemory")],bottom:0,padding:[10,20]},grid:{left:"3%",right:"4%",bottom:"15%",top:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:o.map(n=>E(n,"HH:mm:ss")),axisLabel:{interval:Math.floor(o.length/10)}},yAxis:{type:"value",min:0,max:100,position:"left",axisLabel:{formatter:"{value}%"}},series:[{name:e("hub0000.process.avgCpu"),type:"line",data:s,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:_.cpuColor}},{name:e("hub0000.process.avgMemory"),type:"line",data:i,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:_.memoryColor}}]};u.setOption(d)},Y=()=>{u==null||u.resize()},te=()=>{k("refresh")},m=r=>{k("time-range-change",r)};return ue(()=>_.data,()=>{N()},{deep:!0}),pe(()=>{G(),k("time-range-change",z.value)}),ye(()=>{u&&(u.dispose(),u=null),window.removeEventListener("resize",Y)}),(r,o)=>(I(),we(t(ge),{title:t(e)("hub0000.process.title"),bordered:!1,class:"monitor-card"},{"header-extra":w(()=>[f("div",Ft,[g(t(Te),{value:z.value,"onUpdate:value":[o[0]||(o[0]=s=>z.value=s),m],type:"datetimerange",shortcuts:O,placeholder:t(e)("common.selectTimeRange"),size:"small"},null,8,["value","placeholder"]),g(t(Me),{size:"small",onClick:te,loading:a.loading},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[oe(" "+Z(t(e)("common.refresh")),1)]),_:1},8,["loading"])])]),default:w(()=>{var s;return[f("div",Gt,[f("div",{ref_key:"chartRef",ref:M,class:"chart-element"},null,512),a.loading?(I(),H("div",Qt,[g(t(be),{size:"large"})])):ee("",!0),!a.loading&&!((s=a.data)!=null&&s.length)?(I(),H("div",Wt,[g(t(fe),{description:t(e)("common.noData")},null,8,["description"])])):ee("",!0)])]}),_:1},8,["title"]))}}),jt=De(Kt,[["__scopeId","data-v-631045b5"]]);var xe=(a=>(a.ONLINE="online",a.OFFLINE="offline",a.WARNING="warning",a.CRITICAL="critical",a))(xe||{});const re=Fe("SystemMonitorModel"),Jt=()=>{const a=C([]),x=C([]),e=C(!1),M=C(null),u=C([]),_=C([]),k=C(!1),S=C([]),U=C([]),z=C(!1),O=C([]),G=C([]),N=C(!1),Y=C([]),te=C(!1),m=C([]),r=C([]),o=C(!1),s=C([]),i=C(!1),d=C([]),n=C(!1),v=Ke({pageNum:1,pageSize:200,activeFlag:"Y"}),p=Ze(),D=q(()=>{const c=new Date,j=5*60*1e3;return a.value.filter(P=>{const A=u.value.filter(ne=>ne.metricServerId===P.metricServerId).sort((ne,he)=>new Date(he.collectTime).getTime()-new Date(ne.collectTime).getTime())[0];if(!A)return!1;const X=new Date(A.collectTime);return c.getTime()-X.getTime()<=j}).length}),l=q(()=>a.value.length-D.value),y=q(()=>{if(u.value.length===0)return 0;const c=new Map;u.value.forEach(P=>{const A=c.get(P.metricServerId);(!A||new Date(P.collectTime)>new Date(A.collectTime))&&c.set(P.metricServerId,P)});const j=Array.from(c.values()).reduce((P,A)=>P+A.usagePercent,0);return Math.round(j/c.size*100)/100}),$=q(()=>{if(S.value.length===0)return 0;const c=new Map;S.value.forEach(P=>{const A=c.get(P.metricServerId);(!A||new Date(P.collectTime)>new Date(A.collectTime))&&c.set(P.metricServerId,P)});const j=Array.from(c.values()).reduce((P,A)=>P+A.usagePercent,0);return Math.round(j/c.size*100)/100}),L=q(()=>{if(O.value.length===0)return 0;const c=new Map;O.value.forEach(P=>{const A=c.get(P.metricServerId);(!A||new Date(P.collectTime)>new Date(A.collectTime))&&c.set(P.metricServerId,P)});const j=Array.from(c.values()).reduce((P,A)=>P+A.usagePercent,0);return Math.round(j/c.size*100)/100}),J=q(()=>{const c={online:0,offline:0,warning:0,critical:0},j=new Date,P=5*60*1e3,A=10*60*1e3;return a.value.forEach(X=>{const ne=u.value.filter(ve=>ve.metricServerId===X.metricServerId).sort((ve,Ee)=>new Date(Ee.collectTime).getTime()-new Date(ve.collectTime).getTime())[0],he=S.value.filter(ve=>ve.metricServerId===X.metricServerId).sort((ve,Ee)=>new Date(Ee.collectTime).getTime()-new Date(ve.collectTime).getTime())[0];if(!ne||!he){c.offline++;return}const Ye=new Date(ne.collectTime),Be=j.getTime()-Ye.getTime();Be>A?c.offline++:Be>P?c.warning++:ne.usagePercent>90||he.usagePercent>90?c.critical++:c.online++}),c});return{serverList:a,selectedServerIds:x,serverListLoading:e,currentServer:M,cpuMetrics:u,cpuTrendData:_,cpuLoading:k,memoryMetrics:S,memoryTrendData:U,memoryLoading:z,diskMetrics:O,diskTrendData:G,diskLoading:N,diskIOMetrics:Y,diskIOLoading:te,networkMetrics:m,networkTrendData:r,networkLoading:o,processMetrics:s,processLoading:i,temperatureMetrics:d,temperatureLoading:n,queryParams:v,pagination:p,onlineServerCount:D,offlineServerCount:l,currentCpuUsage:y,currentMemoryUsage:$,currentDiskUsage:L,serverStatusDistribution:J,setServerList:c=>{a.value=c,re.info("设置服务器列表数据",{count:c.length})},setCurrentServer:c=>{M.value=c,re.info("设置当前服务器",{serverId:c==null?void 0:c.metricServerId})},upsertServerData:c=>{const j=a.value.findIndex(P=>P.metricServerId===c.metricServerId);j>=0?a.value[j]=c:a.value.push(c),re.info("更新服务器数据",{serverId:c.metricServerId})},removeServerData:c=>{const j=a.value.findIndex(P=>P.metricServerId===c);j>=0&&a.value.splice(j,1),re.info("删除服务器数据",{serverId:c})},setCpuMetrics:c=>{u.value=c,re.info("设置CPU监控数据",{count:c.length})},setCpuTrendData:c=>{_.value=c,re.info("设置CPU趋势数据",{count:c.length})},setMemoryMetrics:c=>{S.value=c,re.info("设置内存监控数据",{count:c.length})},setMemoryTrendData:c=>{U.value=c,re.info("设置内存趋势数据",{count:c.length})},setDiskMetrics:c=>{O.value=c,re.info("设置磁盘监控数据",{count:c.length})},setDiskTrendData:c=>{G.value=c,re.info("设置磁盘趋势数据",{count:c.length})},setDiskIOMetrics:c=>{Y.value=c,re.info("设置磁盘IO指标数据",{count:c.length})},setNetworkMetrics:c=>{m.value=c,re.info("设置网络监控数据",{count:c.length})},setNetworkTrendData:c=>{r.value=c,re.info("设置网络趋势数据",{count:c.length})},setProcessMetrics:c=>{s.value=c,re.info("设置进程监控数据",{count:c.length})},setTemperatureMetrics:c=>{d.value=c,re.info("设置温度监控数据",{count:c.length})},updateQueryParams:c=>{Object.assign(v,c),re.info("更新查询参数",c)},resetQueryParams:()=>{Object.assign(v,{pageNum:1,pageSize:20,activeFlag:"Y"}),re.info("重置查询参数")},getServerStatus:c=>{const j=new Date,P=5*60*1e3,A=u.value.filter(he=>he.metricServerId===c).sort((he,Ye)=>new Date(Ye.collectTime).getTime()-new Date(he.collectTime).getTime())[0];if(!A)return xe.OFFLINE;const X=new Date(A.collectTime);return j.getTime()-X.getTime()>P?xe.OFFLINE:A.usagePercent>90?xe.CRITICAL:A.usagePercent>80?xe.WARNING:xe.ONLINE},getServerLatestMetrics:c=>{const j=u.value.filter(X=>X.metricServerId===c).sort((X,ne)=>new Date(ne.collectTime).getTime()-new Date(X.collectTime).getTime())[0],P=S.value.filter(X=>X.metricServerId===c).sort((X,ne)=>new Date(ne.collectTime).getTime()-new Date(X.collectTime).getTime())[0],A=O.value.filter(X=>X.metricServerId===c).sort((X,ne)=>new Date(ne.collectTime).getTime()-new Date(X.collectTime).getTime())[0];return{cpu:j,memory:P,disk:A}}}},me=je("/gateway/hub0000"),Xt=a=>me.post("/server/query",a),Zt=a=>me.post("/server/detail",a),ea=a=>me.post("/cpu/query",a),ta=a=>me.post("/memory/query",a),aa=a=>me.post("/disk/partition/query",a),ra=a=>me.post("/disk/io/query",a),sa=a=>me.post("/network/query",a),na=a=>me.post("/process/query",a),oa=a=>me.post("/temperature/query",a),ia=a=>me.post("/export",a),T=Fe("SystemMonitorManagement"),ca=a=>{const x=Ge(),e=C(!1),M=async m=>{try{a.serverListLoading.value=!0;const r={...a.queryParams,...m};T.info("开始加载服务器列表",r);const o=await Xt(r);if(ce(o)){const s=le(o,[]);return a.setServerList(s),x.success("服务器列表加载成功"),T.info("服务器列表加载成功",{count:s.length}),s}else{const s=de(o,"加载服务器列表失败");return x.error(s),T.error("加载服务器列表失败",{error:s}),[]}}catch(r){const o="加载服务器列表异常";return x.error(o),T.error(o,r),[]}finally{a.serverListLoading.value=!1}},u=async m=>{try{e.value=!0,T.info("开始获取服务器详情",{serverId:m});const r=await Zt({metricServerId:m});if(ce(r)){const o=le(r);return T.info("获取服务器详情成功",{serverId:m}),o}else{const o=de(r,"获取服务器详情失败");return x.error(o),T.error("获取服务器详情失败",{serverId:m,error:o}),null}}catch(r){const o="获取服务器详情异常";return x.error(o),T.error(o,{serverId:m,error:r}),null}finally{e.value=!1}},_=()=>a.serverList.value.length>0?a.serverList.value[0].metricServerId:"",k=async m=>{try{a.cpuLoading.value=!0,T.info("开始加载CPU监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await ea(r);if(ce(o)){const s=le(o,[]);a.setCpuMetrics(s),T.info("CPU监控数据加载成功",{count:s.length})}else{const s=de(o,"加载CPU监控数据失败");T.error("加载CPU监控数据失败",{error:s})}}catch(r){T.error("加载CPU监控数据异常",r)}finally{a.cpuLoading.value=!1}},S=async m=>{try{a.memoryLoading.value=!0,T.info("开始加载内存监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await ta(r);if(ce(o)){const s=le(o,[]);a.setMemoryMetrics(s),T.info("内存监控数据加载成功",{count:s.length})}else{const s=de(o,"加载内存监控数据失败");T.error("加载内存监控数据失败",{error:s})}}catch(r){T.error("加载内存监控数据异常",r)}finally{a.memoryLoading.value=!1}},U=async m=>{try{a.diskLoading.value=!0,T.info("开始加载磁盘监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await aa(r);if(ce(o)){const s=le(o,[]);a.setDiskMetrics(s),T.info("磁盘监控数据加载成功",{count:s.length})}else{const s=de(o,"加载磁盘监控数据失败");T.error("加载磁盘监控数据失败",{error:s})}}catch(r){T.error("加载磁盘监控数据异常",r)}finally{a.diskLoading.value=!1}},z=async m=>{try{a.networkLoading.value=!0,T.info("开始加载网络监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await sa(r);if(ce(o)){const s=le(o,[]);a.setNetworkMetrics(s),T.info("网络监控数据加载成功",{count:s.length})}else{const s=de(o,"加载网络监控数据失败");T.error("加载网络监控数据失败",{error:s})}}catch(r){T.error("加载网络监控数据异常",r)}finally{a.networkLoading.value=!1}},O=async m=>{try{a.processLoading.value=!0,T.info("开始加载进程监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await na(r);if(ce(o)){const s=le(o,[]);a.setProcessMetrics(s),T.info("进程监控数据加载成功",{count:s.length})}else{const s=de(o,"加载进程监控数据失败");T.error("加载进程监控数据失败",{error:s})}}catch(r){T.error("加载进程监控数据异常",r)}finally{a.processLoading.value=!1}},G=async m=>{try{a.temperatureLoading.value=!0,T.info("开始加载温度监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await oa(r);if(ce(o)){const s=le(o,[]);a.setTemperatureMetrics(s),T.info("温度监控数据加载成功",{count:s.length})}else{const s=de(o,"加载温度监控数据失败");T.error("加载温度监控数据失败",{error:s})}}catch(r){T.error("加载温度监控数据异常",r)}finally{a.temperatureLoading.value=!1}},N=async m=>{try{a.diskIOLoading.value=!0,T.info("开始加载磁盘IO监控数据",{serverId:m});const r={...m?{metricServerId:m}:{},...a.queryParams},o=await ra(r);if(ce(o)){const s=le(o,[]);a.setDiskIOMetrics(s),T.info("磁盘IO监控数据加载成功",{count:s.length})}else{const s=de(o,"加载磁盘IO监控数据失败");T.error("加载磁盘IO监控数据失败",{error:s})}}catch(r){T.error("加载磁盘IO监控数据异常",r)}finally{a.diskIOLoading.value=!1}};return{operationLoading:e,loadServerList:M,getServerInfo:u,getDefaultServerId:_,loadCPUMetrics:k,loadMemoryMetrics:S,loadDiskMetrics:U,loadDiskIOMetrics:N,loadNetworkMetrics:z,loadProcessMetrics:O,loadTemperatureMetrics:G,loadAllMetrics:async m=>{if(!m){T.warn("未提供服务器ID，无法加载监控数据");return}try{e.value=!0,T.info("开始加载所有监控数据",{serverId:m}),await Promise.all([k(m),S(m),U(m),N(m),z(m),O(m),G(m)]),T.info("所有监控数据加载成功")}catch(r){throw T.error("加载所有监控数据异常",r),r}finally{e.value=!1}},exportData:async m=>{try{e.value=!0,T.info("开始导出监控数据",m);const r=await ia(m);if(ce(r)){const o=le(r);return x.success("数据导出成功"),T.info("数据导出成功",{downloadUrl:o}),o}else{const o=de(r,"导出监控数据失败");return x.error(o),T.error("导出监控数据失败",{error:o}),null}}catch(r){const o="导出监控数据异常";return x.error(o),T.error(o,r),null}finally{e.value=!1}}}},la={class:"system-monitoring"},da={class:"server-selector"},ua={class:"selector-content"},ma={key:0,class:"overview-cards"},ha={class:"overview-grid"},fa={class:"overview-item"},ga={class:"overview-icon hostname"},va={class:"overview-content"},pa={class:"overview-value text-truncate"},ya={class:"overview-item"},wa={class:"overview-icon os"},ba={class:"overview-content"},Ma={class:"overview-value text-truncate"},Da={class:"overview-item"},_a={class:"overview-icon version"},ka={class:"overview-content"},xa={class:"overview-value text-truncate"},Ta={class:"overview-item"},Sa={class:"overview-icon architecture"},$a={class:"overview-content"},Ca={class:"overview-value text-truncate"},za={class:"overview-item"},Ia={class:"overview-icon server-type"},La={class:"overview-content"},Pa={class:"overview-value text-truncate"},Ra={class:"overview-item"},Ha={class:"overview-icon ip"},Aa={class:"overview-content"},Oa={class:"overview-value text-truncate"},Na={key:1,class:"loading-container"},Ya={key:2,class:"charts-container"},Ea={class:"chart-row"},Ua={class:"chart-item"},Ba={class:"chart-item"},qa={class:"chart-row"},Va={class:"chart-item"},Fa={class:"chart-item"},Ga={class:"chart-row"},Qa={class:"chart-item"},Wa={class:"chart-item"},Ka={key:3,class:"no-data-container"},ja={key:4,class:"no-data-container"},Ja=se({__name:"SystemMonitoring",setup(a){const x=Ge(),e=Jt(),M=ca(e),u=C(""),_=C(!0),k=q(()=>u.value&&e.serverList.value.find(h=>h.metricServerId===u.value)||null),S=h=>({physical:"物理机",virtual:"虚拟机",unknown:"未知"})[h||"unknown"]||"未知",U=h=>{const b=h.toLowerCase();return b.includes("windows")?ht:b.includes("linux")?qe:b.includes("mac")||b.includes("darwin")?rt:Ve},z=h=>{if(!h)return"N/A";if(h.toLowerCase().includes("windows")){const b=h.match(/Windows (\d+(?:\.\d+)?)/i);if(b){const R=b[1],F=h.match(/Windows \d+(?:\.\d+)?\s+(\w+)/i);return F?`Windows ${R} ${F[1]}`:`Windows ${R}`}}return h.length>20?h.substring(0,17)+"...":h},O=q(()=>[...[{label:"全部服务器",value:""}],...e.serverList.value.map(b=>({label:`${b.hostname} (${b.ipAddress||"N/A"})`,value:b.metricServerId}))]),G=async h=>{if(h){const[b,R]=h;e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(R,"YYYY-MM-DD HH:mm:ss")}),await M.loadCPUMetrics(u.value)}},N=async h=>{if(h){const[b,R]=h;e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(R,"YYYY-MM-DD HH:mm:ss")}),await M.loadMemoryMetrics(u.value)}},Y=async h=>{if(h){const[b,R]=h;e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(R,"YYYY-MM-DD HH:mm:ss")}),await M.loadDiskMetrics(u.value)}},te=async h=>{if(h){const[b,R]=h;e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(R,"YYYY-MM-DD HH:mm:ss")}),await M.loadNetworkMetrics(u.value)}},m=async h=>{if(h){const[b,R]=h;e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(R,"YYYY-MM-DD HH:mm:ss")}),await M.loadDiskIOMetrics(u.value)}},r=async h=>{if(h){const[b,R]=h;e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(R,"YYYY-MM-DD HH:mm:ss")}),await M.loadProcessMetrics(u.value)}};ue(()=>e.pagination.pagination.page,h=>{e.queryParams.pageNum=h,o()}),ue(()=>e.pagination.pagination.pageSize,h=>{e.queryParams.pageSize=h,o()}),ue(()=>({tenantId:e.queryParams.tenantId,hostname:e.queryParams.hostname,osType:e.queryParams.osType,serverType:e.queryParams.serverType,activeFlag:e.queryParams.activeFlag}),()=>{_.value||o()},{deep:!0});const o=async()=>{try{const h=await M.loadServerList();!u.value&&h.length>0&&(u.value=h[0].metricServerId,await s(h[0].metricServerId))}catch(h){console.error("加载服务器列表失败",h),x.error("加载服务器列表失败")}},s=async h=>{try{e.updateQueryParams({metricServerId:h,startTime:e.queryParams.startTime,endTime:e.queryParams.endTime}),await M.loadAllMetrics(h)}catch(b){console.error("加载服务器监控数据失败",b),x.error("加载服务器监控数据失败")}},i=async()=>{try{_.value=!0;const h=new Date,b=new Date(h.getTime()-3600*1e3);e.updateQueryParams({startTime:E(b,"YYYY-MM-DD HH:mm:ss"),endTime:E(h,"YYYY-MM-DD HH:mm:ss")}),await o()}catch(h){console.error("初始化数据失败",h),x.error("加载监控数据失败，请刷新页面重试")}finally{_.value=!1}},d=async h=>{if(h)try{K.value=!0,await s(h),x.success("服务器监控数据加载成功")}catch(b){console.error("加载服务器监控数据失败",b),x.error("加载服务器监控数据失败")}finally{K.value=!1}},n=async()=>{if(!u.value){x.warning("请先选择一个服务器");return}try{K.value=!0,await s(u.value),x.success("所有监控数据刷新成功")}catch(h){console.error("刷新监控数据失败",h),x.error("刷新监控数据失败")}finally{K.value=!1}},v=async()=>{await M.loadCPUMetrics(u.value),x.success("CPU数据刷新成功")},p=async()=>{await M.loadMemoryMetrics(u.value),x.success("内存数据刷新成功")},D=async()=>{await M.loadDiskMetrics(u.value),x.success("磁盘数据刷新成功")},l=async()=>{await M.loadNetworkMetrics(u.value),x.success("网络数据刷新成功")},y=async()=>{await M.loadDiskIOMetrics(u.value),x.success("磁盘IO数据刷新成功")},$=async()=>{await M.loadProcessMetrics(u.value),x.success("进程数据刷新成功")};ue(()=>e.serverList.value,h=>{h.length>0&&!u.value&&(u.value=h[0].metricServerId)}),pe(()=>{i()}),ye(()=>{console.log("SystemMonitoring组件已卸载")});const{serverListLoading:L,cpuLoading:J,memoryLoading:Q,diskLoading:V,diskIOLoading:B,networkLoading:ae,processLoading:W}=e,{operationLoading:K}=M;return(h,b)=>(I(),H("div",la,[f("div",da,[g(t(ge),{title:"服务器选择",embedded:""},{default:w(()=>[f("div",ua,[g(t(et),{value:u.value,"onUpdate:value":[b[0]||(b[0]=R=>u.value=R),d],options:O.value,placeholder:"选择服务器",loading:t(L),clearable:""},null,8,["value","options","loading"]),g(t(Me),{onClick:n,loading:t(K)},{icon:w(()=>[g(t(ie),null,{default:w(()=>[g(t(_e))]),_:1})]),default:w(()=>[b[1]||(b[1]=oe(" 刷新数据 "))]),_:1},8,["loading"])])]),_:1})]),k.value?(I(),H("div",ma,[g(t(ge),{title:"服务器信息",embedded:""},{default:w(()=>[f("div",ha,[f("div",fa,[f("div",ga,[g(t(ie),{size:"24"},{default:w(()=>[g(t(it))]),_:1})]),f("div",va,[b[2]||(b[2]=f("div",{class:"overview-label"},"主机名",-1)),g(t(ke),{"show-arrow":!1},{trigger:w(()=>[f("div",pa,Z(k.value.hostname),1)]),default:w(()=>[oe(" "+Z(k.value.hostname),1)]),_:1})])]),f("div",ya,[f("div",wa,[g(t(ie),{size:"24"},{default:w(()=>[(I(),we(Je(U(k.value.osType))))]),_:1})]),f("div",ba,[b[3]||(b[3]=f("div",{class:"overview-label"},"操作系统",-1)),g(t(ke),{"show-arrow":!1},{trigger:w(()=>[f("div",Ma,Z(k.value.osType),1)]),default:w(()=>[oe(" "+Z(k.value.osType),1)]),_:1})])]),f("div",Da,[f("div",_a,[g(t(ie),{size:"24"},{default:w(()=>[g(t(qe))]),_:1})]),f("div",ka,[b[4]||(b[4]=f("div",{class:"overview-label"},"系统版本",-1)),g(t(ke),{"show-arrow":!1},{trigger:w(()=>[f("div",xa,Z(z(k.value.osVersion)),1)]),default:w(()=>[oe(" "+Z(k.value.osVersion),1)]),_:1})])]),f("div",Ta,[f("div",Sa,[g(t(ie),{size:"24"},{default:w(()=>[g(t(Ve))]),_:1})]),f("div",$a,[b[5]||(b[5]=f("div",{class:"overview-label"},"系统架构",-1)),g(t(ke),{"show-arrow":!1},{trigger:w(()=>[f("div",Ca,Z(k.value.architecture),1)]),default:w(()=>[oe(" "+Z(k.value.architecture),1)]),_:1})])]),f("div",za,[f("div",Ia,[g(t(ie),{size:"24"},{default:w(()=>[g(t(nt))]),_:1})]),f("div",La,[b[6]||(b[6]=f("div",{class:"overview-label"},"服务器类型",-1)),g(t(ke),{"show-arrow":!1},{trigger:w(()=>[f("div",Pa,Z(S(k.value.serverType)),1)]),default:w(()=>[oe(" "+Z(S(k.value.serverType)),1)]),_:1})])]),f("div",Ra,[f("div",Ha,[g(t(ie),{size:"24"},{default:w(()=>[g(t(dt))]),_:1})]),f("div",Aa,[b[7]||(b[7]=f("div",{class:"overview-label"},"IP地址",-1)),g(t(ke),{"show-arrow":!1},{trigger:w(()=>[f("div",Oa,Z(k.value.ipAddress||"N/A"),1)]),default:w(()=>[oe(" "+Z(k.value.ipAddress||"N/A"),1)]),_:1})])])])]),_:1})])):ee("",!0),_.value?(I(),H("div",Na,[g(t(be),{size:"large"}),b[8]||(b[8]=f("p",null,"正在加载服务器监控数据，请稍候...",-1))])):ee("",!0),!_.value&&u.value?(I(),H("div",Ya,[f("div",Ea,[f("div",Ua,[g(t(wt),{data:t(e).cpuMetrics.value,loading:t(J),"warning-threshold":80,"danger-threshold":90,"cpu-detail-data":t(e).cpuMetrics.value,onRefresh:v,onTimeRangeChange:G},null,8,["data","loading","cpu-detail-data"])]),f("div",Ba,[g(t(xt),{data:t(e).memoryMetrics.value,loading:t(Q),"warning-threshold":80,"danger-threshold":90,"memory-detail-data":t(e).memoryMetrics.value,onRefresh:p,onTimeRangeChange:N},null,8,["data","loading","memory-detail-data"])])]),f("div",qa,[f("div",Va,[g(t(It),{data:t(e).diskMetrics.value,loading:t(V),"warning-threshold":80,"danger-threshold":90,"disk-detail-data":t(e).diskMetrics.value,onRefresh:D,onTimeRangeChange:Y},null,8,["data","loading","disk-detail-data"])]),f("div",Fa,[g(t(Nt),{data:t(e).diskIOMetrics.value,loading:t(B),"disk-io-detail-data":t(e).diskIOMetrics.value,onRefresh:y,onTimeRangeChange:m},null,8,["data","loading","disk-io-detail-data"])])]),f("div",Ga,[f("div",Qa,[g(t(Vt),{data:t(e).networkMetrics.value,loading:t(ae),"network-detail-data":t(e).networkMetrics.value,"upload-color":"#ff4d4f","download-color":"#52c41a",onRefresh:l,onTimeRangeChange:te},null,8,["data","loading","network-detail-data"])]),f("div",Wa,[g(t(jt),{data:t(e).processMetrics.value,loading:t(W),"process-detail-data":t(e).processMetrics.value,onRefresh:$,onTimeRangeChange:r},null,8,["data","loading","process-detail-data"])])])])):ee("",!0),!_.value&&!u.value&&t(e).serverList.value.length>0?(I(),H("div",Ka,[g(t(fe),{description:"请选择一个服务器查看监控数据"})])):ee("",!0),!_.value&&t(e).serverList.value.length===0?(I(),H("div",ja,[g(t(fe),{description:"暂无可用的服务器"})])):ee("",!0)]))}}),mr=De(Ja,[["__scopeId","data-v-693bc908"]]);export{mr as default};
