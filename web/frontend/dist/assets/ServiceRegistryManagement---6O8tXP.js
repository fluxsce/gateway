import{bt as ge,bv as Lt,bw as zt,d as re,J as b,ag as k,bi as $t,g as M,c as q,o as x,a as d,$ as Mt,e as ue,b as he,r as F,f as Ae,a0 as Te,a2 as Ee,a1 as ye,cD as pt,cw as vt,cP as Fe,dm as qe,cO as Je,v as O,ac as B,a3 as pe,I as z,a7 as ce,cY as Vt,q as V,w as l,t as Z,m as t,n as e,cz as se,x as p,cA as Kt,N as Bt,P as qt,V as W,_ as fe,cE as ht,R as Ne,a8 as Me,a9 as ee,aa as He,H as we,U as Ge,aj as ft,ak as Ye,h as Le,E as H,cU as We,cB as Jt,ab as je,p as Yt,al as Wt,dn as lt,dp as jt,B as Ve,C as E,Y as mt,a4 as gt,cT as Zt,bb as Re,bc as xe,am as Qt,an as Xt,F as st}from"./index-CzIbiPcR.js";import{u as yt}from"./usePagination-rBGSs64l.js";import{C as _t}from"./CreateOutline-BFkdrBh9.js";import{T as Ke}from"./TrashOutline-2R_Ts6Ka.js";import{T as Ie}from"./TimeOutline-e6ea6nIg.js";import{N as ea,_ as Ze,e as ta}from"./DataTable-CMD0QL_W.js";import{g as rt,m as nt,a as ot,b as it,c as ct,f as aa,d as la,N as sa}from"./DatePicker-B9xNNxDH.js";import{H as ra,N as bt,a as St}from"./HeartOutline-DeDwNs4O.js";import{C as Be}from"./CloseCircleOutline-Dzm8Wp_s.js";import{C as Qe}from"./CheckmarkCircleOutline-DaZKMTJF.js";import{R as ke}from"./RefreshOutline-CA3Zk8OZ.js";import{_ as j}from"./RadioGroup-BBKwhzSS.js";import{A as Ct}from"./ArrowBackOutline-BrInevtc.js";import{C as na}from"./ChevronDownOutline-DbTRakv4.js";import{A as Ue}from"./AddOutline-DReI0b2u.js";import{N as oa}from"./Popconfirm-Jlwr2tlU.js";import{_ as Y,a as D}from"./Grid-DtPWGMN9.js";import{N as me}from"./Switch-DmPX386B.js";import{N as ie}from"./InputNumber-DYqA-vrb.js";import{N as ia}from"./CollapseTransition-Dv8Ngul9.js";import{I as Oe}from"./InformationCircleOutline-DB_x5CQ_.js";import{N as ca}from"./Code-C9OmRaPm.js";import{R as ua}from"./ReloadOutline-Btqzp1-L.js";import"./index-C9U1NGvg.js";function da(n,u){const i=ge(n),f=ge(u),a=i.getTime()-f.getTime();return a<0?-1:a>0?1:a}function pa(n){return u=>{const f=(n?Math[n]:Math.trunc)(u);return f===0?0:f}}function va(n,u,i){const f=Lt(),a=(i==null?void 0:i.locale)??f.locale??zt,g=da(n,u);if(isNaN(g))throw new RangeError("Invalid time value");const m=Object.assign({},i,{addSuffix:i==null?void 0:i.addSuffix,comparison:g});let w,P;g>0?(w=ge(u),P=ge(n)):(w=ge(n),P=ge(u));const T=pa((i==null?void 0:i.roundingMethod)??"round"),h=P.getTime()-w.getTime(),U=h/ct,y=rt(P)-rt(w),N=(h-y)/ct,v=i==null?void 0:i.unit;let C;if(v?C=v:U<1?C="second":U<60?C="minute":U<nt?C="hour":N<ot?C="day":N<it?C="month":C="year",C==="second"){const R=T(h/1e3);return a.formatDistance("xSeconds",R,m)}else if(C==="minute"){const R=T(U);return a.formatDistance("xMinutes",R,m)}else if(C==="hour"){const R=T(U/60);return a.formatDistance("xHours",R,m)}else if(C==="day"){const R=T(N/nt);return a.formatDistance("xDays",R,m)}else if(C==="month"){const R=T(N/ot);return R===12&&v!=="month"?a.formatDistance("xYears",1,m):a.formatDistance("xMonths",R,m)}else{const R=T(N/it);return a.formatDistance("xYears",R,m)}}function ut(n){return ge(n*1e3)}const ha={time:{type:[Number,Date],default:void 0},type:{type:String,default:"datetime"},to:{type:[Number,Date],default:void 0},unix:Boolean,format:String,text:Boolean,timeZone:String},ve=re({name:"Time",props:ha,setup(n){const u=Date.now(),{localeRef:i,dateLocaleRef:f}=$t("Time"),a=M(()=>{const{timeZone:T}=n;return T?(h,U,y)=>aa(h,T,U,y):la}),g=M(()=>({locale:f.value.locale})),m=M(()=>{const{time:T}=n;return n.unix?T===void 0?u:ut(typeof T=="number"?T:T.valueOf()):T??u}),w=M(()=>{const{to:T}=n;return n.unix?T===void 0?u:ut(typeof T=="number"?T:T.valueOf()):T??u});return{renderedTime:M(()=>n.format?a.value(m.value,n.format,g.value):n.type==="date"?a.value(m.value,i.value.dateFormat,g.value):n.type==="datetime"?a.value(m.value,i.value.dateTimeFormat,g.value):va(m.value,w.value,{addSuffix:!0,locale:f.value.locale}))}},render(){return this.text?b(this.renderedTime):k("time",[this.renderedTime])}}),fa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ma=re({name:"ArrowDownOutline",render:function(u,i){return x(),q("svg",fa,i[0]||(i[0]=[d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 268l144 144l144-144"},null,-1),d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M256 392V100"},null,-1)]))}}),ga={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ya=re({name:"ArrowUpOutline",render:function(u,i){return x(),q("svg",ga,i[0]||(i[0]=[d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 244l144-144l144 144"},null,-1),d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M256 120v292"},null,-1)]))}}),_a={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ba=re({name:"EllipsisHorizontalOutline",render:function(u,i){return x(),q("svg",_a,i[0]||(i[0]=[d("circle",{cx:"256",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),d("circle",{cx:"416",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),d("circle",{cx:"96",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),Q=Mt("/gateway/hub0041"),Sa=async n=>Q.post("/queryServices",n),Tt=async n=>Q.post("/getService",{serviceName:n}),Ca=async n=>Q.post("/createService",n),Ta=async n=>Q.post("/updateService",n),Ea=async n=>Q.post("/deleteService",{serviceName:n}),Xe=async n=>Q.post("/queryServiceInstances",n),Na=async n=>Q.post("/getServiceInstance",{serviceInstanceId:n}),Ia=async n=>Q.post("/createServiceInstance",n),Et=async n=>Q.post("/updateServiceInstance",n),wa=async n=>Q.post("/deleteServiceInstance",{serviceInstanceId:n}),ka=async(n,u)=>Q.post("/updateInstanceHealthStatus",{serviceInstanceId:n,healthStatus:u}),Nt=async()=>Q.post("/getServiceGroups",{}),Da=async n=>Q.post("/queryServiceEvents",n),It=async n=>await Q.post("/getServiceEvent",{serviceEventId:n}),dt=async n=>{const u=await Tt(n);if(!u.oK)return u;const i=await Xe({serviceName:n,pageIndex:1,pageSize:1e3});let f={},a=[];try{f=typeof u.bizData=="string"?JSON.parse(u.bizData):u.bizData}catch(m){console.error("Failed to parse service data:",m)}try{if(i.oK&&i.bizData){const m=typeof i.bizData=="string"?JSON.parse(i.bizData):i.bizData;a=(m==null?void 0:m.items)||[],console.log("Raw instances response:",i),console.log("Parsed instances data:",m),console.log("Final instances data:",a),a.length>0&&(console.log("First instance sample:",a[0]),console.log("Instance keys:",Object.keys(a[0])))}}catch(m){console.error("Failed to parse instances data:",m)}const g={...f,instances:a,statistics:Pa(a)};return{oK:!0,state:!0,bizData:JSON.stringify(g),extObj:null,pageQueryData:"",messageId:"",errMsg:"",popMsg:"",extMsg:"",pkey1:"",pkey2:"",pkey3:"",pkey4:"",pkey5:"",pkey6:""}},Pa=n=>({totalInstances:n.length,healthyInstances:n.filter(u=>u.healthStatus==="HEALTHY").length,unhealthyInstances:n.filter(u=>u.healthStatus==="UNHEALTHY").length,upInstances:n.filter(u=>u.instanceStatus==="UP").length,downInstances:n.filter(u=>u.instanceStatus==="DOWN").length}),Ra=()=>{const{t:n}=ue("hub0041"),u=he(),i=F([]),f=F(!1),a=F(0),g=Ae({serviceName:"",groupName:"",protocolType:void 0,activeFlag:void 0}),{naiveConfig:m,queryParams:w,setTotal:P,resetPagination:T}=yt({initialPage:1,initialPageSize:12,onPageChange:r=>{U()},onPageSizeChange:(r,_)=>{U()}}),h=M(()=>a.value),U=async()=>{try{f.value=!0;const r={...g,pageIndex:w.value.pageIndex,pageSize:w.value.pageSize},_=await Sa(r);if(Te(_)){const S=ye(_,[]);i.value=S||[];let G=0;try{G=pt(_).totalCount||0}catch(A){console.warn("解析分页信息失败:",A),G=(S==null?void 0:S.length)||0}a.value=G,P(G)}else u.error(Ee(_,n("fetchServicesFailed"))),i.value=[],a.value=0,P(0)}catch(r){console.error("Failed to fetch services:",r),u.error(n("fetchServicesFailed")),i.value=[],a.value=0,P(0)}finally{f.value=!1}};return{services:i,loading:f,searchParams:g,naiveConfig:m,totalCount:h,fetchServices:U,refreshService:async r=>{try{const _=await Tt(r);Te(_)?(u.success(n("refreshServiceSuccess")),await U()):u.error(Ee(_,n("refreshServiceFailed")))}catch(_){console.error("Failed to refresh service:",_),u.error(n("refreshServiceFailed"))}},handleSearch:()=>{T(),U()},handleReset:()=>{Object.assign(g,{serviceName:"",groupName:"",protocolType:void 0,activeFlag:void 0}),T(),U()},handleRefresh:()=>{U()},handleDeleteService:async r=>{try{const _=await Ea(r);if(Te(_))return u.success(n("deleteServiceSuccess")),await U(),{success:!0,message:n("deleteServiceSuccess")};{const S=Ee(_,n("deleteServiceFailed"));return u.error(S),{success:!1,message:S}}}catch(_){console.error("Failed to delete service:",_);const S=n("deleteServiceFailed");return u.error(S),{success:!1,message:S}}}}},xa=()=>{const{t:n}=ue("hub0041"),u=he(),i=F(null),f=F(!1),a=F(!1),g=async y=>{try{f.value=!0;const N=await dt(y);if(N.oK)try{i.value=ye(N)}catch(v){console.error("Failed to parse service detail data:",v),i.value=null}else u.error(n("fetchDetailFailed")),i.value=null}catch(N){console.error("Failed to fetch service detail:",N),u.error(n("fetchDetailFailed")),i.value=null}finally{f.value=!1}},m=async y=>{if(i.value)try{a.value=!0;const N=await Xe({serviceName:y});if(N.oK)try{const v=vt(N.bizData);i.value.instances=v,w(),u.success(n("refreshInstancesSuccess"))}catch(v){console.error("Failed to parse instances data:",v)}else u.error(n("refreshInstancesFailed"))}catch(N){console.error("Failed to refresh service instances:",N),u.error(n("refreshInstancesFailed"))}finally{a.value=!1}},w=()=>{if(!i.value)return;const y=i.value.instances,N={totalInstances:y.length,healthyInstances:y.filter(v=>v.healthStatus==="HEALTHY").length,unhealthyInstances:y.filter(v=>v.healthStatus==="UNHEALTHY").length,upInstances:y.filter(v=>v.instanceStatus==="UP").length,downInstances:y.filter(v=>v.instanceStatus==="DOWN").length};i.value.statistics=N};return{serviceDetail:i,loading:f,instancesLoading:a,fetchServiceDetail:g,refreshServiceInstances:m,performHealthCheck:async(y,N)=>{try{let v;if(N)v=await ka(N,"HEALTHY");else if(v=await dt(y),v.oK)try{i.value=ye(v)}catch(C){console.error("Failed to parse health check data:",C)}v.oK?(u.success(n("healthCheckSuccess")),N&&await m(y)):u.error(n("healthCheckFailed"))}catch(v){console.error("Failed to perform health check:",v),u.error(n("healthCheckFailed"))}},updateInstanceStatus:async(y,N,v)=>{try{const C={...N,instanceStatus:v};(await Et(C)).oK?(u.success(n(v==="UP"?"bringUpSuccess":"takeDownSuccess")),await m(y)):u.error(n(v==="UP"?"bringUpFailed":"takeDownFailed"))}catch(C){console.error(`Failed to ${v==="UP"?"bring up":"take down"} instance:`,C),u.error(n(v==="UP"?"bringUpFailed":"takeDownFailed"))}},getInstanceMetadata:async y=>{try{const N=await Na(y);if(N.oK)try{return ye(N,null)}catch(v){return console.error("Failed to parse metadata:",v),null}else return u.error(n("fetchMetadataFailed")),null}catch(N){return console.error("Failed to fetch instance metadata:",N),u.error(n("fetchMetadataFailed")),null}},clearServiceDetail:()=>{i.value=null}}};function wt(){const{t:n}=ue("hub0041"),u=he(),i=F(!1),f=F(null),a=F([]),g=F(0),m=_=>_.includes("GROUP_")?Fe:_.includes("SERVICE_")?qe:_.includes("INSTANCE_")?Je:Oe,w=_=>_==="GROUP_CREATE"?"success":_==="GROUP_UPDATE"?"info":_==="GROUP_DELETE"?"error":_==="SERVICE_CREATE"?"success":_==="SERVICE_UPDATE"?"info":_==="SERVICE_DELETE"?"error":_==="INSTANCE_REGISTER"?"success":_==="INSTANCE_DEREGISTER"?"error":_==="INSTANCE_HEARTBEAT"?"default":_==="INSTANCE_HEALTH_CHANGE"?"warning":_==="INSTANCE_STATUS_CHANGE"?"info":"default";let P=null;const{naiveConfig:T,queryParams:h,setTotal:U,resetPagination:y}=yt({initialPage:1,initialPageSize:10,onPageChange:_=>{P&&P()},onPageSizeChange:(_,S)=>{P&&P()}}),N=_=>{P=_},v=_=>[{title:n("columns.eventType"),key:"eventType",width:180,minWidth:160,render(S){return k(B,{type:w(S.eventType),bordered:!1,round:!0,size:"small"},{default:()=>S.eventType,icon:()=>k(O,{},{default:()=>k(m(S.eventType))})})}},{title:n("columns.eventMessage"),key:"eventMessage",minWidth:200,ellipsis:{tooltip:{placement:"bottom",width:"trigger",style:{maxWidth:"400px"}}},render(S){return S.eventMessage||"-"}},{title:n("columns.eventSource"),key:"eventSource",width:140,ellipsis:{tooltip:!0}},{title:n("columns.serviceName"),key:"serviceName",width:120,ellipsis:{tooltip:!0}},{title:n("columns.hostAddress"),key:"hostAddress",width:150,ellipsis:{tooltip:!0},render(S){return S.hostAddress?`${S.hostAddress}:${S.portNumber||"-"}`:"-"}},{title:"服务运行节点IP",key:"nodeIpAddress",width:140,ellipsis:{tooltip:!0},render(S){return S.nodeIpAddress||"-"}},{title:n("columns.eventTime"),key:"eventTime",width:160,sorter:!0,render(S){return k(ve,{time:new Date(S.eventTime),format:"yyyy-MM-dd HH:mm:ss"})}},{title:n("columns.actions"),key:"actions",width:80,fixed:"right",render(S){return k(ce,{justify:"center",size:"small"},{default:()=>[k(pe,{},{trigger:()=>k(z,{quaternary:!0,circle:!0,size:"small",onClick:()=>_(S)},{icon:()=>k(O,{size:18},{default:()=>k(Oe)})}),default:()=>n("actions.view")})]})}}],C=async _=>{i.value=!0,f.value=null;try{const S=await Da(_);if(Te(S)){const G=ye(S,[]);let A=0;try{A=pt(S).totalCount||0}catch(I){console.warn("解析分页信息失败:",I),A=(G==null?void 0:G.length)||0}return{data:G,totalCount:A}}else{const G=Ee(S,n("fetchServiceEventsFailed"));throw u.error(G),f.value=new Error(G),new Error(G)}}catch(S){throw f.value=S,console.error("Failed to fetch service events:",S),S}finally{i.value=!1}};return{events:a,loading:i,error:f,total:g,naiveConfig:T,queryParams:h,setTotal:U,resetPagination:y,setPaginationCallback:N,fetchServiceEvents:C,getServiceEventById:async _=>{i.value=!0,f.value=null;try{const S=await It(_);if(Te(S))return ye(S);{const G=Ee(S,n("getServiceEventFailed"));throw u.error(G),f.value=new Error(G),new Error(G)}}catch(S){throw f.value=S,console.error("Failed to get service event by id:",S),S}finally{i.value=!1}},loadEvents:async(_,S,G)=>{try{const A={pageIndex:h.value.pageIndex,pageSize:h.value.pageSize,serviceInstanceId:S,serviceGroupId:_||void 0,...G},{data:I,totalCount:L}=await C(A);a.value=I,g.value=L,U(L)}catch(A){u.error(n("messages.loadError")),console.error("加载服务事件列表失败:",A)}},createTableColumns:v,getEventTypeIcon:m,getEventTypeColor:w}}const Ua={class:"card-content"},Aa={class:"card-header"},Oa={class:"service-name-row"},Fa={class:"name-with-badge"},Ha={class:"service-meta"},Ga={class:"group-info"},La={class:"group-name"},za={key:0,class:"group-id"},$a={key:0,class:"tenant-info"},Ma={class:"tenant-tag"},Va={class:"tenant-name"},Ka={key:0,class:"service-description"},Ba={class:"instance-count"},qa={class:"instance-count-item"},Ja={class:"count-text"},Ya={class:"card-footer"},Wa={class:"footer-item"},ja={class:"footer-text"},Za={class:"footer-item"},Qa=re({__name:"ServiceCard",props:{service:{}},emits:["viewDetail","edit","delete","viewEvents"],setup(n,{emit:u}){const i=n,f=u,{t:a}=ue("hub0041"),g=M(()=>[{label:a("actions.viewEvents"),key:"viewEvents",icon:()=>k(O,null,{default:()=>k(Vt)})},{label:a("actions.edit"),key:"edit",icon:()=>k(O,null,{default:()=>k(_t)})},{label:a("actions.delete"),key:"delete",icon:()=>k(O,null,{default:()=>k(Ke)})}]),m=()=>i.service.activeFlag==="Y"?a("status.Y"):a("status.N"),w=y=>{switch(y){case"HTTP":return"success";case"HTTPS":return"warning";case"TCP":return"info";case"UDP":return"default";case"GRPC":return"error";default:return"default"}},P=y=>y.length>8?y.substring(0,8)+"...":y,T=y=>({ROUND_ROBIN:a("roundRobin"),WEIGHTED_ROUND_ROBIN:a("weightedRoundRobin"),LEAST_CONNECTIONS:a("leastConnections"),RANDOM:a("random"),IP_HASH:a("ipHash")})[y]||y,h=()=>i.service.instances&&Array.isArray(i.service.instances)?i.service.instances.length:i.service.instanceCount||0,U=y=>{y==="edit"?f("edit",i.service):y==="delete"?f("delete",i.service):y==="viewEvents"&&f("viewEvents",i.service)};return(y,N)=>(x(),V(e(W),{class:"service-card",hoverable:"",bordered:!0,onClick:N[1]||(N[1]=v=>y.$emit("viewDetail",y.service))},{default:l(()=>[d("div",Ua,[d("div",Aa,[d("div",Oa,[d("div",Fa,[t(e(se),{class:"service-name",depth:1},{default:l(()=>[b(p(y.service.serviceName),1)]),_:1}),t(e(B),{size:"small",type:y.service.activeFlag==="Y"?"success":"error",round:""},{default:l(()=>[b(p(m()),1)]),_:1},8,["type"])]),d("div",{class:"actions-menu",onClick:N[0]||(N[0]=Kt(()=>{},["stop"]))},[t(e(Bt),{options:g.value,trigger:"click",placement:"bottom-end",onSelect:U},{default:l(()=>[t(e(z),{quaternary:"",circle:"",size:"small"},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ba))]),_:1})]),_:1})]),_:1},8,["options"])])]),d("div",Ha,[t(e(B),{size:"tiny",type:w(y.service.protocolType)},{default:l(()=>[b(p(y.service.protocolType),1)]),_:1},8,["type"]),t(e(pe),{trigger:"hover",placement:"bottom"},{trigger:l(()=>[d("div",Ga,[t(e(O),{size:"14",color:"var(--text-color-3)"},{default:l(()=>[t(e(Fe))]),_:1}),d("span",La,p(y.service.groupName),1),y.service.serviceGroupId?(x(),q("span",za,"("+p(P(y.service.serviceGroupId))+")",1)):Z("",!0)])]),default:l(()=>[b(" "+p(e(a)("serviceGroup"))+": "+p(y.service.groupName),1)]),_:1}),y.service.tenantId&&y.service.tenantId!=="default"?(x(),q("div",$a,[t(e(pe),{trigger:"hover",placement:"bottom"},{trigger:l(()=>[d("div",Ma,[t(e(O),{size:"14",color:"var(--text-color-3)"},{default:l(()=>[t(e(qt))]),_:1}),d("span",Va,p(y.service.tenantId),1)])]),default:l(()=>[b(" "+p(e(a)("namespace"))+": "+p(y.service.tenantId),1)]),_:1})])):Z("",!0)])]),y.service.serviceDescription?(x(),q("div",Ka,[t(e(ea),{"line-clamp":2,tooltip:{width:250}},{default:l(()=>[b(p(y.service.serviceDescription),1)]),_:1})])):Z("",!0),d("div",Ba,[d("div",qa,[t(e(O),{size:"18",color:"var(--info-color)"},{default:l(()=>[t(e(Je))]),_:1}),d("span",Ja,p(h())+" "+p(e(a)("instanceCount")),1)])]),d("div",Ya,[t(e(pe),{trigger:"hover"},{trigger:l(()=>[d("div",Wa,[t(e(O),{size:"14"},{default:l(()=>[t(e(qe))]),_:1}),d("span",ja,p(T(y.service.loadBalanceStrategy)),1)])]),default:l(()=>[b(" "+p(e(a)("loadBalanceStrategy")),1)]),_:1}),t(e(pe),{trigger:"hover"},{trigger:l(()=>[d("div",Za,[t(e(O),{size:"14"},{default:l(()=>[t(e(Ie))]),_:1}),t(e(ve),{class:"footer-text",time:new Date(y.service.editTime),type:"relative"},null,8,["time"])])]),default:l(()=>[b(" "+p(e(a)("lastUpdated")),1)]),_:1})])])]),_:1}))}}),Xa=fe(Qa,[["__scopeId","data-v-a1d6250e"]]),el=(n,u)=>[{title:n("columns.serviceInstanceId"),key:"serviceInstanceId",width:280,ellipsis:{tooltip:!0},render:i=>k("span",{style:{fontFamily:"monospace",fontSize:"13px"}},i.serviceInstanceId)},{title:n("columns.hostAddress"),key:"hostAddress",width:140,render:i=>k("span",{style:{fontFamily:"monospace"}},i.hostAddress)},{title:n("columns.portNumber"),key:"portNumber",width:80,align:"center",render:i=>k("span",{style:{fontFamily:"monospace",fontWeight:"bold"}},i.portNumber.toString())},{title:n("columns.instanceStatus"),key:"instanceStatus",width:100,align:"center",render:i=>{const f=tl(i.instanceStatus);return k(B,{type:f.type,size:"small",class:`status-${i.instanceStatus.toLowerCase()}`},{default:()=>n(`status.${i.instanceStatus}`),icon:()=>k(O,{size:14,component:f.icon})})}},{title:n("columns.healthStatus"),key:"healthStatus",width:100,align:"center",render:i=>{const f=al(i.healthStatus);return k(B,{type:f.type,size:"small",class:`health-${i.healthStatus.toLowerCase()}`},{default:()=>n(`status.${i.healthStatus}`),icon:()=>k(O,{size:14,component:f.icon})})}},{title:n("columns.weightValue"),key:"weightValue",width:80,align:"center",render:i=>k("span",{style:{fontWeight:"600"}},i.weightValue.toString())},{title:n("columns.clientType"),key:"clientType",width:100,align:"center",render:i=>k(B,{type:"info",size:"small"},{default:()=>i.clientType})},{title:n("columns.tempInstanceFlag"),key:"tempInstanceFlag",width:100,align:"center",render:i=>{const f=i.tempInstanceFlag==="Y";return k(B,{type:f?"warning":"success",size:"small"},{default:()=>n(f?"status.temporary":"status.permanent")})}},{title:n("columns.contextPath"),key:"contextPath",width:120,ellipsis:{tooltip:!0},render:i=>k("span",{style:{fontFamily:"monospace"}},i.contextPath||"/")},{title:n("columns.registerTime"),key:"registerTime",width:160,render:i=>k(ve,{time:new Date(i.registerTime)})},{title:n("columns.lastHeartbeatTime"),key:"lastHeartbeatTime",width:160,render:i=>i.lastHeartbeatTime?k(ve,{time:new Date(i.lastHeartbeatTime)}):k("span",{style:{color:"var(--text-color-3)"}},n("table.heartbeatTimeout"))},{title:n("columns.lastHealthCheckTime"),key:"lastHealthCheckTime",width:160,render:i=>i.lastHealthCheckTime?k(ve,{time:new Date(i.lastHealthCheckTime)}):k("span",{style:{color:"var(--text-color-3)"}},n("table.noHealthCheck"))},{title:n("columns.actions"),key:"actions",width:180,align:"center",fixed:"right",render:i=>k(ht,{size:"small"},{default:()=>[k(pe,{trigger:"hover"},{trigger:()=>k(z,{size:"small",type:"primary",quaternary:!0,onClick:()=>u==null?void 0:u("health-check",i)},{icon:()=>k(O,{component:ra})}),default:()=>n("actions.healthCheck")}),i.instanceStatus==="DOWN"?k(pe,{trigger:"hover"},{trigger:()=>k(z,{size:"small",type:"success",quaternary:!0,onClick:()=>u==null?void 0:u("up",i)},{icon:()=>k(O,{component:ya})}),default:()=>n("actions.bringUp")}):null,i.instanceStatus==="UP"?k(pe,{trigger:"hover"},{trigger:()=>k(z,{size:"small",type:"error",quaternary:!0,onClick:()=>u==null?void 0:u("down",i)},{icon:()=>k(O,{component:ma})}),default:()=>n("actions.takeDown")}):null].filter(Boolean)})}],tl=n=>{switch(n){case"UP":return{type:"success",text:"UP",icon:Qe};case"DOWN":return{type:"error",text:"DOWN",icon:Be};case"STARTING":return{type:"warning",text:"STARTING",icon:Ie};case"OUT_OF_SERVICE":return{type:"default",text:"OUT_OF_SERVICE",icon:Be};default:return{type:"default",text:n,icon:Ie}}},al=n=>{switch(n){case"HEALTHY":return{type:"success",text:"HEALTHY",icon:Qe};case"UNHEALTHY":return{type:"error",text:"UNHEALTHY",icon:Be};case"UNKNOWN":return{type:"default",text:"UNKNOWN",icon:Ie};default:return{type:"default",text:n,icon:Ie}}},ll={class:"service-info-section"},sl={class:"section-title"},rl={class:"instances-section"},nl={class:"section-header"},ol={class:"section-title"},il={class:"health-check-section"},cl={class:"section-title"},ul=re({__name:"ServiceDetailDrawer",props:{show:{type:Boolean},serviceName:{}},emits:["update:show"],setup(n,{emit:u}){const i=n,f=u,{t:a}=ue("hub0041"),g=M({get:()=>i.show,set:A=>f("update:show",A)}),{serviceDetail:m,loading:w,instancesLoading:P,fetchServiceDetail:T,refreshServiceInstances:h,performHealthCheck:U,updateInstanceStatus:y}=xa(),v=el(a,async(A,I)=>{if(i.serviceName)switch(A){case"health-check":await U(i.serviceName,I.serviceInstanceId);break;case"up":await y(i.serviceName,I,"UP");break;case"down":await y(i.serviceName,I,"DOWN");break}}),C=F(!1);Ne([()=>i.serviceName,()=>i.show],async([A,I])=>{if(A&&I&&!C.value)try{C.value=!0,await T(A),m.value&&await h(A)}finally{C.value=!1}},{immediate:!0});const R=async()=>{i.serviceName&&await h(i.serviceName)},r=A=>{switch(A){case"HTTP":return"success";case"HTTPS":return"warning";case"TCP":return"info";case"UDP":return"default";case"GRPC":return"error";default:return"default"}},_=A=>({ROUND_ROBIN:a("hub0041.roundRobin"),WEIGHTED_ROUND_ROBIN:a("hub0041.weightedRoundRobin"),LEAST_CONNECTIONS:a("hub0041.leastConnections"),RANDOM:a("hub0041.random"),IP_HASH:a("hub0041.ipHash")})[A]||A,S=A=>({ACTIVE:a("healthCheckModes.active"),PASSIVE:a("healthCheckModes.passive")})[A]||A,G=A=>({INTERNAL:a("registryTypes.INTERNAL"),NACOS:a("registryTypes.NACOS"),CONSUL:a("registryTypes.CONSUL"),EUREKA:a("registryTypes.EUREKA"),ETCD:a("registryTypes.ETCD"),ZOOKEEPER:a("registryTypes.ZOOKEEPER")})[A]||A;return(A,I)=>(x(),V(e(Ye),{show:g.value,"onUpdate:show":I[0]||(I[0]=L=>g.value=L),width:900,placement:"right",closable:!0},{default:l(()=>[t(e(ft),{title:e(a)("serviceDetail"),closable:""},{default:l(()=>[e(m)?(x(),q(He,{key:0},[d("div",ll,[d("h3",sl,p(e(a)("basicInfo")),1),t(e(Me),{column:2,"label-placement":"left",bordered:""},{default:l(()=>[t(e(ee),{label:e(a)("serviceName")},{default:l(()=>[b(p(e(m).serviceName),1)]),_:1},8,["label"]),t(e(ee),{label:e(a)("columns.groupName")},{default:l(()=>[b(p(e(m).groupName),1)]),_:1},8,["label"]),t(e(ee),{label:e(a)("columns.protocolType")},{default:l(()=>[t(e(B),{type:r(e(m).protocolType)},{default:l(()=>[b(p(e(m).protocolType),1)]),_:1},8,["type"])]),_:1},8,["label"]),t(e(ee),{label:e(a)("columns.loadBalanceStrategy")},{default:l(()=>[t(e(B),{type:"info"},{default:l(()=>[b(p(_(e(m).loadBalanceStrategy)),1)]),_:1})]),_:1},8,["label"]),t(e(ee),{label:e(a)("columns.contextPath")},{default:l(()=>[b(p(e(m).contextPath||"/"),1)]),_:1},8,["label"]),t(e(ee),{label:e(a)("healthCheckUrl")},{default:l(()=>[b(p(e(m).healthCheckUrl),1)]),_:1},8,["label"]),t(e(ee),{label:e(a)("columns.registryType")},{default:l(()=>[t(e(B),{type:"primary"},{default:l(()=>[b(p(G(e(m).registryType)),1)]),_:1})]),_:1},8,["label"])]),_:1}),t(e(Me),{column:1,"label-placement":"left",bordered:"",style:{"margin-top":"16px"}},{default:l(()=>[t(e(ee),{label:e(a)("serviceDescription")},{default:l(()=>[b(p(e(m).serviceDescription||e(a)("noDescription")),1)]),_:1},8,["label"])]),_:1})]),d("div",rl,[d("div",nl,[d("h3",ol,p(e(a)("instanceList")),1),t(e(z),{size:"small",onClick:R,loading:e(P)},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ke))]),_:1})]),default:l(()=>[b(" "+p(e(a)("actions.refresh")),1)]),_:1},8,["loading"])]),t(e(Ze),{columns:e(v),data:e(m).instances,loading:e(P),pagination:!1,size:"small",style:{width:"100%","overflow-x":"auto"},title:e(a)("instanceList"),"scroll-x":1800},null,8,["columns","data","loading","title"])]),d("div",il,[d("h3",cl,p(e(a)("healthCheckConfig")),1),t(e(Me),{column:3,"label-placement":"left",bordered:""},{default:l(()=>[t(e(ee),{label:e(a)("healthCheckInterval")},{default:l(()=>[b(p(e(m).healthCheckIntervalSeconds)+"s ",1)]),_:1},8,["label"]),t(e(ee),{label:e(a)("healthCheckTimeout")},{default:l(()=>[b(p(e(m).healthCheckTimeoutSeconds)+"s ",1)]),_:1},8,["label"]),t(e(ee),{label:e(a)("healthCheckType")},{default:l(()=>[t(e(B),{type:"info"},{default:l(()=>[b(p(e(m).healthCheckType),1)]),_:1})]),_:1},8,["label"]),t(e(ee),{label:e(a)("healthCheckMode")},{default:l(()=>[t(e(B),{type:"success"},{default:l(()=>[b(p(S(e(m).healthCheckMode)),1)]),_:1})]),_:1},8,["label"]),t(e(ee),{label:e(a)("lastUpdateTime")},{default:l(()=>[t(e(ve),{time:new Date(e(m).editTime)},null,8,["time"])]),_:1},8,["label"])]),_:1})])],64)):e(w)?(x(),V(e(we),{key:1,size:"large",style:{width:"100%",padding:"60px 0"}})):(x(),V(e(Ge),{key:2,description:e(a)("serviceNotFound")},null,8,["description"]))]),_:1},8,["title"])]),_:1},8,["show"]))}}),dl=fe(ul,[["__scopeId","data-v-82cf8a54"]]),pl={class:"dialog-content"},vl={class:"search-section"},hl={class:"group-list"},fl={key:1,class:"group-items"},ml=["onClick"],gl={class:"group-header"},yl={class:"group-name"},_l={class:"group-description"},bl=re({__name:"ServiceGroupSelectionDialog",props:{show:{type:Boolean},selectedGroupId:{default:""}},emits:["update:show","confirm"],setup(n,{emit:u}){const i=n,f=u,{t:a}=ue("hub0041"),g=he(),m=M({get:()=>i.show,set:I=>f("update:show",I)}),w=F(!1),P=F([]),T=F(null),h=F(""),U=F(""),y=[{label:a("groupType.BUSINESS"),value:"BUSINESS"},{label:a("groupType.SYSTEM"),value:"SYSTEM"},{label:a("groupType.TEST"),value:"TEST"}],N=M(()=>{let I=P.value;if(h.value.trim()){const L=h.value.toLowerCase();I=I.filter($=>{var ne;return $.groupName.toLowerCase().includes(L)||((ne=$.groupDescription)==null?void 0:ne.toLowerCase().includes(L))})}return U.value&&(I=I.filter(L=>L.groupType===U.value)),I=I.filter(L=>L.activeFlag==="Y"),I});Ne(()=>i.selectedGroupId,I=>{I&&P.value.length>0?T.value=P.value.find(L=>L.serviceGroupId===I)||null:T.value=null},{immediate:!0}),Ne(()=>i.show,I=>{I&&R()});const v=I=>{switch(I){case"BUSINESS":return"success";case"SYSTEM":return"warning";case"TEST":return"info";default:return"default"}},C=I=>a(`groupType.${I}`)||I,R=async()=>{try{w.value=!0;const I=await Nt();if(I.oK){let L={};try{L=typeof I.bizData=="string"?JSON.parse(I.bizData):I.bizData,P.value=L||[],i.selectedGroupId&&(T.value=P.value.find($=>$.serviceGroupId===i.selectedGroupId)||null)}catch($){console.error("Failed to parse service groups data:",$),P.value=[]}}else g.error(a("fetchServiceGroupsFailed")),P.value=[]}catch(I){console.error("Failed to fetch service groups:",I),g.error(a("fetchServiceGroupsFailed")),P.value=[]}finally{w.value=!1}},r=()=>{},_=()=>{R()},S=I=>{T.value=I},G=()=>{T.value&&(f("confirm",T.value),m.value=!1)},A=()=>{m.value=!1};return Le(()=>{i.show&&R()}),(I,L)=>(x(),V(e(Wt),{show:m.value,"onUpdate:show":L[2]||(L[2]=$=>m.value=$),class:"service-group-selection-dialog","mask-closable":!1,preset:"dialog",title:e(a)("selectServiceGroup"),style:{width:"800px"}},{action:l(()=>[t(e(ce),null,{default:l(()=>[t(e(z),{onClick:A},{default:l(()=>[b(p(e(a)("cancel")),1)]),_:1}),t(e(z),{type:"primary",onClick:G,disabled:!T.value},{default:l(()=>[b(p(e(a)("actions.confirm")),1)]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[d("div",pl,[d("div",vl,[t(e(ce),{size:12},{default:l(()=>[t(e(H),{value:h.value,"onUpdate:value":L[0]||(L[0]=$=>h.value=$),placeholder:e(a)("searchGroupName"),clearable:"",style:{width:"240px"},onInput:r},{prefix:l(()=>[t(e(O),null,{default:l(()=>[t(e(We))]),_:1})]),_:1},8,["value","placeholder"]),t(e(j),{value:U.value,"onUpdate:value":[L[1]||(L[1]=$=>U.value=$),r],placeholder:e(a)("selectGroupType"),options:y,clearable:"",style:{width:"140px"}},null,8,["value","placeholder"]),t(e(z),{onClick:_,loading:w.value},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ke))]),_:1})]),default:l(()=>[b(" "+p(e(a)("actions.refresh")),1)]),_:1},8,["loading"])]),_:1})]),d("div",hl,[t(e(we),{show:w.value},{default:l(()=>[t(e(Jt),{style:{"max-height":"400px"}},{default:l(()=>[N.value.length===0&&!w.value?(x(),V(e(Ge),{key:0,description:e(a)("noServiceGroups")},null,8,["description"])):(x(),q("div",fl,[(x(!0),q(He,null,je(N.value,$=>{var ne,_e;return x(),q("div",{key:$.serviceGroupId,class:Yt(["group-item",{selected:((ne=T.value)==null?void 0:ne.serviceGroupId)===$.serviceGroupId}]),onClick:be=>S($)},[d("div",gl,[d("div",yl,[((_e=T.value)==null?void 0:_e.serviceGroupId)===$.serviceGroupId?(x(),V(e(O),{key:0,color:"#18a058",size:"18",style:{"margin-right":"8px"}},{default:l(()=>[t(e(Qe))]),_:1})):Z("",!0),t(e(se),{strong:""},{default:l(()=>[b(p($.groupName),1)]),_:2},1024),t(e(B),{type:v($.groupType),size:"small",style:{"margin-left":"8px"}},{default:l(()=>[b(p(C($.groupType)),1)]),_:2},1032,["type"])]),t(e(B),{type:$.activeFlag==="Y"?"success":"error",size:"small"},{default:l(()=>[b(p($.activeFlag==="Y"?e(a)("status.Y"):e(a)("status.N")),1)]),_:2},1032,["type"])]),d("div",_l,[t(e(se),{depth:"3"},{default:l(()=>[b(p($.groupDescription||e(a)("noDescription")),1)]),_:2},1024)])],10,ml)}),128))]))]),_:1})]),_:1},8,["show"])])])]),_:1},8,["show","title"]))}}),Sl=fe(bl,[["__scopeId","data-v-75a4050c"]]),Cl={class:"service-form-page"},Tl={class:"page-header"},El={class:"header-actions"},Nl={key:0,style:{border:"none",padding:"0",margin:"0"}},Il={style:{"margin-bottom":"16px"}},wl={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},kl={style:{"margin-bottom":"16px"}},Dl={style:{"margin-bottom":"16px"}},Pl={class:"instance-header"},Rl={class:"instance-header-left"},xl={class:"instance-header-actions"},Ul={class:"instance-table",style:{"margin-top":"16px"}},Al={style:{"margin-top":"24px",display:"flex","justify-content":"center",gap:"12px"}},Ol={class:"form-actions"},Fl=re({__name:"ServiceFormPage",props:{editData:{default:null}},emits:["back","success"],setup(n,{emit:u}){const i=n,f=u,{t:a}=ue("hub0041"),g=he(),m=F(),w=M(()=>!!i.editData),P=F(!1),T=F(!1),h=F([]),U=F(!1),y=M(()=>{if(!r.serviceGroupId)return"";const c=h.value.find(s=>s.serviceGroupId===r.serviceGroupId);return c?c.groupName:""}),N=F(!1),v=M(()=>r.registryType!=="NACOS"),C=M(()=>r.registryType!=="NACOS"),R=M(()=>r.registryType==="NACOS"),r=Ae({serviceName:"",serviceGroupId:"",groupName:"",serviceDescription:"",registryType:"INTERNAL",protocolType:"HTTP",contextPath:"/",loadBalanceStrategy:"ROUND_ROBIN",healthCheckUrl:"/health",healthCheckIntervalSeconds:30,healthCheckTimeoutSeconds:5,healthCheckType:"HTTP",healthCheckMode:"ACTIVE",activeFlag:"Y",maxInstances:10,nacosConfig:{servers:[{host:"",port:8848,grpcPort:void 0,contextPath:"/nacos",scheme:"http"}],namespace:"public",group:"DEFAULT_GROUP",username:"",password:"",accessKey:"",secretKey:"",timeout:5,beatInterval:5,cacheDir:"",logDir:"",logLevel:"info",updateThreadNum:20,notLoadCacheAtStart:!0,disableUseSnapShot:!1,updateCacheWhenEmpty:!1,appendToStdout:!1,enableTLS:!1,trustAll:!1,caFile:"",certFile:"",keyFile:"",appName:"",appKey:"",openKMS:!1,regionId:""},instances:[],metadataJson:"",tagsJson:"",noteText:"",extProperty:"",reserved1:"",reserved2:"",reserved3:"",reserved4:"",reserved5:"",reserved6:"",reserved7:"",reserved8:"",reserved9:"",reserved10:""}),_=M(()=>[{label:a("registryTypes.INTERNAL"),value:"INTERNAL"},{label:a("registryTypes.NACOS"),value:"NACOS"},{label:a("registryTypes.CONSUL"),value:"CONSUL"},{label:a("registryTypes.EUREKA"),value:"EUREKA"},{label:a("registryTypes.ETCD"),value:"ETCD"},{label:a("registryTypes.ZOOKEEPER"),value:"ZOOKEEPER"}]),S=[{label:"HTTP",value:"HTTP"},{label:"HTTPS",value:"HTTPS"},{label:"TCP",value:"TCP"},{label:"UDP",value:"UDP"},{label:"GRPC",value:"GRPC"}],G=[{label:"HTTP",value:"HTTP"},{label:"TCP",value:"TCP"}],A=M(()=>[{label:a("healthCheckModes.active"),value:"ACTIVE"},{label:a("healthCheckModes.passive"),value:"PASSIVE"}]),I=M(()=>[{label:a("roundRobin"),value:"ROUND_ROBIN"},{label:a("weightedRoundRobin"),value:"WEIGHTED_ROUND_ROBIN"},{label:a("leastConnections"),value:"LEAST_CONNECTIONS"},{label:a("random"),value:"RANDOM"},{label:a("ipHash"),value:"IP_HASH"}]),L=M(()=>({serviceName:[{required:!0,message:a("serviceNameRequired"),trigger:"blur"},{min:2,max:50,message:a("serviceNameLength"),trigger:"blur"}],serviceGroupId:[{required:!0,message:a("serviceGroupRequired"),trigger:"change"}],groupName:[],registryType:[{required:!0,message:a("registryTypeRequired"),trigger:"change"}],serviceDescription:[{max:200,message:a("serviceDescriptionLength"),trigger:"blur"}],protocolType:[{required:!0,message:a("protocolTypeRequired"),trigger:"change"}],contextPath:[{required:!0,message:a("contextPathRequired"),trigger:"blur"}],loadBalanceStrategy:[{required:!0,message:a("loadBalanceStrategyRequired"),trigger:"change"}],healthCheckUrl:[{validator:(c,s)=>v.value&&!s?new Error(a("healthCheckUrlRequired")):!0,trigger:"blur"}],healthCheckIntervalSeconds:[{validator:(c,s)=>v.value&&!s?new Error(a("healthCheckIntervalRequired")):!0,trigger:"blur"}],healthCheckTimeoutSeconds:[{validator:(c,s)=>v.value&&!s?new Error(a("healthCheckTimeoutRequired")):!0,trigger:"blur"}],healthCheckType:[{validator:(c,s)=>v.value&&!s?new Error(a("healthCheckTypeRequired")):!0,trigger:"change"}],healthCheckMode:[{validator:(c,s)=>v.value&&!s?new Error(a("healthCheckModeRequired")):!0,trigger:"change"}],activeFlag:[{required:!0,message:a("activeFlagRequired"),trigger:"change"}],maxInstances:[{required:!0,type:"number",message:a("maxInstancesRequired"),trigger:"blur"}],metadataJson:[{validator:(c,s)=>{if(s&&s.trim())try{return JSON.parse(s),!0}catch{return new Error(a("invalidJsonFormat"))}return!0},trigger:"blur"}],tagsJson:[{validator:(c,s)=>{if(s&&s.trim())try{return JSON.parse(s),!0}catch{return new Error(a("invalidJsonFormat"))}return!0},trigger:"blur"}],noteText:[{max:500,message:a("noteTextLength"),trigger:"blur"}],extProperty:[{validator:(c,s)=>{if(s&&s.trim())try{return JSON.parse(s),!0}catch{return new Error(a("invalidJsonFormat"))}return!0},trigger:"blur"}],"nacosConfig.namespace":[{validator:(c,s)=>R.value&&!s?new Error("请输入命名空间"):!0,trigger:"blur"}],"nacosConfig.group":[{validator:(c,s)=>R.value&&!s?new Error("请输入默认分组"):!0,trigger:"blur"}]})),$=async c=>{if(c)try{P.value=!0;const s=await Xe({serviceName:c,pageIndex:1,pageSize:1e3});if(s.oK){const o=vt(s.bizData);r.instances=o,g.success(a("loadInstancesSuccess"))}else g.error(s.errMsg||a("loadInstancesFailed"))}catch(s){console.error("Failed to load instances:",s),g.error(a("loadInstancesFailed"))}finally{P.value=!1}},ne=c=>{c?(Object.assign(r,{serviceName:c.serviceName||"",serviceGroupId:c.serviceGroupId||"",groupName:c.groupName||"",serviceDescription:c.serviceDescription||"",registryType:c.registryType||"INTERNAL",protocolType:c.protocolType||"HTTP",contextPath:c.contextPath||"/",loadBalanceStrategy:c.loadBalanceStrategy||"ROUND_ROBIN",healthCheckUrl:c.healthCheckUrl||"/health",healthCheckIntervalSeconds:c.healthCheckIntervalSeconds||30,healthCheckTimeoutSeconds:c.healthCheckTimeoutSeconds||5,healthCheckType:c.healthCheckType||"HTTP",healthCheckMode:c.healthCheckMode||"ACTIVE",activeFlag:c.activeFlag||"Y",maxInstances:10,nacosConfig:(()=>{if(c.externalRegistryConfig&&c.registryType==="NACOS")try{const s=JSON.parse(c.externalRegistryConfig);return{servers:s.servers||[{host:"",port:8848,grpcPort:void 0,contextPath:"/nacos",scheme:"http"}],namespace:s.namespace||"public",group:s.group||"DEFAULT_GROUP",username:s.username||"",password:s.password||"",accessKey:s.accessKey||"",secretKey:s.secretKey||"",timeout:s.timeout||5,beatInterval:s.beatInterval||5,cacheDir:s.cacheDir||"",logDir:s.logDir||"",logLevel:s.logLevel||"info",updateThreadNum:s.updateThreadNum||20,notLoadCacheAtStart:s.notLoadCacheAtStart??!0,disableUseSnapShot:s.disableUseSnapShot??!1,updateCacheWhenEmpty:s.updateCacheWhenEmpty??!1,appendToStdout:s.appendToStdout??!1,enableTLS:s.enableTLS??!1,trustAll:s.trustAll??!1,caFile:s.caFile||"",certFile:s.certFile||"",keyFile:s.keyFile||"",appName:s.appName||"",appKey:s.appKey||"",openKMS:s.openKMS??!1,regionId:s.regionId||""}}catch{return{servers:[{host:"",port:8848,grpcPort:void 0,contextPath:"/nacos",scheme:"http"}],namespace:"public",group:"DEFAULT_GROUP",username:"",password:"",accessKey:"",secretKey:"",timeout:5,beatInterval:5,cacheDir:"",logDir:"",logLevel:"info",updateThreadNum:20,notLoadCacheAtStart:!0,disableUseSnapShot:!1,updateCacheWhenEmpty:!1,appendToStdout:!1,enableTLS:!1,trustAll:!1,caFile:"",certFile:"",keyFile:"",appName:"",appKey:"",openKMS:!1,regionId:""}}return{servers:[{host:"",port:8848,grpcPort:void 0,contextPath:"/nacos",scheme:"http"}],namespace:"public",group:"DEFAULT_GROUP",username:"",password:"",accessKey:"",secretKey:"",timeout:5,beatInterval:5,cacheDir:"",logDir:"",logLevel:"info",updateThreadNum:20,notLoadCacheAtStart:!0,disableUseSnapShot:!1,updateCacheWhenEmpty:!1,appendToStdout:!1,enableTLS:!1,trustAll:!1,caFile:"",certFile:"",keyFile:"",appName:"",appKey:"",openKMS:!1,regionId:""}})(),instances:[],metadataJson:c.metadataJson||"",tagsJson:c.tagsJson||"",noteText:c.noteText||"",extProperty:c.extProperty||"",reserved1:c.reserved1||"",reserved2:c.reserved2||"",reserved3:c.reserved3||"",reserved4:c.reserved4||"",reserved5:c.reserved5||"",reserved6:c.reserved6||"",reserved7:c.reserved7||"",reserved8:c.reserved8||"",reserved9:c.reserved9||"",reserved10:c.reserved10||""}),(c.metadataJson||c.tagsJson||c.noteText||c.extProperty||c.reserved1||c.reserved2||c.reserved3||c.reserved4||c.reserved5||c.reserved6||c.reserved7||c.reserved8||c.reserved9||c.reserved10)&&(N.value=!0),w.value&&c.serviceName&&$(c.serviceName)):be()};Ne(()=>i.editData,c=>{ne(c)}),Le(()=>{_e(),ne(i.editData)});const _e=async()=>{try{const c=await Nt();if(c.oK){let s={};try{s=typeof c.bizData=="string"?JSON.parse(c.bizData):c.bizData,h.value=s||[]}catch(o){console.error("Failed to parse service groups data:",o),h.value=[]}}else g.error(a("fetchServiceGroupsFailed")),h.value=[]}catch(c){console.error("Failed to fetch service groups:",c),g.error(a("fetchServiceGroupsFailed")),h.value=[]}},be=()=>{var c;(c=m.value)==null||c.restoreValidation(),w.value||(Object.assign(r,{serviceName:"",serviceGroupId:"",groupName:"",serviceDescription:"",registryType:"INTERNAL",protocolType:"HTTP",contextPath:"/",loadBalanceStrategy:"ROUND_ROBIN",healthCheckUrl:"/health",healthCheckIntervalSeconds:30,healthCheckTimeoutSeconds:5,healthCheckType:"HTTP",healthCheckMode:"ACTIVE",activeFlag:"Y",maxInstances:10,nacosConfig:{servers:[{host:"",port:8848,grpcPort:void 0,contextPath:"/nacos",scheme:"http"}],namespace:"public",group:"DEFAULT_GROUP",username:"",password:"",accessKey:"",secretKey:"",timeout:5,beatInterval:5,cacheDir:"",logDir:"",logLevel:"info",updateThreadNum:20,notLoadCacheAtStart:!0,disableUseSnapShot:!1,updateCacheWhenEmpty:!1,appendToStdout:!1,enableTLS:!1,trustAll:!1,caFile:"",certFile:"",keyFile:"",appName:"",appKey:"",openKMS:!1,regionId:""},instances:[],metadataJson:"",tagsJson:"",noteText:"",extProperty:"",reserved1:"",reserved2:"",reserved3:"",reserved4:"",reserved5:"",reserved6:"",reserved7:"",reserved8:"",reserved9:"",reserved10:""}),N.value=!1)},De=()=>{U.value=!0},ze=c=>{r.serviceGroupId=c.serviceGroupId,r.groupName=c.groupName},te=()=>{r.nacosConfig.servers.push({host:"",port:8848,grpcPort:void 0,contextPath:"/nacos",scheme:"http"})},ae=c=>{r.nacosConfig.servers.length>1&&r.nacosConfig.servers.splice(c,1)},J=()=>{f("back")},kt=async()=>{var c;try{await((c=m.value)==null?void 0:c.validate()),T.value=!0;const{maxInstances:s,nacosConfig:o,...oe}=r;let X;r.registryType==="NACOS"&&(X=JSON.stringify(r.nacosConfig));const at={...oe,externalRegistryConfig:X,instances:r.instances.map($e=>({...$e,serviceName:r.serviceName}))};let Ce;if(w.value?Ce=await Ta(at):Ce=await Ca(at),Ce.oK)g.success(w.value?a("updateServiceSuccess"):a("addServiceSuccess")),f("success"),f("back");else{const $e=Ce.popMsg||Ce.errMsg||(w.value?a("updateServiceFailed"):a("addServiceFailed"));g.error($e)}}catch(s){console.error("Failed to submit service:",s),g.error(w.value?a("updateServiceFailed"):a("addServiceFailed"))}finally{T.value=!1}},et=F(),de=F(!1),Pe=F(!1),Se=F(-1),K=Ae({serviceInstanceId:"",hostAddress:"",portNumber:8080,contextPath:"/",instanceStatus:"UP",healthStatus:"HEALTHY",weightValue:1,clientType:"OTHER",tempInstanceFlag:"N"}),Dt=M(()=>[{label:a("status.UP"),value:"UP"},{label:a("status.DOWN"),value:"DOWN"},{label:a("status.STARTING"),value:"STARTING"},{label:a("status.OUT_OF_SERVICE"),value:"OUT_OF_SERVICE"}]),Pt=M(()=>[{label:a("status.HEALTHY"),value:"HEALTHY"},{label:a("status.UNHEALTHY"),value:"UNHEALTHY"},{label:a("status.UNKNOWN"),value:"UNKNOWN"}]),Rt=M(()=>[{label:a("status.JAVA"),value:"JAVA"},{label:a("status.DOTNET"),value:"DOTNET"},{label:a("status.NODEJS"),value:"NODEJS"},{label:a("status.PYTHON"),value:"PYTHON"},{label:a("status.GO"),value:"GO"},{label:a("status.OTHER"),value:"OTHER"}]),xt={hostAddress:[{required:!0,message:a("instanceHostRequired"),trigger:"blur"}],portNumber:[{required:!0,type:"number",message:a("instancePortRequired"),trigger:"blur"}],instanceStatus:[{required:!0,message:a("instanceStatusRequired"),trigger:"change"}],healthStatus:[{required:!0,message:a("healthStatusRequired"),trigger:"change"}],weightValue:[{required:!0,type:"number",message:a("weightRequired"),trigger:"blur"}]},Ut=M(()=>[{title:a("columns.hostAddress"),key:"hostAddress"},{title:a("columns.portNumber"),key:"portNumber"},{title:a("columns.weightValue"),key:"weightValue",width:80,align:"center",render:c=>{var s;return k("span",{style:{fontWeight:"600"}},((s=c.weightValue)==null?void 0:s.toString())||"1")}},{title:a("columns.instanceStatus"),key:"instanceStatus",render:c=>{const s=c.instanceStatus;return k(B,{type:{UP:"success",DOWN:"error",STARTING:"warning",OUT_OF_SERVICE:"default"}[s],size:"small"},{default:()=>a(`status.${s}`)})}},{title:a("columns.healthStatus"),key:"healthStatus",render:c=>{const s=c.healthStatus;return k(B,{type:{HEALTHY:"success",UNHEALTHY:"error",UNKNOWN:"default"}[s],size:"small"},{default:()=>a(`status.${s}`)})}},{title:a("columns.tempInstanceFlag"),key:"tempInstanceFlag",render:c=>{const s=c.tempInstanceFlag==="Y";return k(B,{type:s?"warning":"success",size:"small"},{default:()=>a(s?"status.temporary":"status.permanent")})}},{title:a("columns.actions"),key:"actions",width:100,align:"center",fixed:"right",render:(c,s)=>k(ht,{size:"small"},{default:()=>[k(z,{size:"small",type:"info",quaternary:!0,onClick:()=>Ot(s)},{icon:()=>k(O,{component:_t})}),k(oa,{onPositiveClick:()=>Ht(s)},{trigger:()=>k(z,{size:"small",type:"error",quaternary:!0},{icon:()=>k(O,{component:Ke})}),default:()=>a("messages.confirmDeleteInstance")})]})}]),tt=()=>{if(!w.value){g.warning(a("saveServiceBeforeAddingInstance"));return}At()},At=()=>{Pe.value=!1,Se.value=-1,Object.assign(K,{serviceInstanceId:`${r.serviceName}-${Date.now()}`,hostAddress:"",portNumber:8080,contextPath:r.contextPath||"/",instanceStatus:"UP",healthStatus:"HEALTHY",weightValue:1,clientType:"OTHER",tempInstanceFlag:"N"}),de.value=!0},Ot=c=>{Pe.value=!0,Se.value=c;const s=r.instances[c];Object.assign(K,{...s}),de.value=!0},Ft=async()=>{w.value&&r.serviceName&&await $(r.serviceName)},Ht=async c=>{const s=r.instances[c];if(w.value&&s.serviceInstanceId)try{const o=await wa(s.serviceInstanceId);o.oK?(r.instances.splice(c,1),g.success(a("deleteInstanceSuccess"))):g.error(o.errMsg||a("deleteInstanceFailed"))}catch(o){console.error("Failed to delete instance:",o),g.error(a("deleteInstanceFailed"))}else r.instances.splice(c,1),g.success(a("deleteInstanceSuccess"))},Gt=async()=>{var c;try{await((c=et.value)==null?void 0:c.validate());const s={...K,serviceName:r.serviceName,serviceGroupId:r.serviceGroupId,groupName:r.groupName,tenantId:"default",registerTime:new Date().toISOString(),lastHeartbeatTime:new Date().toISOString(),activeFlag:"Y",tempInstanceFlag:K.tempInstanceFlag||"N"};if(Pe.value&&Se.value>=0)if(w.value&&r.serviceName&&K.serviceInstanceId)try{const o=await Et(s);o.oK?(r.instances[Se.value]=s,g.success(a("updateInstanceSuccess")),de.value=!1):g.error(o.errMsg||a("updateInstanceFailed"))}catch(o){console.error("Failed to update instance:",o),g.error(a("updateInstanceFailed"))}else r.instances[Se.value]=s,g.success(a("updateInstanceSuccess")),de.value=!1;else if(w.value&&r.serviceName)try{const o=await Ia(s);o.oK?(r.instances.push(s),g.success(a("addInstanceSuccess")),de.value=!1):g.error(o.errMsg||a("addInstanceFailed"))}catch(o){console.error("Failed to create instance:",o),g.error(a("addInstanceFailed"))}else r.instances.push(s),g.success(a("addInstanceSuccess")),de.value=!1}catch(s){console.error("Instance validation error:",s)}};return(c,s)=>(x(),q("div",Cl,[d("div",Tl,[t(e(jt),null,{default:l(()=>[t(e(lt),{onClick:J},{default:l(()=>[b(p(e(a)("serviceManagement")),1)]),_:1}),t(e(lt),null,{default:l(()=>[b(p(w.value?e(a)("editService"):e(a)("addService")),1)]),_:1})]),_:1}),d("div",El,[t(e(z),{onClick:J,quaternary:""},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ct))]),_:1})]),default:l(()=>[b(" "+p(e(a)("actions.back")),1)]),_:1})])]),t(e(W),{size:"large",class:"form-card"},{default:l(()=>[t(e(Ve),{ref_key:"formRef",ref:m,model:r,rules:L.value,"label-placement":"left","label-width":140,"require-mark-placement":"left"},{default:l(()=>[t(e(W),{title:e(a)("basicInfo"),size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[t(e(Y),{cols:3,"x-gap":24,"y-gap":16},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("serviceName"),path:"serviceName"},{default:l(()=>[t(e(H),{value:r.serviceName,"onUpdate:value":s[0]||(s[0]=o=>r.serviceName=o),placeholder:e(a)("serviceNamePlaceholder"),maxlength:"50","show-count":"",disabled:w.value},null,8,["value","placeholder","disabled"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("columns.groupName"),path:"serviceGroupId"},{default:l(()=>[t(e(H),{value:y.value,placeholder:e(a)("selectServiceGroup"),readonly:"",onClick:De,style:{cursor:"pointer"}},{suffix:l(()=>[t(e(z),{text:"",onClick:De},{default:l(()=>[t(e(O),null,{default:l(()=>[t(e(na))]),_:1})]),_:1})]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("groupName"),path:"groupName"},{default:l(()=>[t(e(H),{value:r.groupName,"onUpdate:value":s[1]||(s[1]=o=>r.groupName=o),placeholder:e(a)("groupNamePlaceholder"),readonly:"",style:{"background-color":"var(--input-color-disabled)"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("columns.registryType"),path:"registryType"},{default:l(()=>[t(e(j),{value:r.registryType,"onUpdate:value":s[2]||(s[2]=o=>r.registryType=o),options:_.value,placeholder:e(a)("selectRegistryType")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("columns.activeFlag"),path:"activeFlag"},{default:l(()=>[t(e(me),{value:r.activeFlag,"onUpdate:value":s[3]||(s[3]=o=>r.activeFlag=o),"checked-value":"Y","unchecked-value":"N"},{checked:l(()=>[b(p(e(a)("status.Y")),1)]),unchecked:l(()=>[b(p(e(a)("status.N")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("maxInstances"),path:"maxInstances"},{default:l(()=>[t(e(ie),{value:r.maxInstances,"onUpdate:value":s[4]||(s[4]=o=>r.maxInstances=o),placeholder:e(a)("maxInstancesPlaceholder"),min:1,max:100,style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),t(e(E),{label:e(a)("serviceDescription"),path:"serviceDescription"},{default:l(()=>[t(e(H),{value:r.serviceDescription,"onUpdate:value":s[5]||(s[5]=o=>r.serviceDescription=o),type:"textarea",placeholder:e(a)("serviceDescriptionPlaceholder"),rows:4,maxlength:"200","show-count":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"]),t(e(W),{title:e(a)("networkConfig"),size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[t(e(Y),{cols:3,"x-gap":24,"y-gap":16},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("columns.protocolType"),path:"protocolType"},{default:l(()=>[t(e(j),{value:r.protocolType,"onUpdate:value":s[6]||(s[6]=o=>r.protocolType=o),options:S,placeholder:e(a)("selectProtocol")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("columns.contextPath"),path:"contextPath"},{default:l(()=>[t(e(H),{value:r.contextPath,"onUpdate:value":s[7]||(s[7]=o=>r.contextPath=o),placeholder:e(a)("contextPathPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("columns.loadBalanceStrategy"),path:"loadBalanceStrategy"},{default:l(()=>[t(e(j),{value:r.loadBalanceStrategy,"onUpdate:value":s[8]||(s[8]=o=>r.loadBalanceStrategy=o),options:I.value,placeholder:e(a)("selectLoadBalance")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["title"]),R.value?(x(),q("fieldset",Nl,[t(e(W),{title:e(a)("nacosConfig.title"),size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[d("div",Il,[t(e(se),{strong:"",style:{display:"block","margin-bottom":"12px"}},{default:l(()=>[b(p(e(a)("nacosConfig.serverConfig")),1)]),_:1}),(x(!0),q(He,null,je(r.nacosConfig.servers,(o,oe)=>(x(),q("div",{key:oe,style:{"margin-bottom":"16px",padding:"16px",border:"1px solid var(--border-color)","border-radius":"6px","background-color":"var(--color-embedded)"}},[d("div",wl,[t(e(se),{strong:""},{default:l(()=>[b(p(e(a)("nacosConfig.serverTitle",{number:oe+1})),1)]),_:2},1024),r.nacosConfig.servers.length>1?(x(),V(e(z),{key:0,size:"small",type:"error",quaternary:"",onClick:X=>ae(oe)},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ke))]),_:1})]),_:2},1032,["onClick"])):Z("",!0)]),t(e(Y),{cols:3,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.host"),path:`nacosConfig.servers[${oe}].host`},{default:l(()=>[t(e(H),{value:o.host,"onUpdate:value":X=>o.host=X,placeholder:e(a)("nacosConfig.hostPlaceholder")},null,8,["value","onUpdate:value","placeholder"])]),_:2},1032,["label","path"])]),_:2},1024),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.port"),path:`nacosConfig.servers[${oe}].port`},{default:l(()=>[t(e(ie),{value:o.port,"onUpdate:value":X=>o.port=X,placeholder:e(a)("nacosConfig.portPlaceholder"),min:1,max:65535,style:{width:"100%"}},null,8,["value","onUpdate:value","placeholder"])]),_:2},1032,["label","path"])]),_:2},1024),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.scheme"),path:`nacosConfig.servers[${oe}].scheme`},{default:l(()=>[t(e(j),{value:o.scheme,"onUpdate:value":X=>o.scheme=X,options:[{label:"HTTP",value:"http"},{label:"HTTPS",value:"https"}]},null,8,["value","onUpdate:value"])]),_:2},1032,["label","path"])]),_:2},1024),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.grpcPort"),path:`nacosConfig.servers[${oe}].grpcPort`},{default:l(()=>[t(e(ie),{value:o.grpcPort,"onUpdate:value":X=>o.grpcPort=X,placeholder:e(a)("nacosConfig.grpcPortPlaceholder"),min:1,max:65535,style:{width:"100%"}},null,8,["value","onUpdate:value","placeholder"])]),_:2},1032,["label","path"])]),_:2},1024),t(e(D),null,{default:l(()=>[t(e(E),{label:"上下文路径",path:`nacosConfig.servers[${oe}].contextPath`},{default:l(()=>[t(e(H),{value:o.contextPath,"onUpdate:value":X=>o.contextPath=X,placeholder:"默认: /nacos"},null,8,["value","onUpdate:value"])]),_:2},1032,["path"])]),_:2},1024)]),_:2},1024)]))),128)),t(e(z),{size:"small",type:"primary",dashed:"",onClick:te,style:{width:"100%"}},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ue))]),_:1})]),default:l(()=>[b(" "+p(e(a)("nacosConfig.addServer")),1)]),_:1})]),d("div",kl,[t(e(se),{strong:"",style:{display:"block","margin-bottom":"12px"}},{default:l(()=>[b(p(e(a)("nacosConfig.basicConfig")),1)]),_:1}),t(e(Y),{cols:3,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.namespace"),path:"nacosConfig.namespace"},{default:l(()=>[t(e(H),{value:r.nacosConfig.namespace,"onUpdate:value":s[9]||(s[9]=o=>r.nacosConfig.namespace=o),placeholder:e(a)("nacosConfig.namespacePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.group"),path:"nacosConfig.group"},{default:l(()=>[t(e(H),{value:r.nacosConfig.group,"onUpdate:value":s[10]||(s[10]=o=>r.nacosConfig.group=o),placeholder:e(a)("nacosConfig.groupPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.timeout"),path:"nacosConfig.timeout"},{default:l(()=>[t(e(ie),{value:r.nacosConfig.timeout,"onUpdate:value":s[11]||(s[11]=o=>r.nacosConfig.timeout=o),placeholder:e(a)("nacosConfig.timeoutPlaceholder"),min:1,max:60,style:{width:"100%"}},{suffix:l(()=>[b(p(e(a)("seconds")),1)]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.beatInterval"),path:"nacosConfig.beatInterval"},{default:l(()=>[t(e(ie),{value:r.nacosConfig.beatInterval,"onUpdate:value":s[12]||(s[12]=o=>r.nacosConfig.beatInterval=o),placeholder:e(a)("nacosConfig.beatIntervalPlaceholder"),min:1,max:60,style:{width:"100%"}},{suffix:l(()=>[b(p(e(a)("seconds")),1)]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),d("div",Dl,[t(e(se),{strong:"",style:{display:"block","margin-bottom":"12px"}},{default:l(()=>[b(p(e(a)("nacosConfig.authConfig")),1)]),_:1}),t(e(Y),{cols:2,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.username")},{default:l(()=>[t(e(H),{value:r.nacosConfig.username,"onUpdate:value":s[13]||(s[13]=o=>r.nacosConfig.username=o),placeholder:e(a)("nacosConfig.usernamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.password")},{default:l(()=>[t(e(H),{value:r.nacosConfig.password,"onUpdate:value":s[14]||(s[14]=o=>r.nacosConfig.password=o),placeholder:e(a)("nacosConfig.passwordPlaceholder"),"show-password-on":"click","input-props":{autocomplete:"off"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.accessKey")},{default:l(()=>[t(e(H),{value:r.nacosConfig.accessKey,"onUpdate:value":s[15]||(s[15]=o=>r.nacosConfig.accessKey=o),placeholder:e(a)("nacosConfig.accessKeyPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.secretKey")},{default:l(()=>[t(e(H),{value:r.nacosConfig.secretKey,"onUpdate:value":s[16]||(s[16]=o=>r.nacosConfig.secretKey=o),placeholder:e(a)("nacosConfig.secretKeyPlaceholder"),"show-password-on":"click","input-props":{autocomplete:"off"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),t(e(bt),null,{default:l(()=>[t(e(St),{title:e(a)("nacosConfig.advancedConfig"),name:"advanced"},{default:l(()=>[t(e(ce),{vertical:"",size:16},{default:l(()=>[d("div",null,[t(e(se),{strong:"",style:{display:"block","margin-bottom":"12px"}},{default:l(()=>s[56]||(s[56]=[b("日志配置")])),_:1}),t(e(Y),{cols:3,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.logLevel"),path:"nacosConfig.logLevel"},{default:l(()=>[t(e(j),{value:r.nacosConfig.logLevel,"onUpdate:value":s[17]||(s[17]=o=>r.nacosConfig.logLevel=o),options:[{label:"Debug",value:"debug"},{label:"Info",value:"info"},{label:"Warn",value:"warn"},{label:"Error",value:"error"}]},null,8,["value"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:"日志目录",path:"nacosConfig.logDir"},{default:l(()=>[t(e(H),{value:r.nacosConfig.logDir,"onUpdate:value":s[18]||(s[18]=o=>r.nacosConfig.logDir=o),placeholder:"默认: /tmp/nacos/log"},null,8,["value"])]),_:1})]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:"输出到控制台",path:"nacosConfig.appendToStdout"},{default:l(()=>[t(e(me),{value:r.nacosConfig.appendToStdout,"onUpdate:value":s[19]||(s[19]=o=>r.nacosConfig.appendToStdout=o)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),d("div",null,[t(e(se),{strong:"",style:{display:"block","margin-bottom":"12px"}},{default:l(()=>s[57]||(s[57]=[b("缓存配置")])),_:1}),t(e(Y),{cols:2,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:"缓存目录"},{default:l(()=>[t(e(H),{value:r.nacosConfig.cacheDir,"onUpdate:value":s[20]||(s[20]=o=>r.nacosConfig.cacheDir=o),placeholder:"默认: /tmp/nacos/cache"},null,8,["value"])]),_:1})]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.updateThreadNum")},{default:l(()=>[t(e(ie),{value:r.nacosConfig.updateThreadNum,"onUpdate:value":s[21]||(s[21]=o=>r.nacosConfig.updateThreadNum=o),placeholder:e(a)("nacosConfig.updateThreadNumPlaceholder"),min:1,max:100,style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.notLoadCacheAtStart")},{default:l(()=>[t(e(me),{value:r.nacosConfig.notLoadCacheAtStart,"onUpdate:value":s[22]||(s[22]=o=>r.nacosConfig.notLoadCacheAtStart=o)},null,8,["value"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.disableUseSnapShot")},{default:l(()=>[t(e(me),{value:r.nacosConfig.disableUseSnapShot,"onUpdate:value":s[23]||(s[23]=o=>r.nacosConfig.disableUseSnapShot=o)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1})]),d("div",null,[t(e(se),{strong:"",style:{display:"block","margin-bottom":"12px"}},{default:l(()=>s[58]||(s[58]=[b("TLS配置")])),_:1}),t(e(Y),{cols:2,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.enableTLS")},{default:l(()=>[t(e(me),{value:r.nacosConfig.enableTLS,"onUpdate:value":s[24]||(s[24]=o=>r.nacosConfig.enableTLS=o)},null,8,["value"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("nacosConfig.trustAll")},{default:l(()=>[t(e(me),{value:r.nacosConfig.trustAll,"onUpdate:value":s[25]||(s[25]=o=>r.nacosConfig.trustAll=o)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1})])]),_:1})]),_:1},8,["title"])]),_:1})]),_:1},8,["title"])])):Z("",!0),v.value?(x(),V(e(W),{key:1,title:e(a)("healthCheckConfig"),size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[t(e(Y),{cols:3,"x-gap":24,"y-gap":16},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("healthCheckUrl"),path:"healthCheckUrl"},{default:l(()=>[t(e(H),{value:r.healthCheckUrl,"onUpdate:value":s[26]||(s[26]=o=>r.healthCheckUrl=o),placeholder:e(a)("healthCheckUrlPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("healthCheckInterval"),path:"healthCheckIntervalSeconds"},{default:l(()=>[t(e(ie),{value:r.healthCheckIntervalSeconds,"onUpdate:value":s[27]||(s[27]=o=>r.healthCheckIntervalSeconds=o),placeholder:e(a)("healthCheckIntervalPlaceholder"),min:5,max:300,style:{width:"100%"}},{suffix:l(()=>[b(p(e(a)("seconds")),1)]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("healthCheckTimeout"),path:"healthCheckTimeoutSeconds"},{default:l(()=>[t(e(ie),{value:r.healthCheckTimeoutSeconds,"onUpdate:value":s[28]||(s[28]=o=>r.healthCheckTimeoutSeconds=o),placeholder:e(a)("healthCheckTimeoutPlaceholder"),min:1,max:60,style:{width:"100%"}},{suffix:l(()=>[b(p(e(a)("seconds")),1)]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("healthCheckType"),path:"healthCheckType"},{default:l(()=>[t(e(j),{value:r.healthCheckType,"onUpdate:value":s[29]||(s[29]=o=>r.healthCheckType=o),options:G,placeholder:e(a)("selectHealthCheckType")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("healthCheckMode"),path:"healthCheckMode"},{default:l(()=>[t(e(j),{value:r.healthCheckMode,"onUpdate:value":s[30]||(s[30]=o=>r.healthCheckMode=o),options:A.value,placeholder:e(a)("selectHealthCheckMode")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["title"])):Z("",!0),t(e(W),{title:e(a)("instanceList"),size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[d("div",Pl,[d("div",Rl,[t(e(se),null,{default:l(()=>[b(p(e(a)("instanceConfig")),1)]),_:1}),r.instances.length>0?(x(),V(e(se),{key:0,depth:"3",style:{"margin-left":"8px"}},{default:l(()=>[b(" ("+p(r.instances.length)+" "+p(e(a)("instances"))+") ",1)]),_:1})):Z("",!0)]),d("div",xl,[t(e(z),{size:"small",onClick:Ft,loading:P.value,disabled:!w.value||!r.serviceName},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ke))]),_:1})]),default:l(()=>[b(" "+p(e(a)("actions.refresh")),1)]),_:1},8,["loading","disabled"]),w.value?(x(),V(e(z),{key:1,size:"small",type:"primary",onClick:tt},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ue))]),_:1})]),default:l(()=>[b(" "+p(e(a)("actions.addInstance")),1)]),_:1})):(x(),V(e(pe),{key:0,placement:"top",trigger:"hover"},{trigger:l(()=>[t(e(z),{size:"small",type:"primary",onClick:tt,disabled:!w.value},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ue))]),_:1})]),default:l(()=>[b(" "+p(e(a)("actions.addInstance")),1)]),_:1},8,["disabled"])]),default:l(()=>[b(" "+p(e(a)("saveServiceBeforeAddingInstance")),1)]),_:1}))])]),d("div",Ul,[t(e(we),{show:P.value},{default:l(()=>[r.instances&&r.instances.length>0?(x(),V(e(Ze),{key:0,columns:Ut.value,data:r.instances,pagination:!1,size:"small","max-height":300,bordered:!0},null,8,["columns","data"])):(x(),V(e(Ge),{key:1,description:e(a)("table.noInstances"),size:"small",style:{padding:"20px 0"}},null,8,["description"]))]),_:1},8,["show"])]),t(e(Ye),{show:de.value,"onUpdate:show":s[39]||(s[39]=o=>de.value=o),width:500,placement:"right"},{default:l(()=>[t(e(ft),{title:Pe.value?e(a)("editInstance"):e(a)("addInstance")},{default:l(()=>[t(e(Ve),{ref_key:"instanceFormRef",ref:et,model:K,rules:xt,"label-placement":"left","label-width":120},{default:l(()=>[t(e(E),{label:e(a)("columns.hostAddress"),path:"hostAddress"},{default:l(()=>[t(e(H),{value:K.hostAddress,"onUpdate:value":s[31]||(s[31]=o=>K.hostAddress=o),placeholder:e(a)("search.placeholder.hostAddress")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(e(E),{label:e(a)("columns.portNumber"),path:"portNumber"},{default:l(()=>[t(e(ie),{value:K.portNumber,"onUpdate:value":s[32]||(s[32]=o=>K.portNumber=o),min:1,max:65535,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),t(e(E),{label:e(a)("columns.weightValue"),path:"weightValue"},{default:l(()=>[t(e(ie),{value:K.weightValue,"onUpdate:value":s[33]||(s[33]=o=>K.weightValue=o),min:1,max:100,"default-value":1,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),t(e(E),{label:e(a)("columns.instanceStatus"),path:"instanceStatus"},{default:l(()=>[t(e(j),{value:K.instanceStatus,"onUpdate:value":s[34]||(s[34]=o=>K.instanceStatus=o),options:Dt.value},null,8,["value","options"])]),_:1},8,["label"]),t(e(E),{label:e(a)("columns.healthStatus"),path:"healthStatus"},{default:l(()=>[t(e(j),{value:K.healthStatus,"onUpdate:value":s[35]||(s[35]=o=>K.healthStatus=o),options:Pt.value},null,8,["value","options"])]),_:1},8,["label"]),t(e(E),{label:e(a)("columns.clientType"),path:"clientType"},{default:l(()=>[t(e(j),{value:K.clientType,"onUpdate:value":s[36]||(s[36]=o=>K.clientType=o),options:Rt.value},null,8,["value","options"])]),_:1},8,["label"]),t(e(E),{label:e(a)("columns.tempInstanceFlag"),path:"tempInstanceFlag"},{default:l(()=>[t(e(me),{value:K.tempInstanceFlag,"onUpdate:value":s[37]||(s[37]=o=>K.tempInstanceFlag=o),"checked-value":"Y","unchecked-value":"N"},{checked:l(()=>[b(p(e(a)("status.temporary")),1)]),unchecked:l(()=>[b(p(e(a)("status.permanent")),1)]),_:1},8,["value"])]),_:1},8,["label"]),d("div",Al,[t(e(z),{onClick:s[38]||(s[38]=o=>de.value=!1)},{default:l(()=>[b(p(e(a)("cancel")),1)]),_:1}),t(e(z),{type:"primary",onClick:Gt},{default:l(()=>[b(p(e(a)("submit")),1)]),_:1})])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])]),_:1},8,["title"]),C.value?(x(),V(e(W),{key:2,title:e(a)("extensionConfig"),size:"small",style:{"margin-bottom":"32px"}},{"header-extra":l(()=>[t(e(z),{text:"",onClick:s[40]||(s[40]=o=>N.value=!N.value),style:{padding:"0"}},{icon:l(()=>[t(e(O),null,{default:l(()=>[(x(),V(gt(N.value?"ChevronUpOutline":"ChevronDownOutline")))]),_:1})]),default:l(()=>[b(" "+p(N.value?e(a)("collapse"):e(a)("expand")),1)]),_:1})]),default:l(()=>[t(e(ia),{show:N.value},{default:l(()=>[t(e(ce),{vertical:"",size:24},{default:l(()=>[t(e(W),{title:e(a)("metadataAndTags"),size:"small",embedded:""},{default:l(()=>[t(e(Y),{cols:1,"y-gap":16},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("metadataJson"),path:"metadataJson"},{default:l(()=>[t(e(H),{value:r.metadataJson,"onUpdate:value":s[41]||(s[41]=o=>r.metadataJson=o),type:"textarea",placeholder:e(a)("metadataJsonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("tagsJson"),path:"tagsJson"},{default:l(()=>[t(e(H),{value:r.tagsJson,"onUpdate:value":s[42]||(s[42]=o=>r.tagsJson=o),type:"textarea",placeholder:e(a)("tagsJsonPlaceholder"),rows:3},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["title"]),t(e(W),{title:e(a)("notesAndExtProperty"),size:"small",embedded:""},{default:l(()=>[t(e(Y),{cols:1,"y-gap":16},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("noteText"),path:"noteText"},{default:l(()=>[t(e(H),{value:r.noteText,"onUpdate:value":s[43]||(s[43]=o=>r.noteText=o),type:"textarea",placeholder:e(a)("noteTextPlaceholder"),rows:3,maxlength:"500","show-count":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("extProperty"),path:"extProperty"},{default:l(()=>[t(e(H),{value:r.extProperty,"onUpdate:value":s[44]||(s[44]=o=>r.extProperty=o),type:"textarea",placeholder:e(a)("extPropertyPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["title"]),t(e(W),{title:e(a)("reservedFields"),size:"small",embedded:""},{"header-extra":l(()=>[t(e(B),{size:"small",type:"info"},{default:l(()=>[b(p(e(a)("forFutureExpansion")),1)]),_:1})]),default:l(()=>[t(e(Y),{cols:2,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:1}),path:"reserved1"},{default:l(()=>[t(e(H),{value:r.reserved1,"onUpdate:value":s[45]||(s[45]=o=>r.reserved1=o),placeholder:e(a)("reservedFieldPlaceholder",{number:1})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:2}),path:"reserved2"},{default:l(()=>[t(e(H),{value:r.reserved2,"onUpdate:value":s[46]||(s[46]=o=>r.reserved2=o),placeholder:e(a)("reservedFieldPlaceholder",{number:2})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:3}),path:"reserved3"},{default:l(()=>[t(e(H),{value:r.reserved3,"onUpdate:value":s[47]||(s[47]=o=>r.reserved3=o),placeholder:e(a)("reservedFieldPlaceholder",{number:3})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:4}),path:"reserved4"},{default:l(()=>[t(e(H),{value:r.reserved4,"onUpdate:value":s[48]||(s[48]=o=>r.reserved4=o),placeholder:e(a)("reservedFieldPlaceholder",{number:4})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:5}),path:"reserved5"},{default:l(()=>[t(e(H),{value:r.reserved5,"onUpdate:value":s[49]||(s[49]=o=>r.reserved5=o),placeholder:e(a)("reservedFieldPlaceholder",{number:5})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),t(e(mt),{style:{margin:"12px 0"}}),t(e(Y),{cols:2,"x-gap":16,"y-gap":12},{default:l(()=>[t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:6}),path:"reserved6"},{default:l(()=>[t(e(H),{value:r.reserved6,"onUpdate:value":s[50]||(s[50]=o=>r.reserved6=o),placeholder:e(a)("reservedFieldPlaceholder",{number:6})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:7}),path:"reserved7"},{default:l(()=>[t(e(H),{value:r.reserved7,"onUpdate:value":s[51]||(s[51]=o=>r.reserved7=o),placeholder:e(a)("reservedFieldPlaceholder",{number:7})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:8}),path:"reserved8"},{default:l(()=>[t(e(H),{value:r.reserved8,"onUpdate:value":s[52]||(s[52]=o=>r.reserved8=o),placeholder:e(a)("reservedFieldPlaceholder",{number:8})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:9}),path:"reserved9"},{default:l(()=>[t(e(H),{value:r.reserved9,"onUpdate:value":s[53]||(s[53]=o=>r.reserved9=o),placeholder:e(a)("reservedFieldPlaceholder",{number:9})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),t(e(D),null,{default:l(()=>[t(e(E),{label:e(a)("reservedField",{number:10}),path:"reserved10"},{default:l(()=>[t(e(H),{value:r.reserved10,"onUpdate:value":s[54]||(s[54]=o=>r.reserved10=o),placeholder:e(a)("reservedFieldPlaceholder",{number:10})},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])):Z("",!0)]),_:1},8,["model","rules"]),d("div",Ol,[t(e(ce),{size:"large",justify:"center"},{default:l(()=>[t(e(z),{size:"large",onClick:J},{default:l(()=>[b(p(e(a)("cancel")),1)]),_:1}),t(e(z),{size:"large",onClick:be},{default:l(()=>[b(p(e(a)("reset")),1)]),_:1}),t(e(z),{type:"primary",size:"large",onClick:kt,loading:T.value},{default:l(()=>[b(p(w.value?e(a)("actions.update"):e(a)("actions.create")),1)]),_:1},8,["loading"])]),_:1})])]),_:1}),t(Sl,{show:U.value,"onUpdate:show":s[55]||(s[55]=o=>U.value=o),"selected-group-id":r.serviceGroupId,onConfirm:ze},null,8,["show","selected-group-id"])]))}}),Hl=fe(Fl,[["__scopeId","data-v-771bc475"]]),Gl={class:"service-event-list"},Ll=re({__name:"ServiceEventList",props:{serviceId:{default:void 0},instanceId:{default:void 0}},emits:["viewEvent"],setup(n,{expose:u,emit:i}){const f=n,{events:a,loading:g,naiveConfig:m,loadEvents:w,createTableColumns:P,setPaginationCallback:T}=wt(),h=M(()=>P(y)),U=i,y=v=>{U("viewEvent",v)},N=v=>{w(f.serviceId,f.instanceId,v)};return T(()=>{N()}),Le(()=>{N()}),u({loadEvents:N}),(v,C)=>(x(),q("div",Gl,[t(e(Ze),{columns:h.value,data:e(a),loading:e(g),pagination:e(m),bordered:!1,"scroll-x":1370,"single-line":!1,size:"medium",remote:"",striped:""},null,8,["columns","data","loading","pagination"])]))}}),zl=fe(Ll,[["__scopeId","data-v-cb3be427"]]),$l={class:"event-detail-wrapper"},Ml={class:"event-header"},Vl={class:"info-row"},Kl={class:"label"},Bl={class:"value"},ql={class:"info-row"},Jl={class:"label"},Yl={class:"value"},Wl={class:"info-row"},jl={class:"label"},Zl={class:"value"},Ql={class:"info-row"},Xl={class:"label"},es={class:"value"},ts={class:"info-row"},as={class:"label"},ls={class:"value"},ss={class:"info-row"},rs={class:"value"},ns={class:"audit-info"},os={class:"info-row"},is={class:"value"},cs={class:"info-row"},us={class:"value"},ds={key:1},ps={class:"info-row"},vs={class:"value"},hs={class:"info-row"},fs={class:"value"},ms={class:"info-row"},gs={class:"value"},ys=re({__name:"ServiceEventDetail",props:{show:{type:Boolean,default:!1},event:{default:null},loading:{type:Boolean,default:!1}},emits:["update:show","close"],setup(n,{emit:u}){const i=n,f=u,{t:a}=ue("hub0041"),g=he(),m=F(null),w=F(!1),P=M({get:()=>i.show,set:v=>{f("update:show",v),v||(f("close"),m.value=null)}}),T=async v=>{try{w.value=!0;const C=await It(v);C.oK?m.value=ye(C):(g.error("获取事件详情失败"),m.value=null)}catch(C){console.error("Failed to fetch event detail:",C),g.error("获取事件详情失败"),m.value=null}finally{w.value=!1}};Ne([()=>i.event,()=>i.show],([v,C])=>{v&&C&&v.serviceEventId&&T(v.serviceEventId)},{immediate:!0});const h=M(()=>m.value||i.event),U=v=>v?v.includes("GROUP_")?Fe:v.includes("SERVICE_")?qe:v.includes("INSTANCE_")?Je:Oe:Oe,y=v=>v?v==="GROUP_CREATE"?"success":v==="GROUP_UPDATE"?"info":v==="GROUP_DELETE"?"error":v==="SERVICE_CREATE"?"success":v==="SERVICE_UPDATE"?"info":v==="SERVICE_DELETE"?"error":v==="INSTANCE_REGISTER"?"success":v==="INSTANCE_DEREGISTER"?"error":v==="INSTANCE_HEARTBEAT"?"default":v==="INSTANCE_HEALTH_CHANGE"?"warning":v==="INSTANCE_STATUS_CHANGE"?"info":"default":"default",N=v=>{try{const C=JSON.parse(v);return JSON.stringify(C,null,2)}catch{return v}};return(v,C)=>(x(),V(e(Ye),{show:P.value,"onUpdate:show":C[0]||(C[0]=R=>P.value=R),width:520,title:e(a)("dialogs.serviceEvent.title"),placement:"right",closable:"",resizable:""},{default:l(()=>[t(e(we),{show:v.loading||w.value},{default:l(()=>{var R,r,_;return[d("div",$l,[d("div",Ml,[t(e(B),{size:"medium",type:y((R=h.value)==null?void 0:R.eventType),round:""},{icon:l(()=>[t(e(O),null,{default:l(()=>{var S;return[(x(),V(gt(U((S=h.value)==null?void 0:S.eventType))))]}),_:1})]),default:l(()=>{var S;return[b(" "+p((S=h.value)==null?void 0:S.eventType),1)]}),_:1},8,["type"]),(r=h.value)!=null&&r.eventTime?(x(),V(e(ve),{key:0,time:new Date(h.value.eventTime),format:"yyyy-MM-dd HH:mm:ss",class:"event-time"},null,8,["time"])):Z("",!0)]),t(e(W),{class:"detail-card",title:"事件基本信息",size:"small"},{default:l(()=>{var S,G,A,I,L,$;return[d("div",Vl,[d("span",Kl,p(e(a)("columns.eventMessage")),1),d("span",Bl,p(((S=h.value)==null?void 0:S.eventMessage)||"-"),1)]),d("div",ql,[d("span",Jl,p(e(a)("columns.eventSource")),1),d("span",Yl,p(((G=h.value)==null?void 0:G.eventSource)||"-"),1)]),d("div",Wl,[d("span",jl,p(e(a)("columns.serviceName")),1),d("span",Zl,p(((A=h.value)==null?void 0:A.serviceName)||"-"),1)]),d("div",Ql,[d("span",Xl,p(e(a)("columns.groupName")),1),d("span",es,p(((I=h.value)==null?void 0:I.groupName)||"-"),1)]),d("div",ts,[d("span",as,p(e(a)("columns.hostAddress")),1),d("span",ls,p((L=h.value)!=null&&L.hostAddress?`${h.value.hostAddress}:${h.value.portNumber||"-"}`:"-"),1)]),d("div",ss,[C[1]||(C[1]=d("span",{class:"label"},"服务运行节点IP",-1)),d("span",rs,p((($=h.value)==null?void 0:$.nodeIpAddress)||"-"),1)])]}),_:1}),(_=h.value)!=null&&_.eventDataJson?(x(),V(e(W),{key:0,class:"detail-card",title:"事件数据",size:"small"},{default:l(()=>[t(e(ca),{code:N(h.value.eventDataJson),language:"json","show-line-numbers":""},null,8,["code"])]),_:1})):Z("",!0),t(e(bt),null,{default:l(()=>[t(e(St),{name:"audit",title:"审计信息"},{default:l(()=>{var S,G,A,I,L;return[d("div",ns,[d("div",os,[C[2]||(C[2]=d("span",{class:"label"},"事件ID",-1)),d("span",is,p(((S=h.value)==null?void 0:S.serviceEventId)||"-"),1)]),d("div",cs,[C[3]||(C[3]=d("span",{class:"label"},"创建时间",-1)),d("span",us,[(G=h.value)!=null&&G.addTime?(x(),V(e(ve),{key:0,time:new Date(h.value.addTime),format:"yyyy-MM-dd HH:mm:ss"},null,8,["time"])):(x(),q("span",ds,"-"))])]),d("div",ps,[C[4]||(C[4]=d("span",{class:"label"},"创建人",-1)),d("span",vs,p(((A=h.value)==null?void 0:A.addWho)||"-"),1)]),d("div",hs,[C[5]||(C[5]=d("span",{class:"label"},"租户ID",-1)),d("span",fs,p(((I=h.value)==null?void 0:I.tenantId)||"-"),1)]),d("div",ms,[C[6]||(C[6]=d("span",{class:"label"},"服务实例ID",-1)),d("span",gs,p(((L=h.value)==null?void 0:L.serviceInstanceId)||"-"),1)])])]}),_:1})]),_:1})])]}),_:1},8,["show"])]),_:1},8,["show","title"]))}}),_s=fe(ys,[["__scopeId","data-v-94935c56"]]);var le=(n=>(n.SERVICE_GROUP_CREATED="SERVICE_GROUP_CREATED",n.SERVICE_GROUP_UPDATED="SERVICE_GROUP_UPDATED",n.SERVICE_GROUP_DELETED="SERVICE_GROUP_DELETED",n.SERVICE_REGISTERED="SERVICE_REGISTERED",n.SERVICE_UPDATED="SERVICE_UPDATED",n.SERVICE_DEREGISTERED="SERVICE_DEREGISTERED",n.INSTANCE_REGISTERED="INSTANCE_REGISTERED",n.INSTANCE_DEREGISTERED="INSTANCE_DEREGISTERED",n.INSTANCE_HEARTBEAT_UPDATED="INSTANCE_HEARTBEAT_UPDATED",n.INSTANCE_HEALTH_CHANGE="INSTANCE_HEALTH_CHANGE",n.INSTANCE_STATUS_CHANGE="INSTANCE_STATUS_CHANGE",n))(le||{});const bs={class:"service-event-page"},Ss={class:"page-header"},Cs={class:"search-section"},Ts=re({__name:"ServiceEventPage",setup(n,{expose:u}){const i=he(),{t:f}=ue("hub0041"),{getServiceEventById:a}=wt(),g=F(null),m=F(!1),w=F(null),P=F(!1),T=[{type:"group",label:"分组相关事件",key:"group",children:[{label:"分组创建",value:le.SERVICE_GROUP_CREATED},{label:"分组更新",value:le.SERVICE_GROUP_UPDATED},{label:"分组删除",value:le.SERVICE_GROUP_DELETED}]},{type:"group",label:"服务相关事件",key:"service",children:[{label:"服务注册",value:le.SERVICE_REGISTERED},{label:"服务更新",value:le.SERVICE_UPDATED},{label:"服务注销",value:le.SERVICE_DEREGISTERED}]},{type:"group",label:"实例相关事件",key:"instance",children:[{label:"实例注册",value:le.INSTANCE_REGISTERED},{label:"实例注销",value:le.INSTANCE_DEREGISTERED},{label:"实例心跳更新",value:le.INSTANCE_HEARTBEAT_UPDATED},{label:"实例健康变更",value:le.INSTANCE_HEALTH_CHANGE},{label:"实例状态变更",value:le.INSTANCE_STATUS_CHANGE}]}],h=Ae({serviceName:"",eventType:null,eventSource:"",timeRange:null}),U=()=>{g.value&&typeof g.value.loadEvents=="function"&&(g.value.loadEvents(),i.success(f("messages.refreshSuccess")))},y=()=>{const R={};if(h.serviceName&&(R.serviceName=h.serviceName),h.eventType&&(R.eventType=h.eventType),h.eventSource&&(R.eventSource=h.eventSource),h.timeRange){const[r,_]=h.timeRange;R.startTime=new Date(r).toISOString(),R.endTime=new Date(_).toISOString()}g.value&&typeof g.value.loadEvents=="function"&&g.value.loadEvents(R)},N=()=>{h.serviceName="",h.eventType=null,h.eventSource="",h.timeRange=null,g.value&&typeof g.value.loadEvents=="function"&&g.value.loadEvents()},v=R=>{w.value=R,m.value=!0};return u({refreshEvents:U,viewEventDetail:async R=>{P.value=!0,m.value=!0;try{w.value=await a(R)}catch(r){i.error(f("messages.loadError")),console.error("加载事件详情失败:",r)}finally{P.value=!1}}}),(R,r)=>(x(),q("div",bs,[t(e(W),null,{header:l(()=>[d("div",Ss,[d("h3",null,p(e(f)("menu.eventList")),1),t(e(ce),null,{default:l(()=>[t(e(z),{type:"primary",onClick:y},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(We))]),_:1})]),default:l(()=>[b(" "+p(e(f)("actions.search")),1)]),_:1}),t(e(z),{onClick:N},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ua))]),_:1})]),default:l(()=>[b(" "+p(e(f)("actions.reset")),1)]),_:1}),t(e(z),{onClick:U},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ke))]),_:1})]),default:l(()=>[b(" "+p(e(f)("actions.refresh")),1)]),_:1})]),_:1})])]),default:l(()=>[d("div",Cs,[t(e(Ve),{model:h,"label-placement":"left","label-width":"auto",inline:""},{default:l(()=>[t(e(E),{label:e(f)("columns.serviceName")},{default:l(()=>[t(e(H),{value:h.serviceName,"onUpdate:value":r[0]||(r[0]=_=>h.serviceName=_),placeholder:e(f)("search.placeholder.serviceName"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(e(E),{label:e(f)("columns.eventType")},{default:l(()=>[t(e(j),{value:h.eventType,"onUpdate:value":r[1]||(r[1]=_=>h.eventType=_),options:T,clearable:"",placeholder:e(f)("selectEventType"),style:{"min-width":"160px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(e(E),{label:e(f)("columns.eventSource")},{default:l(()=>[t(e(H),{value:h.eventSource,"onUpdate:value":r[2]||(r[2]=_=>h.eventSource=_),placeholder:e(f)("search.placeholder.eventSource"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(e(E),{label:e(f)("columns.eventTime")},{default:l(()=>[t(e(sa),{value:h.timeRange,"onUpdate:value":r[3]||(r[3]=_=>h.timeRange=_),type:"daterange",clearable:"",placeholder:e(f)("search.placeholder.timeRange"),style:{width:"240px"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),t(zl,{ref_key:"eventListRef",ref:g,onViewEvent:v},null,512),t(_s,{show:m.value,"onUpdate:show":r[4]||(r[4]=_=>m.value=_),event:w.value,loading:P.value},null,8,["show","event","loading"])]),_:1})]))}}),Es=fe(Ts,[["__scopeId","data-v-46a028cd"]]),Ns={class:"service-registry-management"},Is={class:"list-view"},ws={class:"search-section"},ks={class:"services-section"},Ds={class:"form-view"},Ps={class:"events-view"},Rs={class:"events-header"},xs={class:"events-title"},Us={class:"bottom-pagination"},As=re({__name:"ServiceRegistryManagement",setup(n){const{t:u}=ue("hub0041");he();const i=Zt(),{services:f,loading:a,searchParams:g,naiveConfig:m,fetchServices:w,refreshService:P,handleSearch:T,handleReset:h,handleRefresh:U,handleDeleteService:y}=Ra(),N=[{label:"HTTP",value:"HTTP"},{label:"HTTPS",value:"HTTPS"},{label:"TCP",value:"TCP"},{label:"UDP",value:"UDP"},{label:"GRPC",value:"GRPC"}],v=[{label:u("status.Y"),value:"Y"},{label:u("status.N"),value:"N"}],C=F("list"),R=F(!1),r=F(""),_=F(null),S=F("");Le(()=>{w()});const G=h,A=U,I=te=>{r.value=te.serviceName,R.value=!0},L=async te=>{await P(te)},$=()=>{_.value=null,C.value="form"},ne=te=>{_.value=te,C.value="form"},_e=te=>{S.value=te.serviceName,C.value="events"},be=()=>{C.value="list",_.value=null,S.value=""},De=()=>{w()},ze=te=>{i.warning({title:u("actions.delete"),content:u("messages.confirmDeleteService"),positiveText:u("actions.confirm"),negativeText:u("actions.cancel"),onPositiveClick:async()=>{await y(te.serviceName)}})};return(te,ae)=>(x(),q("div",Ns,[Re(d("div",Is,[d("div",ws,[t(e(ce),{size:16,justify:"space-between"},{default:l(()=>[t(e(ce),{size:16},{default:l(()=>[t(e(H),{value:e(g).serviceName,"onUpdate:value":ae[0]||(ae[0]=J=>e(g).serviceName=J),placeholder:e(u)("searchServiceName"),clearable:"",onClear:e(T),onKeyup:st(e(T),["enter"]),style:{width:"240px"}},{prefix:l(()=>[t(e(O),null,{default:l(()=>[t(e(We))]),_:1})]),_:1},8,["value","placeholder","onClear","onKeyup"]),t(e(H),{value:e(g).groupName,"onUpdate:value":ae[1]||(ae[1]=J=>e(g).groupName=J),placeholder:e(u)("search.placeholder.groupName"),clearable:"",onClear:e(T),onKeyup:st(e(T),["enter"]),style:{width:"180px"}},{prefix:l(()=>[t(e(O),null,{default:l(()=>[t(e(Fe))]),_:1})]),_:1},8,["value","placeholder","onClear","onKeyup"]),t(e(j),{value:e(g).protocolType,"onUpdate:value":[ae[2]||(ae[2]=J=>e(g).protocolType=J),e(T)],options:N,placeholder:e(u)("selectProtocol"),clearable:"",style:{width:"140px"}},null,8,["value","placeholder","onUpdate:value"]),t(e(j),{value:e(g).activeFlag,"onUpdate:value":[ae[3]||(ae[3]=J=>e(g).activeFlag=J),e(T)],options:v,placeholder:e(u)("selectStatus"),clearable:"",style:{width:"120px"}},null,8,["value","placeholder","onUpdate:value"]),t(e(z),{onClick:e(T),type:"primary"},{default:l(()=>[b(p(e(u)("actions.search")),1)]),_:1},8,["onClick"]),t(e(z),{onClick:e(G)},{default:l(()=>[b(p(e(u)("actions.reset")),1)]),_:1},8,["onClick"]),t(e(z),{type:"primary",onClick:e(A),loading:e(a)},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(ke))]),_:1})]),default:l(()=>[b(" "+p(e(u)("actions.refresh")),1)]),_:1},8,["onClick","loading"])]),_:1}),t(e(z),{type:"primary",onClick:$},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ue))]),_:1})]),default:l(()=>[b(" "+p(e(u)("actions.add")),1)]),_:1})]),_:1})]),d("div",ks,[t(e(we),{show:e(a)},{default:l(()=>[e(f).length>0?(x(),V(e(Y),{key:0,cols:4,"x-gap":16,"y-gap":16},{default:l(()=>[(x(!0),q(He,null,je(e(f),J=>(x(),V(e(D),{key:J.serviceName},{default:l(()=>[t(Xa,{service:J,onViewDetail:I,onEdit:ne,onRefresh:L,onDelete:ze,onViewEvents:_e},null,8,["service"])]),_:2},1024))),128))]),_:1})):e(a)?Z("",!0):(x(),V(e(Ge),{key:1,description:e(u)("noServices"),style:{padding:"60px 0"}},null,8,["description"]))]),_:1},8,["show"])]),t(dl,{show:R.value,"onUpdate:show":ae[4]||(ae[4]=J=>R.value=J),"service-name":r.value},null,8,["show","service-name"])],512),[[xe,C.value==="list"]]),Re(d("div",Ds,[C.value==="form"?(x(),V(Hl,{key:0,"edit-data":_.value,onBack:be,onSuccess:De},null,8,["edit-data"])):Z("",!0)],512),[[xe,C.value==="form"]]),Re(d("div",Ps,[d("div",Rs,[t(e(ce),{justify:"space-between",align:"center"},{default:l(()=>[d("div",xs,[t(e(z),{text:"",onClick:be},{icon:l(()=>[t(e(O),null,{default:l(()=>[t(e(Ct))]),_:1})]),default:l(()=>[b(" "+p(e(u)("actions.back")),1)]),_:1}),t(e(mt),{vertical:""}),d("h3",null,p(e(u)("serviceEventLog"))+" - "+p(S.value),1)])]),_:1})]),C.value==="events"?(x(),V(Es,{key:0,"service-id":S.value},null,8,["service-id"])):Z("",!0)],512),[[xe,C.value==="events"]]),Re(d("div",Us,[t(e(ta),Qt(Xt(e(m))),null,16)],512),[[xe,C.value==="list"]])]))}}),rr=fe(As,[["__scopeId","data-v-91961e99"]]);export{rr as default};
