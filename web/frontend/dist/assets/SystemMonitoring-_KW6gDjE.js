import{d as pe,p as Oe,a7 as ue,q as ve,r as P,a8 as ye,g as we,w as M,e as t,a9 as he,aa as q,o as Y,f as y,c as j,h as ae,b as g,I as be,ab as ge,j as U,K as oe,t as te,i as ne,J as Me,_ as De,ac as Je,ad as Ye,x as Qe,ae as We,af as je,m as Ve,z as ie,A as le,B as ce,ag as Te,ah as Ze}from"./index-ESHYz3i9.js";import{N as _e,P as ze}from"./index-D1t35l7m.js";import{R as Se,D as Xe,A as Be,a as Ge,C as et,G as tt,W as at,b as rt}from"./WindowsOutlined-DFuqvWY3.js";import{u as $e,i as xe,a as Ce,b as Ie,c as Pe,d as Le,e as Re,f as Ae,g as Ne,L as Ke}from"./installCanvasRenderer-Bdf8yIjj.js";import{N as st}from"./DataTable-D-nsVghQ.js";import{N as ot}from"./Select-BnP-dm7-.js";import"./Checkbox-C9Worf_Q.js";import"./RadioGroup-BUdshkUl.js";import"./prop-NnGblK-3.js";import"./download-C2161hUv.js";const nt={class:"card-extra"},it={class:"chart-container"},lt={key:0,class:"chart-loading"},ct={key:1,class:"chart-empty"},ut=pe({__name:"CpuMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},cpuDetailData:{type:Array,default:()=>[]},userColor:{type:String,default:"#1890ff"},systemColor:{type:String,default:"#52c41a"},idleColor:{type:String,default:"#d9d9d9"}},emits:["refresh","time-range-change"],setup(r,{emit:x}){$e([Ce,Ie,Pe,Le,Re,Ae,Ne]);const{t:e}=Oe("hub0000"),D=P(null);let d=null;const S=r,w=x,_=Date.now(),b=_-3600*1e3,I=P([b,_]),A=U(()=>({[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const s=Date.now();return[s-3600*1e3,s]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const s=Date.now();return[s-6*3600*1e3,s]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const s=Date.now();return[s-12*3600*1e3,s]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const s=Date.now();return[s-24*3600*1e3,s]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const s=Date.now();return[s-168*3600*1e3,s]}})),E=()=>{D.value&&(d=xe(D.value),window.addEventListener("resize",O),z())},z=()=>{if(!d)return;if(!S.data||!Array.isArray(S.data)||S.data.length===0){d.clear();return}const s=S.data.map(c=>c.collectTime).sort(),i=new Map;S.data.forEach(c=>{i.set(c.collectTime,c)});const o=[{name:e("hub0000.cpu.usage"),type:"line",data:s.map(c=>{const n=i.get(c);return{value:n?n.usagePercent:0,detail:n}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:S.userColor}},{name:e("hub0000.cpu.userUsage"),type:"line",data:s.map(c=>{const n=i.get(c);return{value:n?n.userPercent:0,detail:n}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:S.systemColor}},{name:e("hub0000.cpu.systemUsage"),type:"line",data:s.map(c=>{const n=i.get(c);return{value:n?n.systemPercent:0,detail:n}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:S.idleColor}}],a={tooltip:{trigger:"axis",formatter:c=>{const n=c[0].data.detail;let f="";return n&&(f+=`${e("hub0000.cpu.detailTitle")}:<br/>`,f+=`${e("hub0000.cpu.serverId")}: ${n.metricServerId}<br/>`,f+=`${e("hub0000.cpu.coreCount")}: ${n.coreCount}<br/>`,f+=`${e("hub0000.cpu.logicalCount")}: ${n.logicalCount}<br/>`,f+=`${e("hub0000.cpu.loadAvg1")}: ${n.loadAvg1.toFixed(2)}<br/>`,f+=`${e("hub0000.cpu.loadAvg5")}: ${n.loadAvg5.toFixed(2)}<br/>`,f+=`${e("hub0000.cpu.loadAvg15")}: ${n.loadAvg15.toFixed(2)}<br/>`,f+=`${e("hub0000.cpu.ioWaitUsage")}: ${n.ioWaitPercent.toFixed(2)}%<br/>`,f+=`${e("hub0000.cpu.irqUsage")}: ${n.irqPercent.toFixed(2)}%<br/>`,f+=`${e("hub0000.cpu.softIrqUsage")}: ${n.softIrqPercent.toFixed(2)}%<br/>`,f+="<br/>"),c.forEach(p=>{const k=p.marker,u=p.seriesName,v=`${p.value.toFixed(2)}%`;f+=`${k} ${u}: ${v}<br/>`}),f},axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:[e("hub0000.cpu.usage"),e("hub0000.cpu.userUsage"),e("hub0000.cpu.systemUsage")],type:"scroll",bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:s.map(c=>q(c,"HH:mm:ss")),axisLabel:{interval:Math.floor(s.length/10)}},yAxis:{type:"value",axisLabel:{formatter:c=>c.toFixed(2)+"%"},max:100,min:0},series:o};d.setOption(a,!0)},O=()=>{d==null||d.resize()},Q=()=>{w("refresh")},m=s=>{w("time-range-change",s)};return ue(()=>S.data,()=>{z()},{deep:!0}),ve(()=>{E(),w("time-range-change",I.value)}),ye(()=>{d&&(d.dispose(),d=null),window.removeEventListener("resize",O)}),(s,i)=>(Y(),we(t(he),{title:t(e)("hub0000.cpu.title"),bordered:!1,class:"monitor-card"},{"header-extra":M(()=>[y("div",nt,[g(t(_e),{value:I.value,"onUpdate:value":[i[0]||(i[0]=o=>I.value=o),m],type:"datetimerange",shortcuts:A.value,placeholder:t(e)("hub0000.common.selectTimeRange"),size:"small"},null,8,["value","shortcuts","placeholder"]),g(t(Me),{size:"small",onClick:Q,loading:r.loading},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[oe(" "+te(t(e)("hub0000.common.refresh")),1)]),_:1},8,["loading"])])]),default:M(()=>[y("div",it,[y("div",{ref_key:"chartRef",ref:D,class:"chart-element"},null,512),r.loading?(Y(),j("div",lt,[g(t(be),{size:"large"})])):ae("",!0),!r.loading&&(!r.data||!Array.isArray(r.data)||r.data.length===0)?(Y(),j("div",ct,[g(t(ge),{description:t(e)("hub0000.common.noData")},null,8,["description"])])):ae("",!0)])]),_:1},8,["title"]))}}),dt=De(ut,[["__scopeId","data-v-7ffafae8"]]),mt={class:"card-extra"},ht={class:"chart-container"},gt={key:0,class:"chart-loading"},ft={key:1,class:"chart-empty"},pt=pe({__name:"MemoryMonitor",props:{title:{type:String,default:"内存使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},memoryDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(r,{emit:x}){$e([Ce,Ie,Pe,Le,Re,Ae,Ne]);const{t:e}=Oe("hub0000"),D=r,d=U(()=>D.title||e("hub0000.memory.title")),S=U(()=>D.warningThreshold),w=U(()=>D.dangerThreshold),_=x,b=P(null);let I=null;const A=Date.now(),E=A-3600*1e3,z=P([E,A]),O=U(()=>({[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const n=Date.now();return[n-3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const n=Date.now();return[n-6*3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const n=Date.now();return[n-12*3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const n=Date.now();return[n-24*3600*1e3,n]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const n=Date.now();return[n-168*3600*1e3,n]}})),Q=U(()=>{if(!D.data||D.data.length===0)return[];const n=new Map;return D.data.forEach(p=>{const k=p.collectTime;n.has(k)||n.set(k,[]),n.get(k).push(p.usagePercent)}),Array.from(n.entries()).map(([p,k])=>{const u=D.data.find(v=>v.collectTime===p);return{time:p,value:Math.round(k.reduce((v,C)=>v+C,0)/k.length*100)/100,detail:u?{totalMemory:u.totalMemory,usedMemory:u.usedMemory,availableMemory:u.availableMemory,freeMemory:u.freeMemory,cachedMemory:u.cachedMemory,buffersMemory:u.buffersMemory,swapTotal:u.swapTotal,swapUsed:u.swapUsed,swapFree:u.swapFree,swapUsagePercent:u.swapUsagePercent}:null}}).sort((p,k)=>new Date(p.time).getTime()-new Date(k.time).getTime())}),m=n=>{if(n===0)return"0 B";const f=["B","KB","MB","GB","TB","PB"],p=Math.floor(Math.log(n)/Math.log(1024));return`${(n/Math.pow(1024,p)).toFixed(2)} ${f[p]}`},s=()=>{_("refresh")},i=n=>{_("time-range-change",n)},o=()=>{b.value&&(I=xe(b.value),window.addEventListener("resize",c),a())},a=()=>{if(!I)return;const n=Q.value;if(n.length===0){I.clear();return}const f={title:{show:!1},tooltip:{trigger:"axis",formatter:function(p){const k=p[0],u=k.data.detail;if(!u)return`${k.marker}${k.seriesName}: ${k.data.value}%`;let v="";return v+=`${k.marker}${e("hub0000.memory.usage")}: <b>${k.data.value}%</b><br/>`,v+=`<br/>${e("hub0000.memory.details")}:<br/>`,v+=`${e("hub0000.memory.total")}: ${m(u.totalMemory)}<br/>`,v+=`${e("hub0000.memory.used")}: ${m(u.usedMemory)}<br/>`,v+=`${e("hub0000.memory.available")}: ${m(u.availableMemory)}<br/>`,v+=`${e("hub0000.memory.free")}: ${m(u.freeMemory)}<br/>`,v+=`${e("hub0000.memory.cached")}: ${m(u.cachedMemory)}<br/>`,v+=`${e("hub0000.memory.buffers")}: ${m(u.buffersMemory)}<br/>`,v+=`<br/>${e("hub0000.memory.swap")}:<br/>`,v+=`${e("hub0000.memory.swapTotal")}: ${m(u.swapTotal)}<br/>`,v+=`${e("hub0000.memory.swapUsed")}: ${m(u.swapUsed)}<br/>`,v+=`${e("hub0000.memory.swapFree")}: ${m(u.swapFree)}<br/>`,v+=`${e("hub0000.memory.swapUsage")}: ${u.swapUsagePercent.toFixed(1)}%`,v}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:n.map(p=>q(new Date(p.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:e("hub0000.memory.usage"),type:"line",data:n.map(p=>({value:p.value,detail:p.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#52c41a"},itemStyle:{color:function(p){const k=p.data.value;return k>=w.value?"#ff4d4f":k>=S.value?"#faad14":"#52c41a"}},areaStyle:{color:new Ke(0,0,0,1,[{offset:0,color:"rgba(82, 196, 26, 0.3)"},{offset:1,color:"rgba(82, 196, 26, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:S.value,label:{formatter:`${e("hub0000.memory.warning")} ${S.value}%`,position:"start"}},{yAxis:w.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`${e("hub0000.memory.danger")} ${w.value}%`,position:"start"}}]}}]};I.setOption(f)},c=()=>{I==null||I.resize()};return ue(()=>D.data,()=>{a()},{deep:!0}),ve(()=>{o(),_("time-range-change",z.value)}),ye(()=>{I&&(I.dispose(),I=null),window.removeEventListener("resize",c)}),(n,f)=>(Y(),we(t(he),{title:d.value,bordered:!1,class:"monitor-card"},{"header-extra":M(()=>[y("div",mt,[g(t(_e),{value:z.value,"onUpdate:value":[f[0]||(f[0]=p=>z.value=p),i],type:"datetimerange",shortcuts:O.value,placeholder:t(e)("common.selectTimeRange"),size:"small"},null,8,["value","shortcuts","placeholder"]),g(t(Me),{size:"small",onClick:s,loading:r.loading},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[oe(" "+te(t(e)("common.refresh")),1)]),_:1},8,["loading"])])]),default:M(()=>[y("div",ht,[y("div",{ref_key:"chartRef",ref:b,class:"chart-element"},null,512),r.loading?(Y(),j("div",gt,[g(t(be),{size:"large"})])):ae("",!0),!r.loading&&!Q.value.length?(Y(),j("div",ft,[g(t(ge),{description:t(e)("common.noData")},null,8,["description"])])):ae("",!0)])]),_:1},8,["title"]))}}),vt=De(pt,[["__scopeId","data-v-284035ac"]]),yt={class:"card-extra"},wt={class:"chart-container"},bt={key:0,class:"chart-loading"},Mt={key:1,class:"chart-empty"},Dt=pe({__name:"DiskMonitor",props:{title:{type:String,default:"磁盘使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},diskDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(r,{emit:x}){$e([Ce,Ie,Pe,Le,Re,Ae,Ne]);const{t:e}=Oe("hub0000"),D=r,d=U(()=>D.title||e("hub0000.disk.title")),S=x,w=P(null);let _=null;const b=Date.now(),I=b-3600*1e3,A=P([I,b]),E=U(()=>({[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const a=Date.now();return[a-3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const a=Date.now();return[a-6*3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const a=Date.now();return[a-12*3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const a=Date.now();return[a-24*3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const a=Date.now();return[a-168*3600*1e3,a]}})),z=U(()=>{if(!D.data||D.data.length===0)return[];const a=new Map;return D.data.forEach(c=>{const n=c.collectTime;a.has(n)||a.set(n,{values:[],partitions:[]});const f=a.get(n);f.values.push(c.usagePercent),f.partitions.push(c)}),Array.from(a.entries()).map(([c,n])=>({time:c,value:Math.round(n.values.reduce((f,p)=>f+p,0)/n.values.length*100)/100,detail:{partitions:n.partitions,partitionCount:n.partitions.length,totalSpace:n.partitions.reduce((f,p)=>f+p.totalSpace,0),usedSpace:n.partitions.reduce((f,p)=>f+p.usedSpace,0),freeSpace:n.partitions.reduce((f,p)=>f+p.freeSpace,0),avgUsagePercent:Math.round(n.values.reduce((f,p)=>f+p,0)/n.values.length*100)/100}}))}),O=a=>{if(a===0)return"0 B";const c=["B","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(a)/Math.log(1024));return`${(a/Math.pow(1024,n)).toFixed(2)} ${c[n]}`},Q=()=>{S("refresh")},m=a=>{S("time-range-change",a)},s=()=>{w.value&&(_=xe(w.value),window.addEventListener("resize",o),i())},i=()=>{if(!_)return;const a=z.value;if(a.length===0){_.clear();return}const c=U(()=>D.warningThreshold??80),n=U(()=>D.dangerThreshold??90),f={title:{show:!1},tooltip:{trigger:"axis",formatter:function(p){const k=p[0],u=k.data.detail;let v="";return v+=`${k.marker}${e("hub0000.disk.usage")}: <b>${k.data.value}%</b><br/>`,v+=`<br/>${e("hub0000.disk.details")}:<br/>`,v+=`${e("hub0000.disk.partitionCount")}: ${u.partitionCount}<br/>`,v+=`${e("hub0000.disk.totalSpace")}: ${O(u.totalSpace)}<br/>`,v+=`${e("hub0000.disk.usedSpace")}: ${O(u.usedSpace)}<br/>`,v+=`${e("hub0000.disk.freeSpace")}: ${O(u.freeSpace)}<br/>`,u.partitions.length>0&&(v+=`<br/>${e("hub0000.disk.partitionDetails")}:<br/>`,u.partitions.slice(0,3).forEach(L=>{v+=`${L.mountPoint}: ${L.usagePercent.toFixed(1)}% (${O(L.usedSpace)}/${O(L.totalSpace)})<br/>`}),u.partitions.length>3&&(v+=`... ${e("hub0000.disk.morePartitions",{count:u.partitions.length-3})}`)),v}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:a.map(p=>q(new Date(p.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:e("hub0000.disk.usage"),type:"line",data:a.map(p=>({value:p.value,detail:p.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#faad14"},itemStyle:{color:function(p){const k=p.data.value;return k>=n.value?"#ff4d4f":(k>=c.value,"#faad14")}},areaStyle:{color:new Ke(0,0,0,1,[{offset:0,color:"rgba(250, 173, 20, 0.3)"},{offset:1,color:"rgba(250, 173, 20, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:c.value,label:{formatter:`${e("hub0000.disk.warning")} ${c.value}%`,position:"start"}},{yAxis:n.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`${e("hub0000.disk.danger")} ${n.value}%`,position:"start"}}]}}]};_.setOption(f)},o=()=>{_==null||_.resize()};return ue(()=>D.data,()=>{i()},{deep:!0}),ve(()=>{s(),S("time-range-change",A.value)}),ye(()=>{_&&(_.dispose(),_=null),window.removeEventListener("resize",o)}),(a,c)=>(Y(),we(t(he),{title:d.value,bordered:!1,class:"monitor-card"},{"header-extra":M(()=>[y("div",yt,[g(t(_e),{value:A.value,"onUpdate:value":[c[0]||(c[0]=n=>A.value=n),m],type:"datetimerange",shortcuts:E.value,placeholder:t(e)("hub0000.common.selectTimeRange"),size:"small"},null,8,["value","shortcuts","placeholder"]),g(t(Me),{size:"small",onClick:Q,loading:r.loading},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[oe(" "+te(t(e)("hub0000.common.refresh")),1)]),_:1},8,["loading"])])]),default:M(()=>[y("div",wt,[y("div",{ref_key:"chartRef",ref:w,class:"chart-element"},null,512),r.loading?(Y(),j("div",bt,[g(t(be),{size:"large"})])):ae("",!0),!r.loading&&!z.value.length?(Y(),j("div",Mt,[g(t(ge),{description:t(e)("hub0000.common.noData")},null,8,["description"])])):ae("",!0)])]),_:1},8,["title"]))}}),St=De(Dt,[["__scopeId","data-v-d7f5b2b1"]]),Tt={class:"card-extra"},kt={class:"chart-container"},_t={key:0,class:"chart-loading"},$t={key:1,class:"chart-empty"},xt={key:0,class:"detail-section"},Ct=pe({__name:"DiskIOMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},diskIODetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(r,{emit:x}){$e([Ce,Ie,Pe,Le,Re,Ae,Ne]);const{t:e}=Oe("hub0000"),D=P(null);let d=null;const S=r,w=x,_=Date.now(),b=_-3600*1e3,I=P([b,_]),A={[e("hub0000.timeRangeShortcuts.lastHour")]:()=>{const a=Date.now();return[a-3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last6Hours")]:()=>{const a=Date.now();return[a-6*3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last12Hours")]:()=>{const a=Date.now();return[a-12*3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last24Hours")]:()=>{const a=Date.now();return[a-24*3600*1e3,a]},[e("hub0000.timeRangeShortcuts.last7Days")]:()=>{const a=Date.now();return[a-168*3600*1e3,a]}},E={pageSize:5,page:1},z=U(()=>[{title:e("hub0000.diskIO.deviceName"),key:"deviceName"},{title:e("hub0000.diskIO.readBytesRate"),key:"readRate",render:a=>Ye(a.readRate)+"/s"},{title:e("hub0000.diskIO.writeBytesRate"),key:"writeRate",render:a=>Ye(a.writeRate)+"/s"},{title:e("hub0000.diskIO.readCount"),key:"readCount"},{title:e("hub0000.diskIO.writeCount"),key:"writeCount"},{title:e("hub0000.diskIO.collectTime"),key:"collectTime",render:a=>q(a.collectTime)}]),O=U(()=>{if(!S.diskIODetailData)return[];const a=new Map;return S.diskIODetailData.forEach(c=>{const n=a.get(c.deviceName);(!n||new Date(c.collectTime)>new Date(n.collectTime))&&a.set(c.deviceName,c)}),Array.from(a.values())}),Q=()=>{D.value&&(d=xe(D.value),window.addEventListener("resize",s),m())},m=()=>{if(!d)return;if(!S.data||!Array.isArray(S.data)||S.data.length===0){d.clear();return}const a=new Map;S.data.forEach(u=>{var v;a.has(u.collectTime)||a.set(u.collectTime,new Map),(v=a.get(u.collectTime))==null||v.set(u.deviceName,u)});const c=Array.from(a.keys()).sort(),n=new Set;S.data.forEach(u=>n.add(u.deviceName));const f=[{read:"#1890ff",write:"#36cfc9"},{read:"#722ed1",write:"#eb2f96"},{read:"#fa8c16",write:"#faad14"},{read:"#52c41a",write:"#a0d911"},{read:"#f5222d",write:"#ff7a45"}],p=[];Array.from(n).forEach((u,v)=>{const C=v%f.length,L=f[C],Z=[],W=[];c.forEach(B=>{var re;const F=(re=a.get(B))==null?void 0:re.get(u);Z.push(F?F.readRate:0),W.push(F?F.writeRate:0)}),p.push({name:`${u} ${e("hub0000.diskIO.read")}`,type:"line",data:Z,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:L.read}}),p.push({name:`${u} ${e("hub0000.diskIO.write")}`,type:"line",data:W,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:L.write}})});const k={title:{show:!1},tooltip:{trigger:"axis",formatter:u=>{const v=Array.isArray(u)?u[0]:u,C=c[v.dataIndex];let L=q(C,"YYYY-MM-DD HH:mm:ss")+"<br/>";const Z=new Map;return u.forEach(W=>{var re;const F=W.seriesName.split(" ")[0];Z.has(F)||Z.set(F,[]),(re=Z.get(F))==null||re.push(W)}),Z.forEach((W,B)=>{L+=`<div style="margin-top: 3px;"><b>${B}</b></div>`,W.forEach(F=>{const re=F.color,V=F.seriesName.includes(e("hub0000.diskIO.read")),K=e(V?"hub0000.diskIO.read":"hub0000.diskIO.write"),h=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${re};border:1px solid ${re}"></span>`;L+=`<div style="padding-left: 12px;line-height:18px">${h}${K}: ${Ye(Number(F.value))}/s</div>`})}),L}},legend:{type:"scroll",bottom:0,padding:[10,20],selected:p.reduce((u,v)=>(u[v.name]=!0,u),{}),formatter:u=>{const v=u.split(" ")[0],C=u.includes(e("hub0000.diskIO.read"))?e("hub0000.diskIO.read"):e("hub0000.diskIO.write");return`${v} ${C}`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:c.map(u=>q(u,"HH:mm:ss")),axisLabel:{interval:Math.floor(c.length/10)}},yAxis:{type:"value",axisLabel:{formatter:u=>Ye(u)+"/s"}},series:p};d.setOption(k,!0)},s=()=>{d==null||d.resize()},i=()=>{w("refresh")},o=a=>{w("time-range-change",a)};return ue(()=>S.data,()=>{m()},{deep:!0}),ve(()=>{Q(),w("time-range-change",I.value)}),ye(()=>{d&&(d.dispose(),d=null),window.removeEventListener("resize",s)}),(a,c)=>(Y(),we(t(he),{title:t(e)("hub0000.diskIO.title"),bordered:!1,class:"monitor-card"},{"header-extra":M(()=>[y("div",Tt,[g(t(_e),{value:I.value,"onUpdate:value":[c[0]||(c[0]=n=>I.value=n),o],type:"datetimerange",shortcuts:A,placeholder:t(e)("common.selectTimeRange"),size:"small"},null,8,["value","placeholder"]),g(t(Me),{size:"small",onClick:i,loading:r.loading},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[oe(" "+te(t(e)("common.refresh")),1)]),_:1},8,["loading"])])]),default:M(()=>[y("div",kt,[y("div",{ref_key:"chartRef",ref:D,class:"chart-element"},null,512),r.loading?(Y(),j("div",_t,[g(t(be),{size:"large"})])):ae("",!0),!r.loading&&(!r.data||!Array.isArray(r.data)||r.data.length===0)?(Y(),j("div",$t,[g(t(ge),{description:t(e)("common.noData")},null,8,["description"])])):ae("",!0)]),r.diskIODetailData&&r.diskIODetailData.length>0?(Y(),j("div",xt,[g(t(Je),null,{default:M(()=>[oe(te(t(e)("hub0000.diskIO.detailTitle")),1)]),_:1}),g(t(st),{columns:z.value,data:O.value,pagination:E,bordered:!1,size:"small"},null,8,["columns","data"])])):ae("",!0)]),_:1},8,["title"]))}}),It=De(Ct,[["__scopeId","data-v-c9355b22"]]),Pt={class:"card-extra"},Lt={class:"chart-container"},Rt={key:0,class:"chart-loading"},At={key:1,class:"chart-empty"},Nt=pe({__name:"NetworkMonitor",props:{title:{},data:{},loading:{type:Boolean},uploadColor:{},downloadColor:{}},emits:["refresh","time-range-change"],setup(r,{emit:x}){$e([Ce,Ie,Pe,Le,Re,Ae,Ne]);const e=r,D={title:"网络流量"},d=x,S=P(null);let w=null;const _=Date.now(),b=_-3600*1e3,I=P([b,_]),A={最近1小时:()=>{const o=Date.now();return[o-3600*1e3,o]},最近6小时:()=>{const o=Date.now();return[o-6*3600*1e3,o]},最近12小时:()=>{const o=Date.now();return[o-12*3600*1e3,o]},最近24小时:()=>{const o=Date.now();return[o-24*3600*1e3,o]},最近7天:()=>{const o=Date.now();return[o-168*3600*1e3,o]}},E=U(()=>{if(!e.data||e.data.length===0)return[];const o=new Map;return e.data.forEach(a=>{const c=a.collectTime;o.has(c)||o.set(c,{interfaces:[]}),o.get(c).interfaces.push(a)}),Array.from(o.entries()).sort((a,c)=>new Date(a[0]).getTime()-new Date(c[0]).getTime()).map(([a,c])=>({time:a,detail:{interfaces:c.interfaces,interfaceCount:c.interfaces.length}}))}),z=o=>o===0?"0 B/s":o<1024?`${o.toFixed(2)} B/s`:o<1024*1024?`${(o/1024).toFixed(2)} KB/s`:o<1024*1024*1024?`${(o/(1024*1024)).toFixed(2)} MB/s`:`${(o/(1024*1024*1024)).toFixed(2)} GB/s`,O=()=>{d("refresh")},Q=o=>{d("time-range-change",o)},m=()=>{S.value&&(w=xe(S.value),window.addEventListener("resize",i),s())},s=()=>{if(!w)return;const o=E.value;if(o.length===0){w.clear();return}const a=o.map(C=>q(new Date(C.time),"HH:mm:ss")),c=new Set,n=[],f=[];o.forEach(C=>{C.detail.interfaces.forEach(L=>{c.has(L.interfaceName)||(L.ipAddresses&&L.ipAddresses.includes(".")&&!L.ipAddresses.includes(":")||L.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?n.push(L.interfaceName):f.push(L.interfaceName),c.add(L.interfaceName))})});const p=[...n,...f],k=[{send:"#fa541c",receive:"#73d13d"},{send:"#722ed1",receive:"#13c2c2"},{send:"#f5222d",receive:"#52c41a"},{send:"#fa8c16",receive:"#1890ff"},{send:"#eb2f96",receive:"#fadb14"}],u=[];p.forEach((C,L)=>{const Z=L%k.length,W=k[Z],B=o.map(V=>{const K=V.detail.interfaces.find(h=>h.interfaceName===C);return K?Math.round(K.sendRate/(1024*1024)*100)/100:0}),F=o.map(V=>{const K=V.detail.interfaces.find(h=>h.interfaceName===C);return K?Math.round(K.receiveRate/(1024*1024)*100)/100:0}),re=n.includes(C)?2:1;u.push({name:`${C} 上传`,type:"line",data:B,smooth:!0,showSymbol:!1,lineStyle:{width:re,type:"solid"},itemStyle:{color:W.send},emphasis:{focus:"series"},tooltip:{valueFormatter:V=>`${V} MB/s`}}),u.push({name:`${C} 下载`,type:"line",data:F,smooth:!0,showSymbol:!1,lineStyle:{width:re,type:"dashed"},itemStyle:{color:W.receive},emphasis:{focus:"series"},tooltip:{valueFormatter:V=>`${V} MB/s`}})});const v={title:{show:!1},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(C){var re;const L=C[0].axisValue,Z=a.indexOf(L),W=(re=o[Z])==null?void 0:re.detail;let B=`${L}<br/>`;const F=new Map;if(C.forEach(V=>{const h=V.seriesName.split(" ")[0];F.has(h)||F.set(h,[]),F.get(h).push(V)}),W){const V=new Set;F.forEach((N,G)=>{V.add(G)}),W.interfaces.forEach(N=>{V.add(N.interfaceName)}),B+=`接口总数: ${W.interfaceCount}<br/>`;const K=[],h=[];Array.from(V).forEach(N=>{const G=W.interfaces.find(He=>He.interfaceName===N);if(!G)return;G.ipAddresses&&G.ipAddresses.includes(".")&&!G.ipAddresses.includes(":")||G.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?K.push(N):h.push(N)});const T=[...K,...h];T.length>0&&(B+="<br/>接口详情:<br/>",T.forEach(N=>{const G=W.interfaces.find(He=>He.interfaceName===N);if(!G)return;B+='<div style="padding:3px 0;border-bottom:1px solid #eee;">',B+=`<b>${N}</b>: `,K.includes(N)&&(B+='<span style="color:#1890ff;">[IPv4]</span> '),B+=`<br/><span style="padding-left:10px;color:#ff4d4f;">↑${z(G.sendRate)}</span> `,B+=`<span style="padding-left:5px;color:#52c41a;">↓${z(G.receiveRate)}</span>`,(G.errorsReceived>0||G.errorsSent>0)&&(B+=` <span style="color:#ff7875;">(错误: ${G.errorsReceived+G.errorsSent})</span>`),G.ipAddresses&&(B+=`<br/><span style="padding-left:10px;color:#999;font-size:12px;">IP: ${G.ipAddresses}</span>`),B+="</div>"}))}return B}},legend:{type:"scroll",data:u.map(C=>C.name),bottom:0,padding:[5,10],selected:u.reduce((C,L)=>{const Z=L.name.split(" ")[0];return C[L.name]=n.includes(Z),C},{})},grid:{left:"3%",right:"4%",bottom:"40px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:a,axisLabel:{rotate:45}},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:C=>C.toFixed(2)+" MB/s"}},series:u};w.setOption(v)},i=()=>{w==null||w.resize()};return ue(()=>e.data,()=>{s()},{deep:!0}),ve(()=>{m(),d("time-range-change",I.value)}),ye(()=>{w&&(w.dispose(),w=null),window.removeEventListener("resize",i)}),(o,a)=>(Y(),we(t(he),{title:r.title||D.title,bordered:!1,class:"monitor-card"},{"header-extra":M(()=>[y("div",Pt,[g(t(_e),{value:I.value,"onUpdate:value":[a[0]||(a[0]=c=>I.value=c),Q],type:"datetimerange",shortcuts:A,placeholder:"选择时间范围",size:"small"},null,8,["value"]),g(t(Me),{size:"small",onClick:O,loading:r.loading},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[a[1]||(a[1]=oe(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:M(()=>[y("div",Lt,[y("div",{ref_key:"chartRef",ref:S,class:"chart-element"},null,512),r.loading?(Y(),j("div",Rt,[g(t(be),{size:"large"})])):ae("",!0),!r.loading&&!E.value.length?(Y(),j("div",At,[g(t(ge),{description:"暂无数据"})])):ae("",!0)])]),_:1},8,["title"]))}}),zt=De(Nt,[["__scopeId","data-v-ad4fba78"]]),Ot={class:"card-extra"},Ht={class:"chart-container"},Yt={key:0,class:"chart-loading"},Et={key:1,class:"chart-empty"},Ut=pe({__name:"ProcessMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},processDetailData:{type:Array,default:()=>[]},cpuColor:{type:String,default:"#1890ff"},memoryColor:{type:String,default:"#52c41a"}},emits:["refresh","time-range-change"],setup(r,{emit:x}){$e([Ce,Ie,Pe,Le,Re,Ae,Ne]);const{t:e}=Oe("hub0000"),D=P(null);let d=null;const S=r,w=x,_=Date.now(),b=_-3600*1e3,I=P([b,_]),A={最近1小时:()=>{const s=Date.now();return[s-3600*1e3,s]},最近6小时:()=>{const s=Date.now();return[s-6*3600*1e3,s]},最近12小时:()=>{const s=Date.now();return[s-12*3600*1e3,s]},最近24小时:()=>{const s=Date.now();return[s-24*3600*1e3,s]},最近7天:()=>{const s=Date.now();return[s-168*3600*1e3,s]}},E=()=>{D.value&&(d=xe(D.value),window.addEventListener("resize",O),z())},z=()=>{if(!d)return;if(!S.data||S.data.length===0){d.clear();return}const s=new Map;S.data.forEach(n=>{var f;s.has(n.collectTime)||s.set(n.collectTime,[]),(f=s.get(n.collectTime))==null||f.push(n)});const i=Array.from(s.keys()).sort(),o=[],a=[];i.forEach(n=>{const f=s.get(n)||[];if(f.length>0){const p=f.reduce((u,v)=>u+v.cpuPercent,0)/f.length,k=f.reduce((u,v)=>u+v.memoryPercent,0)/f.length;o.push(Number(p.toFixed(2))),a.push(Number(k.toFixed(2)))}else o.push(0),a.push(0)});const c={tooltip:{trigger:"axis",formatter:n=>{const f=n[0].dataIndex,p=s.get(i[f])||[];let k=q(i[f],"YYYY-MM-DD HH:mm:ss")+"<br/>";return n.forEach(u=>{const C=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${u.color};"></span>`;k+=C+u.seriesName+": "+u.value+"%<br/>"}),p.length>0&&(k+=`<span style="color:#666;">进程数量: ${p.length}</span><br/>`),p.length>0&&(k+="<br/><b>"+e("hub0000.process.detailTitle")+"</b><br/>",[...p].sort((v,C)=>C.cpuPercent-v.cpuPercent).slice(0,5).forEach((v,C)=>{k+='<div style="padding-left:10px;margin:2px 0;">',k+=`<b>${C+1}. ${v.processName}</b> <span style="color:#666;">(PID: ${v.processId})</span><br/>`,k+=`<span style="padding-left:15px;">CPU: ${v.cpuPercent.toFixed(2)}%, `,k+=`内存: ${v.memoryPercent.toFixed(2)}%, `,k+=`线程: ${v.threadCount}</span>`,k+="</div>"}),p.length>5&&(k+=`<div style="padding-left:10px;color:#999;">... 以及 ${p.length-5} 个其他进程</div>`)),k}},legend:{data:[e("hub0000.process.avgCpu"),e("hub0000.process.avgMemory")],bottom:0,padding:[10,20]},grid:{left:"3%",right:"4%",bottom:"15%",top:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:i.map(n=>q(n,"HH:mm:ss")),axisLabel:{interval:Math.floor(i.length/10)}},yAxis:{type:"value",min:0,max:100,position:"left",axisLabel:{formatter:"{value}%"}},series:[{name:e("hub0000.process.avgCpu"),type:"line",data:o,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:S.cpuColor}},{name:e("hub0000.process.avgMemory"),type:"line",data:a,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:S.memoryColor}}]};d.setOption(c)},O=()=>{d==null||d.resize()},Q=()=>{w("refresh")},m=s=>{w("time-range-change",s)};return ue(()=>S.data,()=>{z()},{deep:!0}),ve(()=>{E(),w("time-range-change",I.value)}),ye(()=>{d&&(d.dispose(),d=null),window.removeEventListener("resize",O)}),(s,i)=>(Y(),we(t(he),{title:t(e)("hub0000.process.title"),bordered:!1,class:"monitor-card"},{"header-extra":M(()=>[y("div",Ot,[g(t(_e),{value:I.value,"onUpdate:value":[i[0]||(i[0]=o=>I.value=o),m],type:"datetimerange",shortcuts:A,placeholder:t(e)("common.selectTimeRange"),size:"small"},null,8,["value","placeholder"]),g(t(Me),{size:"small",onClick:Q,loading:r.loading},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[oe(" "+te(t(e)("common.refresh")),1)]),_:1},8,["loading"])])]),default:M(()=>{var o;return[y("div",Ht,[y("div",{ref_key:"chartRef",ref:D,class:"chart-element"},null,512),r.loading?(Y(),j("div",Yt,[g(t(be),{size:"large"})])):ae("",!0),!r.loading&&!((o=r.data)!=null&&o.length)?(Y(),j("div",Et,[g(t(ge),{description:t(e)("common.noData")},null,8,["description"])])):ae("",!0)])]}),_:1},8,["title"]))}}),qt=De(Ut,[["__scopeId","data-v-e0bbaa0b"]]),Ft=(r={})=>{const{initialPage:x=ze.DEFAULT_PAGE_INDEX,initialPageSize:e=ze.DEFAULT_PAGE_SIZE,pageSizes:D=ze.PAGE_SIZES,showSizePicker:d=ze.SHOW_SIZE_PICKER,showQuickJumper:S=ze.SHOW_QUICK_JUMPER,onPageChange:w,onPageSizeChange:_}=r,b=Qe({page:x,pageSize:e,total:0,totalPages:0}),I=U(()=>({pageIndex:b.page,pageSize:b.pageSize})),A=U(()=>({page:b.page,pageSize:b.pageSize,itemCount:b.total,showSizePicker:d,pageSizes:D,showQuickJumper:S,prefix:()=>`共 ${b.total} 条`,onUpdatePage:E,onUpdatePageSize:z})),E=a=>{b.page=a,w==null||w(a,b.pageSize)},z=a=>{b.pageSize=a,b.page=1,_==null||_(1,a)},O=a=>{b.page=a.pageIndex||1,b.pageSize=a.pageSize||e,b.total=a.totalCount||0,b.totalPages=a.totalPageIndex||0},Q=()=>{b.page=x,b.pageSize=e,b.total=0,b.totalPages=0},m=a=>{b.total=a,b.totalPages=Math.ceil(a/b.pageSize)},s=a=>{a>=1&&a<=b.totalPages&&E(a)},i=()=>({page:b.page,pageSize:b.pageSize,total:b.total,totalPages:b.totalPages,hasNext:b.page<b.totalPages,hasPrev:b.page>1}),o=()=>{};return{pagination:b,queryParams:I,naiveConfig:A,updatePagination:O,resetPagination:Q,setTotal:m,goToPage:s,getCurrentPageInfo:i,cleanup:o,handlePageChange:E,handlePageSizeChange:z}};var ke=(r=>(r.ONLINE="online",r.OFFLINE="offline",r.WARNING="warning",r.CRITICAL="critical",r))(ke||{});const ee=We("SystemMonitorModel"),Bt=()=>{const r=P([]),x=P([]),e=P(!1),D=P(null),d=P([]),S=P([]),w=P(!1),_=P([]),b=P([]),I=P(!1),A=P([]),E=P([]),z=P(!1),O=P([]),Q=P(!1),m=P([]),s=P([]),i=P(!1),o=P([]),a=P(!1),c=P([]),n=P(!1),f=Qe({pageNum:1,pageSize:200,activeFlag:"Y"}),p=Ft(),k=U(()=>{const l=new Date,J=300*1e3;return r.value.filter(R=>{const H=d.value.filter(se=>se.metricServerId===R.metricServerId).sort((se,me)=>new Date(me.collectTime).getTime()-new Date(se.collectTime).getTime())[0];if(!H)return!1;const X=new Date(H.collectTime);return l.getTime()-X.getTime()<=J}).length}),u=U(()=>r.value.length-k.value),v=U(()=>{if(d.value.length===0)return 0;const l=new Map;d.value.forEach(R=>{const H=l.get(R.metricServerId);(!H||new Date(R.collectTime)>new Date(H.collectTime))&&l.set(R.metricServerId,R)});const J=Array.from(l.values()).reduce((R,H)=>R+H.usagePercent,0);return Math.round(J/l.size*100)/100}),C=U(()=>{if(_.value.length===0)return 0;const l=new Map;_.value.forEach(R=>{const H=l.get(R.metricServerId);(!H||new Date(R.collectTime)>new Date(H.collectTime))&&l.set(R.metricServerId,R)});const J=Array.from(l.values()).reduce((R,H)=>R+H.usagePercent,0);return Math.round(J/l.size*100)/100}),L=U(()=>{if(A.value.length===0)return 0;const l=new Map;A.value.forEach(R=>{const H=l.get(R.metricServerId);(!H||new Date(R.collectTime)>new Date(H.collectTime))&&l.set(R.metricServerId,R)});const J=Array.from(l.values()).reduce((R,H)=>R+H.usagePercent,0);return Math.round(J/l.size*100)/100}),Z=U(()=>{const l={online:0,offline:0,warning:0,critical:0},J=new Date,R=300*1e3,H=600*1e3;return r.value.forEach(X=>{const se=d.value.filter(fe=>fe.metricServerId===X.metricServerId).sort((fe,Ue)=>new Date(Ue.collectTime).getTime()-new Date(fe.collectTime).getTime())[0],me=_.value.filter(fe=>fe.metricServerId===X.metricServerId).sort((fe,Ue)=>new Date(Ue.collectTime).getTime()-new Date(fe.collectTime).getTime())[0];if(!se||!me){l.offline++;return}const Ee=new Date(se.collectTime),Fe=J.getTime()-Ee.getTime();Fe>H?l.offline++:Fe>R?l.warning++:se.usagePercent>90||me.usagePercent>90?l.critical++:l.online++}),l});return{serverList:r,selectedServerIds:x,serverListLoading:e,currentServer:D,cpuMetrics:d,cpuTrendData:S,cpuLoading:w,memoryMetrics:_,memoryTrendData:b,memoryLoading:I,diskMetrics:A,diskTrendData:E,diskLoading:z,diskIOMetrics:O,diskIOLoading:Q,networkMetrics:m,networkTrendData:s,networkLoading:i,processMetrics:o,processLoading:a,temperatureMetrics:c,temperatureLoading:n,queryParams:f,pagination:p,onlineServerCount:k,offlineServerCount:u,currentCpuUsage:v,currentMemoryUsage:C,currentDiskUsage:L,serverStatusDistribution:Z,setServerList:l=>{r.value=l,ee.info("设置服务器列表数据",{count:l.length})},setCurrentServer:l=>{D.value=l,ee.info("设置当前服务器",{serverId:l==null?void 0:l.metricServerId})},upsertServerData:l=>{const J=r.value.findIndex(R=>R.metricServerId===l.metricServerId);J>=0?r.value[J]=l:r.value.push(l),ee.info("更新服务器数据",{serverId:l.metricServerId})},removeServerData:l=>{const J=r.value.findIndex(R=>R.metricServerId===l);J>=0&&r.value.splice(J,1),ee.info("删除服务器数据",{serverId:l})},setCpuMetrics:l=>{d.value=l,ee.info("设置CPU监控数据",{count:l.length})},setCpuTrendData:l=>{S.value=l,ee.info("设置CPU趋势数据",{count:l.length})},setMemoryMetrics:l=>{_.value=l,ee.info("设置内存监控数据",{count:l.length})},setMemoryTrendData:l=>{b.value=l,ee.info("设置内存趋势数据",{count:l.length})},setDiskMetrics:l=>{A.value=l,ee.info("设置磁盘监控数据",{count:l.length})},setDiskTrendData:l=>{E.value=l,ee.info("设置磁盘趋势数据",{count:l.length})},setDiskIOMetrics:l=>{O.value=l,ee.info("设置磁盘IO指标数据",{count:l.length})},setNetworkMetrics:l=>{m.value=l,ee.info("设置网络监控数据",{count:l.length})},setNetworkTrendData:l=>{s.value=l,ee.info("设置网络趋势数据",{count:l.length})},setProcessMetrics:l=>{o.value=l,ee.info("设置进程监控数据",{count:l.length})},setTemperatureMetrics:l=>{c.value=l,ee.info("设置温度监控数据",{count:l.length})},clearAllMetrics:()=>{d.value=[],S.value=[],_.value=[],b.value=[],A.value=[],E.value=[],O.value=[],m.value=[],s.value=[],o.value=[],c.value=[],ee.info("已清空所有监控数据")},updateQueryParams:l=>{Object.assign(f,l),ee.info("更新查询参数",l)},resetQueryParams:()=>{Object.assign(f,{pageNum:1,pageSize:20,activeFlag:"Y"}),ee.info("重置查询参数")},getServerStatus:l=>{const J=new Date,R=300*1e3,H=d.value.filter(me=>me.metricServerId===l).sort((me,Ee)=>new Date(Ee.collectTime).getTime()-new Date(me.collectTime).getTime())[0];if(!H)return ke.OFFLINE;const X=new Date(H.collectTime);return J.getTime()-X.getTime()>R?ke.OFFLINE:H.usagePercent>90?ke.CRITICAL:H.usagePercent>80?ke.WARNING:ke.ONLINE},getServerLatestMetrics:l=>{const J=d.value.filter(X=>X.metricServerId===l).sort((X,se)=>new Date(se.collectTime).getTime()-new Date(X.collectTime).getTime())[0],R=_.value.filter(X=>X.metricServerId===l).sort((X,se)=>new Date(se.collectTime).getTime()-new Date(X.collectTime).getTime())[0],H=A.value.filter(X=>X.metricServerId===l).sort((X,se)=>new Date(se.collectTime).getTime()-new Date(X.collectTime).getTime())[0];return{cpu:J,memory:R,disk:H}}}},de=je("/gateway/hub0000"),Gt=r=>de.post("/server/query",r),Qt=r=>de.post("/server/detail",r),Wt=r=>de.post("/cpu/query",r),Vt=r=>de.post("/memory/query",r),Kt=r=>de.post("/disk/partition/query",r),Jt=r=>de.post("/disk/io/query",r),jt=r=>de.post("/network/query",r),Zt=r=>de.post("/process/query",r),Xt=r=>de.post("/temperature/query",r),ea=r=>de.post("/export",r),$=We("SystemMonitorManagement"),ta=r=>{const x=Ve(),e=P(!1),D=async m=>{try{r.serverListLoading.value=!0;const s={...r.queryParams,...m};$.info("开始加载服务器列表",s);const i=await Gt(s);if(ie(i)){const o=le(i,[]);return r.setServerList(o),x.success("服务器列表加载成功"),$.info("服务器列表加载成功",{count:o.length}),o}else{const o=ce(i,"加载服务器列表失败");return x.error(o),$.error("加载服务器列表失败",{error:o}),[]}}catch(s){const i="加载服务器列表异常";return x.error(i),$.error(i,s),[]}finally{r.serverListLoading.value=!1}},d=async m=>{try{e.value=!0,$.info("开始获取服务器详情",{serverId:m});const s=await Qt({metricServerId:m});if(ie(s)){const i=le(s);return $.info("获取服务器详情成功",{serverId:m}),i}else{const i=ce(s,"获取服务器详情失败");return x.error(i),$.error("获取服务器详情失败",{serverId:m,error:i}),null}}catch(s){const i="获取服务器详情异常";return x.error(i),$.error(i,{serverId:m,error:s}),null}finally{e.value=!1}},S=()=>r.serverList.value.length>0?r.serverList.value[0].metricServerId:"",w=async m=>{try{r.cpuLoading.value=!0,$.info("开始加载CPU监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await Wt(s);if(ie(i)){const o=le(i,[]);r.setCpuMetrics(o),$.info("CPU监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载CPU监控数据失败");$.error("加载CPU监控数据失败",{error:o})}}catch(s){$.error("加载CPU监控数据异常",s)}finally{r.cpuLoading.value=!1}},_=async m=>{try{r.memoryLoading.value=!0,$.info("开始加载内存监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await Vt(s);if(ie(i)){const o=le(i,[]);r.setMemoryMetrics(o),$.info("内存监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载内存监控数据失败");$.error("加载内存监控数据失败",{error:o})}}catch(s){$.error("加载内存监控数据异常",s)}finally{r.memoryLoading.value=!1}},b=async m=>{try{r.diskLoading.value=!0,$.info("开始加载磁盘监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await Kt(s);if(ie(i)){const o=le(i,[]);r.setDiskMetrics(o),$.info("磁盘监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载磁盘监控数据失败");$.error("加载磁盘监控数据失败",{error:o})}}catch(s){$.error("加载磁盘监控数据异常",s)}finally{r.diskLoading.value=!1}},I=async m=>{try{r.networkLoading.value=!0,$.info("开始加载网络监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await jt(s);if(ie(i)){const o=le(i,[]);r.setNetworkMetrics(o),$.info("网络监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载网络监控数据失败");$.error("加载网络监控数据失败",{error:o})}}catch(s){$.error("加载网络监控数据异常",s)}finally{r.networkLoading.value=!1}},A=async m=>{try{r.processLoading.value=!0,$.info("开始加载进程监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await Zt(s);if(ie(i)){const o=le(i,[]);r.setProcessMetrics(o),$.info("进程监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载进程监控数据失败");$.error("加载进程监控数据失败",{error:o})}}catch(s){$.error("加载进程监控数据异常",s)}finally{r.processLoading.value=!1}},E=async m=>{try{r.temperatureLoading.value=!0,$.info("开始加载温度监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await Xt(s);if(ie(i)){const o=le(i,[]);r.setTemperatureMetrics(o),$.info("温度监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载温度监控数据失败");$.error("加载温度监控数据失败",{error:o})}}catch(s){$.error("加载温度监控数据异常",s)}finally{r.temperatureLoading.value=!1}},z=async m=>{try{r.diskIOLoading.value=!0,$.info("开始加载磁盘IO监控数据",{serverId:m});const s={...m?{metricServerId:m}:{},...r.queryParams},i=await Jt(s);if(ie(i)){const o=le(i,[]);r.setDiskIOMetrics(o),$.info("磁盘IO监控数据加载成功",{count:o.length})}else{const o=ce(i,"加载磁盘IO监控数据失败");$.error("加载磁盘IO监控数据失败",{error:o})}}catch(s){$.error("加载磁盘IO监控数据异常",s)}finally{r.diskIOLoading.value=!1}};return{operationLoading:e,loadServerList:D,getServerInfo:d,getDefaultServerId:S,loadCPUMetrics:w,loadMemoryMetrics:_,loadDiskMetrics:b,loadDiskIOMetrics:z,loadNetworkMetrics:I,loadProcessMetrics:A,loadTemperatureMetrics:E,loadAllMetrics:async m=>{if(!m){$.warn("未提供服务器ID，无法加载监控数据");return}try{e.value=!0,$.info("开始加载所有监控数据",{serverId:m}),await Promise.all([w(m),_(m),b(m),z(m),I(m),A(m),E(m)]),$.info("所有监控数据加载成功")}catch(s){throw $.error("加载所有监控数据异常",s),s}finally{e.value=!1}},exportData:async m=>{try{e.value=!0,$.info("开始导出监控数据",m);const s=await ea(m);if(ie(s)){const i=le(s);return x.success("数据导出成功"),$.info("数据导出成功",{downloadUrl:i}),i}else{const i=ce(s,"导出监控数据失败");return x.error(i),$.error("导出监控数据失败",{error:i}),null}}catch(s){const i="导出监控数据异常";return x.error(i),$.error(i,s),null}finally{e.value=!1}}}},aa={class:"system-monitoring"},ra={class:"server-selector"},sa={class:"selector-content"},oa={key:0,class:"overview-cards"},na={class:"overview-grid"},ia={class:"overview-item"},la={class:"overview-icon hostname"},ca={class:"overview-content"},ua={class:"overview-value text-truncate"},da={class:"overview-item"},ma={class:"overview-icon os"},ha={class:"overview-content"},ga={class:"overview-value text-truncate"},fa={class:"overview-item"},pa={class:"overview-icon version"},va={class:"overview-content"},ya={class:"overview-value text-truncate"},wa={class:"overview-item"},ba={class:"overview-icon architecture"},Ma={class:"overview-content"},Da={class:"overview-value text-truncate"},Sa={class:"overview-item"},Ta={class:"overview-icon server-type"},ka={class:"overview-content"},_a={class:"overview-value text-truncate"},$a={class:"overview-item"},xa={class:"overview-icon ip"},Ca={class:"overview-content"},Ia={class:"overview-value text-truncate"},Pa={key:1,class:"loading-container"},La={key:2,class:"charts-container"},Ra={class:"chart-row"},Aa={class:"chart-item"},Na={class:"chart-item"},za={class:"chart-row"},Oa={class:"chart-item"},Ha={class:"chart-item"},Ya={class:"chart-row"},Ea={class:"chart-item"},Ua={class:"chart-item"},qa={key:3,class:"no-data-container"},Fa={key:4,class:"no-data-container"},Ba=pe({__name:"SystemMonitoring",setup(r){const x=Ve(),e=Bt(),D=ta(e),d=P(""),S=P(!0),w=U(()=>d.value&&e.serverList.value.find(h=>h.metricServerId===d.value)||null),_=h=>({physical:"物理机",virtual:"虚拟机",unknown:"未知"})[h||"unknown"]||"未知",b=h=>{const T=h.toLowerCase();return T.includes("windows")?at:T.includes("linux")?Be:T.includes("mac")||T.includes("darwin")?rt:Ge},I=h=>{if(!h)return"N/A";if(h.toLowerCase().includes("windows")){const T=h.match(/Windows (\d+(?:\.\d+)?)/i);if(T){const N=T[1],G=h.match(/Windows \d+(?:\.\d+)?\s+(\w+)/i);return G?`Windows ${N} ${G[1]}`:`Windows ${N}`}}return h.length>20?h.substring(0,17)+"...":h},A=U(()=>[...[{label:"全部服务器",value:""}],...e.serverList.value.map(T=>({label:`${T.hostname} (${T.ipAddress||"N/A"})`,value:T.metricServerId}))]),E=async h=>{if(h){const[T,N]=h;e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(N,"YYYY-MM-DD HH:mm:ss")}),await D.loadCPUMetrics(d.value)}},z=async h=>{if(h){const[T,N]=h;e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(N,"YYYY-MM-DD HH:mm:ss")}),await D.loadMemoryMetrics(d.value)}},O=async h=>{if(h){const[T,N]=h;e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(N,"YYYY-MM-DD HH:mm:ss")}),await D.loadDiskMetrics(d.value)}},Q=async h=>{if(h){const[T,N]=h;e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(N,"YYYY-MM-DD HH:mm:ss")}),await D.loadNetworkMetrics(d.value)}},m=async h=>{if(h){const[T,N]=h;e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(N,"YYYY-MM-DD HH:mm:ss")}),await D.loadDiskIOMetrics(d.value)}},s=async h=>{if(h){const[T,N]=h;e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(N,"YYYY-MM-DD HH:mm:ss")}),await D.loadProcessMetrics(d.value)}};ue(()=>e.pagination.pagination.page,h=>{e.queryParams.pageNum=h,i()}),ue(()=>e.pagination.pagination.pageSize,h=>{e.queryParams.pageSize=h,i()}),ue(()=>({tenantId:e.queryParams.tenantId,hostname:e.queryParams.hostname,osType:e.queryParams.osType,serverType:e.queryParams.serverType,activeFlag:e.queryParams.activeFlag}),()=>{S.value||i()},{deep:!0});const i=async()=>{try{const h=await D.loadServerList();!d.value&&h.length>0&&(d.value=h[0].metricServerId,await o(h[0].metricServerId))}catch(h){console.error("加载服务器列表失败",h),x.error("加载服务器列表失败")}},o=async h=>{try{e.updateQueryParams({metricServerId:h,startTime:e.queryParams.startTime,endTime:e.queryParams.endTime}),await D.loadAllMetrics(h)}catch(T){console.error("加载服务器监控数据失败",T),x.error("加载服务器监控数据失败")}},a=async()=>{try{S.value=!0;const h=new Date,T=new Date(h.getTime()-3600*1e3);e.updateQueryParams({startTime:q(T,"YYYY-MM-DD HH:mm:ss"),endTime:q(h,"YYYY-MM-DD HH:mm:ss")}),await i()}catch(h){console.error("初始化数据失败",h),x.error("加载监控数据失败，请刷新页面重试")}finally{S.value=!1}},c=async h=>{if(h)try{K.value=!0,e.clearAllMetrics(),await o(h),x.success("服务器监控数据加载成功")}catch(T){console.error("加载服务器监控数据失败",T),x.error("加载服务器监控数据失败")}finally{K.value=!1}},n=async()=>{if(!d.value){x.warning("请先选择一个服务器");return}try{K.value=!0,await o(d.value),x.success("所有监控数据刷新成功")}catch(h){console.error("刷新监控数据失败",h),x.error("刷新监控数据失败")}finally{K.value=!1}},f=async()=>{await D.loadCPUMetrics(d.value),x.success("CPU数据刷新成功")},p=async()=>{await D.loadMemoryMetrics(d.value),x.success("内存数据刷新成功")},k=async()=>{await D.loadDiskMetrics(d.value),x.success("磁盘数据刷新成功")},u=async()=>{await D.loadNetworkMetrics(d.value),x.success("网络数据刷新成功")},v=async()=>{await D.loadDiskIOMetrics(d.value),x.success("磁盘IO数据刷新成功")},C=async()=>{await D.loadProcessMetrics(d.value),x.success("进程数据刷新成功")};ue(()=>e.serverList.value,h=>{h.length>0&&!d.value&&(d.value=h[0].metricServerId)}),ve(()=>{a()}),ye(()=>{console.log("SystemMonitoring组件已卸载")});const{serverListLoading:L,cpuLoading:Z,memoryLoading:W,diskLoading:B,diskIOLoading:F,networkLoading:re,processLoading:V}=e,{operationLoading:K}=D;return(h,T)=>(Y(),j("div",aa,[y("div",ra,[g(t(he),{title:"服务器选择",embedded:""},{default:M(()=>[y("div",sa,[g(t(ot),{value:d.value,"onUpdate:value":[T[0]||(T[0]=N=>d.value=N),c],options:A.value,placeholder:"选择服务器",loading:t(L),clearable:""},null,8,["value","options","loading"]),g(t(Me),{onClick:n,loading:t(K)},{icon:M(()=>[g(t(ne),null,{default:M(()=>[g(t(Se))]),_:1})]),default:M(()=>[T[1]||(T[1]=oe(" 刷新数据 ",-1))]),_:1},8,["loading"])])]),_:1})]),w.value?(Y(),j("div",oa,[g(t(he),{title:"服务器信息",embedded:""},{default:M(()=>[y("div",na,[y("div",ia,[y("div",la,[g(t(ne),{size:"24"},{default:M(()=>[g(t(Xe))]),_:1})]),y("div",ca,[T[2]||(T[2]=y("div",{class:"overview-label"},"主机名",-1)),g(t(Te),{"show-arrow":!1},{trigger:M(()=>[y("div",ua,te(w.value.hostname),1)]),default:M(()=>[oe(" "+te(w.value.hostname),1)]),_:1})])]),y("div",da,[y("div",ma,[g(t(ne),{size:"24"},{default:M(()=>[(Y(),we(Ze(b(w.value.osType))))]),_:1})]),y("div",ha,[T[3]||(T[3]=y("div",{class:"overview-label"},"操作系统",-1)),g(t(Te),{"show-arrow":!1},{trigger:M(()=>[y("div",ga,te(w.value.osType),1)]),default:M(()=>[oe(" "+te(w.value.osType),1)]),_:1})])]),y("div",fa,[y("div",pa,[g(t(ne),{size:"24"},{default:M(()=>[g(t(Be))]),_:1})]),y("div",va,[T[4]||(T[4]=y("div",{class:"overview-label"},"系统版本",-1)),g(t(Te),{"show-arrow":!1},{trigger:M(()=>[y("div",ya,te(I(w.value.osVersion)),1)]),default:M(()=>[oe(" "+te(w.value.osVersion),1)]),_:1})])]),y("div",wa,[y("div",ba,[g(t(ne),{size:"24"},{default:M(()=>[g(t(Ge))]),_:1})]),y("div",Ma,[T[5]||(T[5]=y("div",{class:"overview-label"},"系统架构",-1)),g(t(Te),{"show-arrow":!1},{trigger:M(()=>[y("div",Da,te(w.value.architecture),1)]),default:M(()=>[oe(" "+te(w.value.architecture),1)]),_:1})])]),y("div",Sa,[y("div",Ta,[g(t(ne),{size:"24"},{default:M(()=>[g(t(et))]),_:1})]),y("div",ka,[T[6]||(T[6]=y("div",{class:"overview-label"},"服务器类型",-1)),g(t(Te),{"show-arrow":!1},{trigger:M(()=>[y("div",_a,te(_(w.value.serverType)),1)]),default:M(()=>[oe(" "+te(_(w.value.serverType)),1)]),_:1})])]),y("div",$a,[y("div",xa,[g(t(ne),{size:"24"},{default:M(()=>[g(t(tt))]),_:1})]),y("div",Ca,[T[7]||(T[7]=y("div",{class:"overview-label"},"IP地址",-1)),g(t(Te),{"show-arrow":!1},{trigger:M(()=>[y("div",Ia,te(w.value.ipAddress||"N/A"),1)]),default:M(()=>[oe(" "+te(w.value.ipAddress||"N/A"),1)]),_:1})])])])]),_:1})])):ae("",!0),S.value?(Y(),j("div",Pa,[g(t(be),{size:"large"}),T[8]||(T[8]=y("p",null,"正在加载服务器监控数据，请稍候...",-1))])):ae("",!0),!S.value&&d.value?(Y(),j("div",La,[y("div",Ra,[y("div",Aa,[g(t(dt),{data:t(e).cpuMetrics.value,loading:t(Z),"warning-threshold":80,"danger-threshold":90,"cpu-detail-data":t(e).cpuMetrics.value,onRefresh:f,onTimeRangeChange:E},null,8,["data","loading","cpu-detail-data"])]),y("div",Na,[g(t(vt),{data:t(e).memoryMetrics.value,loading:t(W),"warning-threshold":80,"danger-threshold":90,"memory-detail-data":t(e).memoryMetrics.value,onRefresh:p,onTimeRangeChange:z},null,8,["data","loading","memory-detail-data"])])]),y("div",za,[y("div",Oa,[g(t(St),{data:t(e).diskMetrics.value,loading:t(B),"warning-threshold":80,"danger-threshold":90,"disk-detail-data":t(e).diskMetrics.value,onRefresh:k,onTimeRangeChange:O},null,8,["data","loading","disk-detail-data"])]),y("div",Ha,[g(t(It),{data:t(e).diskIOMetrics.value,loading:t(F),"disk-io-detail-data":t(e).diskIOMetrics.value,onRefresh:v,onTimeRangeChange:m},null,8,["data","loading","disk-io-detail-data"])])]),y("div",Ya,[y("div",Ea,[g(t(zt),{data:t(e).networkMetrics.value,loading:t(re),"network-detail-data":t(e).networkMetrics.value,"upload-color":"#ff4d4f","download-color":"#52c41a",onRefresh:u,onTimeRangeChange:Q},null,8,["data","loading","network-detail-data"])]),y("div",Ua,[g(t(qt),{data:t(e).processMetrics.value,loading:t(V),"process-detail-data":t(e).processMetrics.value,onRefresh:C,onTimeRangeChange:s},null,8,["data","loading","process-detail-data"])])])])):ae("",!0),!S.value&&!d.value&&t(e).serverList.value.length>0?(Y(),j("div",qa,[g(t(ge),{description:"请选择一个服务器查看监控数据"})])):ae("",!0),!S.value&&t(e).serverList.value.length===0?(Y(),j("div",Fa,[g(t(ge),{description:"暂无可用的服务器"})])):ae("",!0)]))}}),cr=De(Ba,[["__scopeId","data-v-733bd8b9"]]);export{cr as default};
