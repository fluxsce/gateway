import{$ as y,ag as r,ac as i,I as n,a7 as c,a3 as T}from"./index-CzIbiPcR.js";import{N as u}from"./Popconfirm-Jlwr2tlU.js";const a=y("/api/hub0005"),E=async e=>a.post("/roles/query",e),v=async e=>a.post("/roles/add",e),A=async e=>a.post("/roles/update",e),S=async e=>a.post("/roles/delete",{roleId:e}),I=async e=>{const t=await Promise.allSettled(e.map(o=>S(o))),l=t.filter(o=>o.status==="fulfilled"&&o.value.oK).length,s=t.length-l;return{successCount:l,failureCount:s}},C=async()=>{const e=await E({roleStatus:"Y",pageNum:1,pageSize:1e3});return e.oK&&e.bizData?(Array.isArray(e.bizData)?e.bizData:JSON.parse(e.bizData))||[]:[]},_=async e=>a.post("/resources/query",e),w=async()=>a.post("/resources/tree",{}),f=async e=>a.post("/resources/add",e),L=async e=>a.post("/resources/update",e),D=async e=>a.post("/resources/delete",{resourceId:e}),M=async()=>a.post("/resources/sync",{}),U=async e=>a.post("/role-resources/resource-ids",{roleId:e}),Y=async(e,t)=>a.post("/role-resources/update",{roleId:e,resourceIds:t}),F=async e=>a.post("/user-roles/query",{userId:e}),z=async(e,t,l)=>a.post("/user-roles/update",{userId:e,roleIds:t,primaryRoleId:l}),x=async e=>a.post("/data-permissions/query",e),q=async e=>a.post("/data-permissions/add",e),B=async e=>a.post("/data-permissions/update",e),g=async e=>a.post("/data-permissions/delete",{dataPermissionId:e}),K=async e=>a.post("/operation-logs/query",e),G=async e=>a.post("/operation-logs/export",e),V=async e=>a.post("/operation-logs/clean",{beforeDate:e}),j=async e=>{const t=await Promise.allSettled(e.map(o=>g(o))),l=t.filter(o=>o.status==="fulfilled"&&o.value.oK).length,s=t.length-l;return{successCount:l,failureCount:s}},H=[{label:"系统角色",value:"SYSTEM"},{label:"自定义角色",value:"CUSTOM"}],J=[{label:"全部数据",value:"ALL"},{label:"租户数据",value:"TENANT"},{label:"部门数据",value:"DEPT"},{label:"个人数据",value:"SELF"}],$=[{label:"模块",value:"MODULE"},{label:"菜单",value:"MENU"},{label:"按钮",value:"BUTTON"},{label:"API接口",value:"API"}],Q=[{label:"全部",value:"ALL"},{label:"租户",value:"TENANT"},{label:"部门",value:"DEPT"},{label:"个人",value:"SELF"},{label:"自定义",value:"CUSTOM"}],m=[{label:"创建角色",value:"ROLE_CREATE"},{label:"更新角色",value:"ROLE_UPDATE"},{label:"删除角色",value:"ROLE_DELETE"},{label:"授予权限",value:"PERMISSION_GRANT"},{label:"撤销权限",value:"PERMISSION_REVOKE"},{label:"分配角色",value:"USER_ROLE_ASSIGN"},{label:"撤销角色",value:"USER_ROLE_REVOKE"},{label:"创建数据权限",value:"DATA_PERMISSION_CREATE"},{label:"更新数据权限",value:"DATA_PERMISSION_UPDATE"},{label:"删除数据权限",value:"DATA_PERMISSION_DELETE"}],O=[{label:"角色",value:"ROLE"},{label:"资源",value:"RESOURCE"},{label:"用户角色",value:"USER_ROLE"},{label:"数据权限",value:"DATA_PERMISSION"}],W=[{label:"成功",value:"SUCCESS"},{label:"失败",value:"FAILED"}],X=[{label:"启用",value:"Y"},{label:"禁用",value:"N"}],Z=[{label:"是",value:"Y"},{label:"否",value:"N"}],h=e=>{const t={SYSTEM:"success",CUSTOM:"info"},l={SYSTEM:"系统角色",CUSTOM:"自定义角色"};return r(i,{type:t[e]},()=>l[e])},R=e=>{const t={ALL:"error",TENANT:"warning",DEPT:"info",SELF:"success"},l={ALL:"全部数据",TENANT:"租户数据",DEPT:"部门数据",SELF:"个人数据"};return r(i,{type:t[e]},()=>l[e])},b=e=>{const t={MODULE:"success",MENU:"info",BUTTON:"warning",API:"error"},l={MODULE:"模块",MENU:"菜单",BUTTON:"按钮",API:"API"};return r(i,{type:t[e]},()=>l[e])},p=e=>r(i,{type:e==="Y"?"success":"error"},()=>e==="Y"?"启用":"禁用"),k=e=>r(i,{type:e==="SUCCESS"?"success":"error"},()=>e==="SUCCESS"?"成功":"失败"),ee=(e,t,l)=>[{type:"selection",width:50},{title:"角色名称",key:"roleName",width:150,ellipsis:{tooltip:!0}},{title:"角色编码",key:"roleCode",width:150,ellipsis:{tooltip:!0}},{title:"角色类型",key:"roleType",width:100,render:s=>h(s.roleType)},{title:"角色级别",key:"roleLevel",width:100,sorter:!0},{title:"数据权限",key:"dataScope",width:120,render:s=>R(s.dataScope)},{title:"状态",key:"roleStatus",width:80,render:s=>p(s.roleStatus)},{title:"内置角色",key:"builtInFlag",width:100,render:s=>r(i,{type:s.builtInFlag==="Y"?"warning":"default"},()=>s.builtInFlag==="Y"?"是":"否")},{title:"描述",key:"roleDescription",width:200,ellipsis:{tooltip:!0}},{title:"创建时间",key:"addTime",width:180,sorter:!0},{title:"操作",key:"actions",width:200,fixed:"right",render:s=>r(c,{size:"small"},()=>[r(n,{size:"small",type:"primary",onClick:()=>l(s)},()=>"分配权限"),r(n,{size:"small",onClick:()=>e(s)},()=>"编辑"),s.builtInFlag!=="Y"&&r(u,{onPositiveClick:()=>t(s)},{trigger:()=>r(n,{size:"small",type:"error"},()=>"删除"),default:()=>"确认删除此角色吗？"})])}],te=(e,t,l)=>[{title:"资源名称",key:"resourceName",width:200,ellipsis:{tooltip:!0}},{title:"资源编码",key:"resourceCode",width:200,ellipsis:{tooltip:!0}},{title:"资源类型",key:"resourceType",width:100,render:s=>b(s.resourceType)},{title:"所属模块",key:"moduleCode",width:120,ellipsis:{tooltip:!0}},{title:"资源路径",key:"resourcePath",width:200,ellipsis:{tooltip:!0}},{title:"请求方法",key:"resourceMethod",width:100,render:s=>s.resourceMethod?r(i,{size:"small"},()=>s.resourceMethod):"-"},{title:"排序",key:"sortOrder",width:80,sorter:!0},{title:"状态",key:"resourceStatus",width:80,render:s=>p(s.resourceStatus)},{title:"可见",key:"visibleFlag",width:80,render:s=>r(i,{type:s.visibleFlag==="Y"?"success":"default"},()=>s.visibleFlag==="Y"?"是":"否")},{title:"内置",key:"builtInFlag",width:80,render:s=>r(i,{type:s.builtInFlag==="Y"?"warning":"default"},()=>s.builtInFlag==="Y"?"是":"否")},{title:"操作",key:"actions",width:200,fixed:"right",render:s=>r(c,{size:"small"},()=>[r(n,{size:"small",onClick:()=>l(s)},()=>"添加子项"),r(n,{size:"small",onClick:()=>e(s)},()=>"编辑"),s.builtInFlag!=="Y"&&r(u,{onPositiveClick:()=>t(s)},{trigger:()=>r(n,{size:"small",type:"error"},()=>"删除"),default:()=>"确认删除此资源吗？"})])}],se=e=>[{title:"用户名",key:"userName",width:120,ellipsis:{tooltip:!0}},{title:"角色名称",key:"roleName",width:150,ellipsis:{tooltip:!0}},{title:"角色编码",key:"roleCode",width:150,ellipsis:{tooltip:!0}},{title:"主要角色",key:"primaryRoleFlag",width:100,render:t=>r(i,{type:t.primaryRoleFlag==="Y"?"success":"default"},()=>t.primaryRoleFlag==="Y"?"是":"否")},{title:"授权时间",key:"grantedTime",width:180,sorter:!0},{title:"过期时间",key:"expireTime",width:180,render:t=>t.expireTime||"永不过期"},{title:"操作",key:"actions",width:120,fixed:"right",render:t=>r(u,{onPositiveClick:()=>e(t)},{trigger:()=>r(n,{size:"small",type:"error"},()=>"撤销"),default:()=>"确认撤销此角色授权吗？"})}],le=(e,t)=>[{type:"selection",width:50},{title:"资源类型",key:"resourceType",width:120,ellipsis:{tooltip:!0}},{title:"资源编码",key:"resourceCode",width:150,ellipsis:{tooltip:!0}},{title:"权限范围",key:"permissionScope",width:120,render:l=>{const s={ALL:"error",TENANT:"warning",DEPT:"info",SELF:"success",CUSTOM:"default"},o={ALL:"全部",TENANT:"租户",DEPT:"部门",SELF:"个人",CUSTOM:"自定义"},d=s[l.permissionScope];return r(i,{type:d},()=>o[l.permissionScope])}},{title:"操作权限",key:"operationPermissions",width:120,ellipsis:{tooltip:!0}},{title:"生效时间",key:"effectiveTime",width:180,render:l=>l.effectiveTime||"立即生效"},{title:"过期时间",key:"expireTime",width:180,render:l=>l.expireTime||"永不过期"},{title:"创建时间",key:"addTime",width:180,sorter:!0},{title:"操作",key:"actions",width:120,fixed:"right",render:l=>r(c,{size:"small"},()=>[r(n,{size:"small",onClick:()=>e(l)},()=>"编辑"),r(u,{onPositiveClick:()=>t(l)},{trigger:()=>r(n,{size:"small",type:"error"},()=>"删除"),default:()=>"确认删除此数据权限吗？"})])}],re=e=>[{title:"操作类型",key:"operationType",width:120,render:t=>{const l=m.find(s=>s.value===t.operationType);return l?l.label:t.operationType}},{title:"操作目标",key:"operationTarget",width:100,render:t=>{const l=O.find(s=>s.value===t.operationTarget);return l?l.label:t.operationTarget}},{title:"目标名称",key:"targetName",width:150,ellipsis:{tooltip:!0}},{title:"操作人",key:"operatorRealName",width:120,render:t=>t.operatorRealName||t.operatorUserName||"-"},{title:"IP地址",key:"operatorIpAddress",width:120},{title:"操作结果",key:"operationResult",width:100,render:t=>k(t.operationResult)},{title:"操作描述",key:"operationDescription",width:200,ellipsis:{tooltip:!0}},{title:"操作时间",key:"operationTime",width:180,sorter:!0},{title:"操作",key:"actions",width:100,fixed:"right",render:t=>r(T,{},{trigger:()=>r(n,{size:"small",onClick:()=>e(t)},()=>"详情"),default:()=>"查看操作详情"})}];export{le as A,K as B,G as C,J as D,O as E,V as F,W as G,re as H,m as O,H as R,X as S,Z as Y,v as a,I as b,Y as c,S as d,U as e,ee as f,w as g,D as h,_ as i,L as j,f as k,$ as l,te as m,F as n,z as o,se as p,E as q,x as r,M as s,j as t,A as u,g as v,B as w,q as x,C as y,Q as z};
