import{c as Ae,G as Le,S as Ye}from"./SearchForm-DE-Qtsds.js";import{d as Q,g as j,o as z,cs as Oe,w as h,a4 as ne,a5 as Pe,j as W,n as He,e as r,a9 as Ne,_ as Z,a7 as le,q as de,r as C,a8 as ce,f as p,c as H,h as U,b as c,I as ue,ab as re,J as fe,K as G,i as q,aa as L,ac as Be,ad as $e,ag as oe,t as V,ah as Ee,af as Ue,m as Fe,am as Te}from"./index-B5iwLEhr.js";import{G as Ie}from"./GPane--Prg37Qg.js";import{R as me,D as Ge,A as Ce,a as _e,C as We,G as Ke,W as Ve,b as qe}from"./WindowsOutlined-iNfqx6I5.js";import{u as ve,a as he,b as pe,c as ge,d as ye,e as we,f as be,g as Me,i as De,L as Re}from"./installCanvasRenderer-Bdf8yIjj.js";import{N as Se}from"./DatePicker-BYwGRPWG.js";import{_ as Je}from"./DataTable-BP0rWkt1.js";/* empty css                                                                    */import"./index-DR_R-bYe.js";import"./RefreshOutline-Ca-9cWyP.js";import"./OptionsOutline-B8oCHVC7.js";import"./InformationCircleOutline-v7Gk8MOG.js";import"./Grid-CNbyDJRX.js";import"./Select-DZOKbeI6.js";import"./InputNumber-DRvou0Uu.js";import"./Switch-Dznk0CX3.js";import"./Checkbox-CEPM1LtD.js";import"./Radio-j9RXIevN.js";import"./RadioGroup-CXVTQ2cd.js";import"./prop-NnGblK-3.js";import"./download-C2161hUv.js";const Xe=Q({name:"GCard",__name:"GCard",props:{title:{},showTitle:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},hoverable:{type:[Boolean,String],default:!1},size:{default:"medium"},contentStyle:{},headerStyle:{},segmented:{},embedded:{type:Boolean,default:!1},class:{},style:{}},setup(a){const k=a,g=W(()=>k.contentStyle?k.contentStyle:{padding:0});return(l,f)=>(z(),j(r(Ne),{class:He(["g-card",{"g-card--no-title":!a.showTitle,"g-card--hoverable":a.hoverable===!0||a.hoverable==="hover","g-card--shadow-always":a.hoverable==="always"},k.class]),title:a.showTitle?a.title||"":void 0,bordered:a.bordered,size:a.size,segmented:a.segmented,embedded:a.embedded,"content-style":g.value,"header-style":a.headerStyle,style:Pe(a.style)},Oe({default:h(()=>[ne(l.$slots,"default",{},void 0,!0)]),_:2},[a.showTitle&&l.$slots.header?{name:"header",fn:h(()=>[ne(l.$slots,"header",{},void 0,!0)]),key:"0"}:void 0,a.showTitle&&l.$slots["header-extra"]?{name:"header-extra",fn:h(()=>[ne(l.$slots,"header-extra",{},void 0,!0)]),key:"1"}:void 0,l.$slots.action?{name:"action",fn:h(()=>[ne(l.$slots,"action",{},void 0,!0)]),key:"2"}:void 0,l.$slots.cover?{name:"cover",fn:h(()=>[ne(l.$slots,"cover",{},void 0,!0)]),key:"3"}:void 0,l.$slots.footer?{name:"footer",fn:h(()=>[ne(l.$slots,"footer",{},void 0,!0)]),key:"4"}:void 0]),1032,["class","title","bordered","size","segmented","embedded","content-style","header-style","style"]))}}),te=Z(Xe,[["__scopeId","data-v-7815dbb8"]]),je={class:"card-extra"},Qe={class:"chart-container"},Ze={key:0,class:"chart-loading"},et={key:1,class:"chart-empty"},tt=Q({__name:"CpuMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},cpuDetailData:{type:Array,default:()=>[]},userColor:{type:String,default:"#1890ff"},systemColor:{type:String,default:"#52c41a"},idleColor:{type:String,default:"#d9d9d9"}},emits:["refresh","time-range-change"],setup(a,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=C(null);let l=null;const f=a,m=k,b=Date.now(),_=b-3600*1e3,s=C([_,b]),T={最近1小时:()=>{const u=Date.now();return[u-3600*1e3,u]},最近6小时:()=>{const u=Date.now();return[u-6*3600*1e3,u]},最近12小时:()=>{const u=Date.now();return[u-12*3600*1e3,u]},最近24小时:()=>{const u=Date.now();return[u-24*3600*1e3,u]},最近7天:()=>{const u=Date.now();return[u-168*3600*1e3,u]}},Y=()=>{g.value&&(l=De(g.value),window.addEventListener("resize",x),A())},A=()=>{if(!l)return;if(!f.data||!Array.isArray(f.data)||f.data.length===0){l.clear();return}const u=f.data.map(n=>n.collectTime).sort(),y=new Map;f.data.forEach(n=>{y.set(n.collectTime,n)});const w=[{name:"CPU使用率",type:"line",data:u.map(n=>{const e=y.get(n);return{value:e?e.usagePercent:0,detail:e}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:f.userColor}},{name:"用户态使用率",type:"line",data:u.map(n=>{const e=y.get(n);return{value:e?e.userPercent:0,detail:e}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:f.systemColor}},{name:"系统态使用率",type:"line",data:u.map(n=>{const e=y.get(n);return{value:e?e.systemPercent:0,detail:e}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:f.idleColor}}],t={tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:n=>{const e=n[0].data.detail;let d="";return e&&(d+="CPU详细信息:<br/>",d+=`物理核心数: ${e.coreCount}<br/>`,d+=`逻辑核心数: ${e.logicalCount}<br/>`,d+=`1分钟负载: ${e.loadAvg1.toFixed(2)}<br/>`,d+=`5分钟负载: ${e.loadAvg5.toFixed(2)}<br/>`,d+=`15分钟负载: ${e.loadAvg15.toFixed(2)}<br/>`,d+=`IO等待率: ${e.ioWaitPercent.toFixed(2)}%<br/>`,d+=`硬中断率: ${e.irqPercent.toFixed(2)}%<br/>`,d+=`软中断率: ${e.softIrqPercent.toFixed(2)}%<br/>`,d+="<br/>"),n.forEach(v=>{const D=v.marker,o=v.seriesName,i=`${v.value.toFixed(2)}%`;d+=`${D} ${o}: ${i}<br/>`}),d},axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["CPU使用率","用户态使用率","系统态使用率"],type:"scroll",bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:u.map(n=>L(n,"HH:mm:ss")),axisLabel:{interval:Math.floor(u.length/10)}},yAxis:{type:"value",axisLabel:{formatter:n=>n.toFixed(2)+"%"},max:100,min:0},series:w};l.setOption(t,!0)},x=()=>{l==null||l.resize()},I=()=>{m("refresh")},N=u=>{m("time-range-change",u)};return le(()=>f.data,()=>{A()},{deep:!0}),de(()=>{Y(),m("time-range-change",s.value)}),ce(()=>{l&&(l.dispose(),l=null),window.removeEventListener("resize",x)}),(u,y)=>(z(),j(r(te),{title:"CPU使用率","show-title":!0},{"header-extra":h(()=>[p("div",je,[c(r(Se),{value:s.value,"onUpdate:value":[y[0]||(y[0]=w=>s.value=w),N],type:"datetimerange",shortcuts:T,placeholder:"选择时间范围",size:"small"},null,8,["value"]),c(r(fe),{size:"small",onClick:I,loading:a.loading},{icon:h(()=>[c(r(q),null,{default:h(()=>[c(r(me))]),_:1})]),default:h(()=>[y[1]||(y[1]=G(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:h(()=>[p("div",Qe,[p("div",{ref_key:"chartRef",ref:g,class:"chart-element"},null,512),a.loading?(z(),H("div",Ze,[c(r(ue),{size:"large"})])):U("",!0),!a.loading&&(!a.data||!Array.isArray(a.data)||a.data.length===0)?(z(),H("div",et,[c(r(re),{description:"暂无数据"})])):U("",!0)])]),_:1}))}}),at=Z(tt,[["__scopeId","data-v-1ffd38f9"]]),rt={class:"card-extra"},st={class:"chart-container"},nt={key:0,class:"chart-loading"},ot={key:1,class:"chart-empty"},it=Q({__name:"MemoryMonitor",props:{title:{type:String,default:"内存使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},memoryDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(a,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=a,l=W(()=>g.title||"内存使用率"),f=W(()=>g.warningThreshold),m=W(()=>g.dangerThreshold),b=k,_=C(null);let s=null;const T=Date.now(),Y=T-3600*1e3,A=C([Y,T]),x={最近1小时:()=>{const e=Date.now();return[e-3600*1e3,e]},最近6小时:()=>{const e=Date.now();return[e-6*3600*1e3,e]},最近12小时:()=>{const e=Date.now();return[e-12*3600*1e3,e]},最近24小时:()=>{const e=Date.now();return[e-24*3600*1e3,e]},最近7天:()=>{const e=Date.now();return[e-168*3600*1e3,e]}},I=W(()=>{if(!g.data||g.data.length===0)return[];const e=new Map;return g.data.forEach(v=>{const D=v.collectTime;e.has(D)||e.set(D,[]),e.get(D).push(v.usagePercent)}),Array.from(e.entries()).map(([v,D])=>{const o=g.data.find(i=>i.collectTime===v);return{time:v,value:Math.round(D.reduce((i,$)=>i+$,0)/D.length*100)/100,detail:o?{totalMemory:o.totalMemory,usedMemory:o.usedMemory,availableMemory:o.availableMemory,freeMemory:o.freeMemory,cachedMemory:o.cachedMemory,buffersMemory:o.buffersMemory,swapTotal:o.swapTotal,swapUsed:o.swapUsed,swapFree:o.swapFree,swapUsagePercent:o.swapUsagePercent}:null}}).sort((v,D)=>new Date(v.time).getTime()-new Date(D.time).getTime())}),N=e=>{if(e===0)return"0 B";const d=["B","KB","MB","GB","TB","PB"],v=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,v)).toFixed(2)} ${d[v]}`},u=()=>{b("refresh")},y=e=>{b("time-range-change",e)},w=()=>{_.value&&(s=De(_.value),window.addEventListener("resize",n),t())},t=()=>{if(!s)return;const e=I.value;if(e.length===0){s.clear();return}const d={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:function(v){const D=v[0],o=D.data.detail;if(!o)return`${D.marker}${D.seriesName}: ${D.data.value}%`;let i="";return i+=`${D.marker}内存使用率: <b>${D.data.value}%</b><br/>`,i+="<br/>详细信息:<br/>",i+=`总内存: ${N(o.totalMemory)}<br/>`,i+=`已用内存: ${N(o.usedMemory)}<br/>`,i+=`可用内存: ${N(o.availableMemory)}<br/>`,i+=`空闲内存: ${N(o.freeMemory)}<br/>`,i+=`缓存内存: ${N(o.cachedMemory)}<br/>`,i+=`缓冲区内存: ${N(o.buffersMemory)}<br/>`,i+="<br/>交换分区:<br/>",i+=`总交换空间: ${N(o.swapTotal)}<br/>`,i+=`已用交换空间: ${N(o.swapUsed)}<br/>`,i+=`空闲交换空间: ${N(o.swapFree)}<br/>`,i+=`交换使用率: ${o.swapUsagePercent.toFixed(1)}%`,i}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e.map(v=>L(new Date(v.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:"内存使用率",type:"line",data:e.map(v=>({value:v.value,detail:v.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#52c41a"},itemStyle:{color:function(v){const D=v.data.value;return D>=m.value?"#ff4d4f":D>=f.value?"#faad14":"#52c41a"}},areaStyle:{color:new Re(0,0,0,1,[{offset:0,color:"rgba(82, 196, 26, 0.3)"},{offset:1,color:"rgba(82, 196, 26, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:f.value,label:{formatter:`警告 ${f.value}%`,position:"start"}},{yAxis:m.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`危险 ${m.value}%`,position:"start"}}]}}]};s.setOption(d)},n=()=>{s==null||s.resize()};return le(()=>g.data,()=>{t()},{deep:!0}),de(()=>{w(),b("time-range-change",A.value)}),ce(()=>{s&&(s.dispose(),s=null),window.removeEventListener("resize",n)}),(e,d)=>(z(),j(r(te),{title:l.value,"show-title":!0},{"header-extra":h(()=>[p("div",rt,[c(r(Se),{value:A.value,"onUpdate:value":[d[0]||(d[0]=v=>A.value=v),y],type:"datetimerange",shortcuts:x,placeholder:"选择时间范围",size:"small"},null,8,["value"]),c(r(fe),{size:"small",onClick:u,loading:a.loading},{icon:h(()=>[c(r(q),null,{default:h(()=>[c(r(me))]),_:1})]),default:h(()=>[d[1]||(d[1]=G(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:h(()=>[p("div",st,[p("div",{ref_key:"chartRef",ref:_,class:"chart-element"},null,512),a.loading?(z(),H("div",nt,[c(r(ue),{size:"large"})])):U("",!0),!a.loading&&!I.value.length?(z(),H("div",ot,[c(r(re),{description:"暂无数据"})])):U("",!0)])]),_:1},8,["title"]))}}),lt=Z(it,[["__scopeId","data-v-058d593d"]]),dt={class:"card-extra"},ct={class:"chart-container"},ut={key:0,class:"chart-loading"},ft={key:1,class:"chart-empty"},mt=Q({__name:"DiskMonitor",props:{title:{type:String,default:"磁盘使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},diskDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(a,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=a,l=W(()=>g.title||"磁盘使用率"),f=k,m=C(null);let b=null;const _=Date.now(),s=_-3600*1e3,T=C([s,_]),Y={最近1小时:()=>{const t=Date.now();return[t-3600*1e3,t]},最近6小时:()=>{const t=Date.now();return[t-6*3600*1e3,t]},最近12小时:()=>{const t=Date.now();return[t-12*3600*1e3,t]},最近24小时:()=>{const t=Date.now();return[t-24*3600*1e3,t]},最近7天:()=>{const t=Date.now();return[t-168*3600*1e3,t]}},A=W(()=>{if(!g.data||g.data.length===0)return[];const t=new Map;return g.data.forEach(n=>{const e=n.collectTime;t.has(e)||t.set(e,{values:[],partitions:[]});const d=t.get(e);d.values.push(n.usagePercent),d.partitions.push(n)}),Array.from(t.entries()).map(([n,e])=>({time:n,value:Math.round(e.values.reduce((d,v)=>d+v,0)/e.values.length*100)/100,detail:{partitions:e.partitions,partitionCount:e.partitions.length,totalSpace:e.partitions.reduce((d,v)=>d+v.totalSpace,0),usedSpace:e.partitions.reduce((d,v)=>d+v.usedSpace,0),freeSpace:e.partitions.reduce((d,v)=>d+v.freeSpace,0),avgUsagePercent:Math.round(e.values.reduce((d,v)=>d+v,0)/e.values.length*100)/100}}))}),x=t=>{if(t===0)return"0 B";const n=["B","KB","MB","GB","TB","PB"],e=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,e)).toFixed(2)} ${n[e]}`},I=()=>{f("refresh")},N=t=>{f("time-range-change",t)},u=()=>{m.value&&(b=De(m.value),window.addEventListener("resize",w),y())},y=()=>{if(!b)return;const t=A.value;if(t.length===0){b.clear();return}const n=W(()=>g.warningThreshold??80),e=W(()=>g.dangerThreshold??90),d={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:function(v){const D=v[0],o=D.data.detail;let i="";return i+=`${D.marker}磁盘使用率: <b>${D.data.value}%</b><br/>`,i+="<br/>详细信息:<br/>",i+=`分区数量: ${o.partitionCount}<br/>`,i+=`总空间: ${x(o.totalSpace)}<br/>`,i+=`已用空间: ${x(o.usedSpace)}<br/>`,i+=`空闲空间: ${x(o.freeSpace)}<br/>`,o.partitions.length>0&&(i+="<br/>分区详情:<br/>",o.partitions.slice(0,3).forEach(S=>{i+=`${S.mountPoint}: ${S.usagePercent.toFixed(1)}% (${x(S.usedSpace)}/${x(S.totalSpace)})<br/>`}),o.partitions.length>3&&(i+=`... 还有 ${o.partitions.length-3} 个分区`)),i}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:t.map(v=>L(new Date(v.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:"磁盘使用率",type:"line",data:t.map(v=>({value:v.value,detail:v.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#faad14"},itemStyle:{color:function(v){const D=v.data.value;return D>=e.value?"#ff4d4f":(D>=n.value,"#faad14")}},areaStyle:{color:new Re(0,0,0,1,[{offset:0,color:"rgba(250, 173, 20, 0.3)"},{offset:1,color:"rgba(250, 173, 20, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:n.value,label:{formatter:`警告 ${n.value}%`,position:"start"}},{yAxis:e.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`危险 ${e.value}%`,position:"start"}}]}}]};b.setOption(d)},w=()=>{b==null||b.resize()};return le(()=>g.data,()=>{y()},{deep:!0}),de(()=>{u(),f("time-range-change",T.value)}),ce(()=>{b&&(b.dispose(),b=null),window.removeEventListener("resize",w)}),(t,n)=>(z(),j(r(te),{title:l.value,"show-title":!0},{"header-extra":h(()=>[p("div",dt,[c(r(Se),{value:T.value,"onUpdate:value":[n[0]||(n[0]=e=>T.value=e),N],type:"datetimerange",shortcuts:Y,placeholder:"选择时间范围",size:"small"},null,8,["value"]),c(r(fe),{size:"small",onClick:I,loading:a.loading},{icon:h(()=>[c(r(q),null,{default:h(()=>[c(r(me))]),_:1})]),default:h(()=>[n[1]||(n[1]=G(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:h(()=>[p("div",ct,[p("div",{ref_key:"chartRef",ref:m,class:"chart-element"},null,512),a.loading?(z(),H("div",ut,[c(r(ue),{size:"large"})])):U("",!0),!a.loading&&!A.value.length?(z(),H("div",ft,[c(r(re),{description:"暂无数据"})])):U("",!0)])]),_:1},8,["title"]))}}),vt=Z(mt,[["__scopeId","data-v-172ca3f4"]]),ht={class:"card-extra"},pt={class:"chart-container"},gt={key:0,class:"chart-loading"},yt={key:1,class:"chart-empty"},wt={key:0,class:"detail-section"},bt=Q({__name:"DiskIOMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},diskIODetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(a,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=C(null);let l=null;const f=a,m=k,b=Date.now(),_=b-3600*1e3,s=C([_,b]),T={最近1小时:()=>{const t=Date.now();return[t-3600*1e3,t]},最近6小时:()=>{const t=Date.now();return[t-6*3600*1e3,t]},最近12小时:()=>{const t=Date.now();return[t-12*3600*1e3,t]},最近24小时:()=>{const t=Date.now();return[t-24*3600*1e3,t]},最近7天:()=>{const t=Date.now();return[t-168*3600*1e3,t]}},Y={pageSize:5,page:1},A=W(()=>[{title:"设备名称",key:"deviceName"},{title:"读取速率",key:"readRate",render:t=>$e(t.readRate)+"/s"},{title:"写入速率",key:"writeRate",render:t=>$e(t.writeRate)+"/s"},{title:"读取次数",key:"readCount"},{title:"写入次数",key:"writeCount"},{title:"采集时间",key:"collectTime",render:t=>L(t.collectTime)}]),x=W(()=>{if(!f.diskIODetailData)return[];const t=new Map;return f.diskIODetailData.forEach(n=>{const e=t.get(n.deviceName);(!e||new Date(n.collectTime)>new Date(e.collectTime))&&t.set(n.deviceName,n)}),Array.from(t.values())}),I=()=>{g.value&&(l=De(g.value),window.addEventListener("resize",u),N())},N=()=>{if(!l)return;if(!f.data||!Array.isArray(f.data)||f.data.length===0){l.clear();return}const t=new Map;f.data.forEach(o=>{var i;t.has(o.collectTime)||t.set(o.collectTime,new Map),(i=t.get(o.collectTime))==null||i.set(o.deviceName,o)});const n=Array.from(t.keys()).sort(),e=new Set;f.data.forEach(o=>e.add(o.deviceName));const d=[{read:"#1890ff",write:"#36cfc9"},{read:"#722ed1",write:"#eb2f96"},{read:"#fa8c16",write:"#faad14"},{read:"#52c41a",write:"#a0d911"},{read:"#f5222d",write:"#ff7a45"}],v=[];Array.from(e).forEach((o,i)=>{const $=i%d.length,S=d[$],M=[],E=[];n.forEach(F=>{var B;const R=(B=t.get(F))==null?void 0:B.get(o);M.push(R?R.readRate:0),E.push(R?R.writeRate:0)}),v.push({name:`${o} 读取`,type:"line",data:M,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:S.read}}),v.push({name:`${o} 写入`,type:"line",data:E,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:S.write}})});const D={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:o=>{const i=Array.isArray(o)?o[0]:o,$=n[i.dataIndex];let S=L($,"YYYY-MM-DD HH:mm:ss")+"<br/>";const M=new Map;return o.forEach(E=>{var B;const R=E.seriesName.split(" ")[0];M.has(R)||M.set(R,[]),(B=M.get(R))==null||B.push(E)}),M.forEach((E,F)=>{S+=`<div style="margin-top: 3px;"><b>${F}</b></div>`,E.forEach(R=>{const B=R.color,P=R.seriesName.includes("读取")?"读取":"写入",K=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${B};border:1px solid ${B}"></span>`;S+=`<div style="padding-left: 12px;line-height:18px">${K}${P}: ${$e(Number(R.value))}/s</div>`})}),S}},legend:{type:"scroll",bottom:0,padding:[10,20],selected:v.reduce((o,i)=>(o[i.name]=!0,o),{}),formatter:o=>{const i=o.split(" ")[0],$=o.includes("读取")?"读取":"写入";return`${i} ${$}`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:n.map(o=>L(o,"HH:mm:ss")),axisLabel:{interval:Math.floor(n.length/10)}},yAxis:{type:"value",axisLabel:{formatter:o=>$e(o)+"/s"}},series:v};l.setOption(D,!0)},u=()=>{l==null||l.resize()},y=()=>{m("refresh")},w=t=>{m("time-range-change",t)};return le(()=>f.data,()=>{N()},{deep:!0}),de(()=>{I(),m("time-range-change",s.value)}),ce(()=>{l&&(l.dispose(),l=null),window.removeEventListener("resize",u)}),(t,n)=>(z(),j(r(te),{title:"磁盘IO监控","show-title":!0},{"header-extra":h(()=>[p("div",ht,[c(r(Se),{value:s.value,"onUpdate:value":[n[0]||(n[0]=e=>s.value=e),w],type:"datetimerange",shortcuts:T,placeholder:"选择时间范围",size:"small"},null,8,["value"]),c(r(fe),{size:"small",onClick:y,loading:a.loading},{icon:h(()=>[c(r(q),null,{default:h(()=>[c(r(me))]),_:1})]),default:h(()=>[n[1]||(n[1]=G(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:h(()=>[p("div",pt,[p("div",{ref_key:"chartRef",ref:g,class:"chart-element"},null,512),a.loading?(z(),H("div",gt,[c(r(ue),{size:"large"})])):U("",!0),!a.loading&&(!a.data||!Array.isArray(a.data)||a.data.length===0)?(z(),H("div",yt,[c(r(re),{description:"暂无数据"})])):U("",!0)]),a.diskIODetailData&&a.diskIODetailData.length>0?(z(),H("div",wt,[c(r(Be),null,{default:h(()=>[...n[2]||(n[2]=[G("磁盘IO详情",-1)])]),_:1}),c(r(Je),{columns:A.value,data:x.value,pagination:Y,bordered:!1,size:"small"},null,8,["columns","data"])])):U("",!0)]),_:1}))}}),Mt=Z(bt,[["__scopeId","data-v-09f602e3"]]),Dt={class:"card-extra"},St={class:"chart-container"},$t={key:0,class:"chart-loading"},xt={key:1,class:"chart-empty"},kt=Q({__name:"NetworkMonitor",props:{title:{},data:{},loading:{type:Boolean},uploadColor:{},downloadColor:{}},emits:["refresh","time-range-change"],setup(a,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=a,l={title:"网络流量"},f=k,m=C(null);let b=null;const _=Date.now(),s=_-3600*1e3,T=C([s,_]),Y={最近1小时:()=>{const t=Date.now();return[t-3600*1e3,t]},最近6小时:()=>{const t=Date.now();return[t-6*3600*1e3,t]},最近12小时:()=>{const t=Date.now();return[t-12*3600*1e3,t]},最近24小时:()=>{const t=Date.now();return[t-24*3600*1e3,t]},最近7天:()=>{const t=Date.now();return[t-168*3600*1e3,t]}},A=W(()=>{if(!g.data||g.data.length===0)return[];const t=new Map;return g.data.forEach(n=>{const e=n.collectTime;t.has(e)||t.set(e,{interfaces:[]}),t.get(e).interfaces.push(n)}),Array.from(t.entries()).sort((n,e)=>new Date(n[0]).getTime()-new Date(e[0]).getTime()).map(([n,e])=>({time:n,detail:{interfaces:e.interfaces,interfaceCount:e.interfaces.length}}))}),x=t=>t===0?"0 B/s":t<1024?`${t.toFixed(2)} B/s`:t<1024*1024?`${(t/1024).toFixed(2)} KB/s`:t<1024*1024*1024?`${(t/(1024*1024)).toFixed(2)} MB/s`:`${(t/(1024*1024*1024)).toFixed(2)} GB/s`,I=()=>{f("refresh")},N=t=>{f("time-range-change",t)},u=()=>{m.value&&(b=De(m.value),window.addEventListener("resize",w),y())},y=()=>{if(!b)return;const t=A.value;if(t.length===0){b.clear();return}const n=t.map(S=>L(new Date(S.time),"HH:mm:ss")),e=new Set,d=[],v=[];t.forEach(S=>{S.detail.interfaces.forEach(M=>{e.has(M.interfaceName)||(M.ipAddresses&&M.ipAddresses.includes(".")&&!M.ipAddresses.includes(":")||M.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?d.push(M.interfaceName):v.push(M.interfaceName),e.add(M.interfaceName))})});const D=[...d,...v],o=[{send:"#fa541c",receive:"#73d13d"},{send:"#722ed1",receive:"#13c2c2"},{send:"#f5222d",receive:"#52c41a"},{send:"#fa8c16",receive:"#1890ff"},{send:"#eb2f96",receive:"#fadb14"}],i=[];D.forEach((S,M)=>{const E=M%o.length,F=o[E],R=t.map(P=>{const K=P.detail.interfaces.find(J=>J.interfaceName===S);return K?Math.round(K.sendRate/(1024*1024)*100)/100:0}),B=t.map(P=>{const K=P.detail.interfaces.find(J=>J.interfaceName===S);return K?Math.round(K.receiveRate/(1024*1024)*100)/100:0}),se=d.includes(S)?2:1;i.push({name:`${S} 上传`,type:"line",data:R,smooth:!0,showSymbol:!1,lineStyle:{width:se,type:"solid"},itemStyle:{color:F.send},emphasis:{focus:"series"},tooltip:{valueFormatter:P=>`${P} MB/s`}}),i.push({name:`${S} 下载`,type:"line",data:B,smooth:!0,showSymbol:!1,lineStyle:{width:se,type:"dashed"},itemStyle:{color:F.receive},emphasis:{focus:"series"},tooltip:{valueFormatter:P=>`${P} MB/s`}})});const $={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(S){var se;const M=S[0].axisValue,E=n.indexOf(M),F=(se=t[E])==null?void 0:se.detail;let R=`${M}<br/>`;const B=new Map;if(S.forEach(P=>{const J=P.seriesName.split(" ")[0];B.has(J)||B.set(J,[]),B.get(J).push(P)}),F){const P=new Set;B.forEach((X,O)=>{P.add(O)}),F.interfaces.forEach(X=>{P.add(X.interfaceName)}),R+=`接口总数: ${F.interfaceCount}<br/>`;const K=[],J=[];Array.from(P).forEach(X=>{const O=F.interfaces.find(xe=>xe.interfaceName===X);if(!O)return;O.ipAddresses&&O.ipAddresses.includes(".")&&!O.ipAddresses.includes(":")||O.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?K.push(X):J.push(X)});const ke=[...K,...J];ke.length>0&&(R+="<br/>接口详情:<br/>",ke.forEach(X=>{const O=F.interfaces.find(xe=>xe.interfaceName===X);if(!O)return;R+='<div style="padding:3px 0;border-bottom:1px solid #eee;">',R+=`<b>${X}</b>: `,K.includes(X)&&(R+='<span style="color:#1890ff;">[IPv4]</span> '),R+=`<br/><span style="padding-left:10px;color:#ff4d4f;">↑${x(O.sendRate)}</span> `,R+=`<span style="padding-left:5px;color:#52c41a;">↓${x(O.receiveRate)}</span>`,(O.errorsReceived>0||O.errorsSent>0)&&(R+=` <span style="color:#ff7875;">(错误: ${O.errorsReceived+O.errorsSent})</span>`),O.ipAddresses&&(R+=`<br/><span style="padding-left:10px;color:#999;font-size:12px;">IP: ${O.ipAddresses}</span>`),R+="</div>"}))}return R}},legend:{type:"scroll",data:i.map(S=>S.name),bottom:0,padding:[5,10],selected:i.reduce((S,M)=>{const E=M.name.split(" ")[0];return S[M.name]=d.includes(E),S},{})},grid:{left:"3%",right:"4%",bottom:"40px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:n,axisLabel:{rotate:45}},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:S=>S.toFixed(2)+" MB/s"}},series:i};b.setOption($)},w=()=>{b==null||b.resize()};return le(()=>g.data,()=>{y()},{deep:!0}),de(()=>{u(),f("time-range-change",T.value)}),ce(()=>{b&&(b.dispose(),b=null),window.removeEventListener("resize",w)}),(t,n)=>(z(),j(r(te),{title:a.title||l.title,"show-title":!0},{"header-extra":h(()=>[p("div",Dt,[c(r(Se),{value:T.value,"onUpdate:value":[n[0]||(n[0]=e=>T.value=e),N],type:"datetimerange",shortcuts:Y,placeholder:"选择时间范围",size:"small"},null,8,["value"]),c(r(fe),{size:"small",onClick:I,loading:a.loading},{icon:h(()=>[c(r(q),null,{default:h(()=>[c(r(me))]),_:1})]),default:h(()=>[n[1]||(n[1]=G(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:h(()=>[p("div",St,[p("div",{ref_key:"chartRef",ref:m,class:"chart-element"},null,512),a.loading?(z(),H("div",$t,[c(r(ue),{size:"large"})])):U("",!0),!a.loading&&!A.value.length?(z(),H("div",xt,[c(r(re),{description:"暂无数据"})])):U("",!0)])]),_:1},8,["title"]))}}),Tt=Z(kt,[["__scopeId","data-v-c822fd97"]]),It={class:"card-extra"},Ct={class:"chart-container"},_t={key:0,class:"chart-loading"},Nt={key:1,class:"chart-empty"},Rt=Q({__name:"ProcessMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},processDetailData:{type:Array,default:()=>[]},cpuColor:{type:String,default:"#1890ff"},memoryColor:{type:String,default:"#52c41a"}},emits:["refresh","time-range-change"],setup(a,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=C(null);let l=null;const f=a,m=k,b=Date.now(),_=b-3600*1e3,s=C([_,b]),T={最近1小时:()=>{const u=Date.now();return[u-3600*1e3,u]},最近6小时:()=>{const u=Date.now();return[u-6*3600*1e3,u]},最近12小时:()=>{const u=Date.now();return[u-12*3600*1e3,u]},最近24小时:()=>{const u=Date.now();return[u-24*3600*1e3,u]},最近7天:()=>{const u=Date.now();return[u-168*3600*1e3,u]}},Y=()=>{g.value&&(l=De(g.value),window.addEventListener("resize",x),A())},A=()=>{if(!l)return;if(!f.data||f.data.length===0){l.clear();return}const u=new Map;f.data.forEach(e=>{var d;u.has(e.collectTime)||u.set(e.collectTime,[]),(d=u.get(e.collectTime))==null||d.push(e)});const y=Array.from(u.keys()).sort(),w=[],t=[];y.forEach(e=>{const d=u.get(e)||[];if(d.length>0){const v=d.reduce((o,i)=>o+i.cpuPercent,0)/d.length,D=d.reduce((o,i)=>o+i.memoryPercent,0)/d.length;w.push(Number(v.toFixed(2))),t.push(Number(D.toFixed(2)))}else w.push(0),t.push(0)});const n={tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:e=>{const d=e[0].dataIndex,v=u.get(y[d])||[];let D=L(y[d],"YYYY-MM-DD HH:mm:ss")+"<br/>";return e.forEach(o=>{const $=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${o.color};"></span>`;D+=$+o.seriesName+": "+o.value+"%<br/>"}),v.length>0&&(D+=`<span style="color:#666;">进程数量: ${v.length}</span><br/>`),v.length>0&&(D+="<br/><b>进程详情</b><br/>",[...v].sort((i,$)=>$.cpuPercent-i.cpuPercent).slice(0,5).forEach((i,$)=>{D+='<div style="padding-left:10px;margin:2px 0;">',D+=`<b>${$+1}. ${i.processName}</b> <span style="color:#666;">(PID: ${i.processId})</span><br/>`,D+=`<span style="padding-left:15px;">CPU: ${i.cpuPercent.toFixed(2)}%, `,D+=`内存: ${i.memoryPercent.toFixed(2)}%, `,D+=`线程: ${i.threadCount}</span>`,D+="</div>"}),v.length>5&&(D+=`<div style="padding-left:10px;color:#999;">... 以及 ${v.length-5} 个其他进程</div>`)),D}},legend:{data:["平均CPU使用率","平均内存使用率"],bottom:0,padding:[10,20]},grid:{left:"3%",right:"4%",bottom:"15%",top:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:y.map(e=>L(e,"HH:mm:ss")),axisLabel:{interval:Math.floor(y.length/10)}},yAxis:{type:"value",min:0,max:100,position:"left",axisLabel:{formatter:"{value}%"}},series:[{name:"平均CPU使用率",type:"line",data:w,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:f.cpuColor}},{name:"平均内存使用率",type:"line",data:t,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:f.memoryColor}}]};l.setOption(n)},x=()=>{l==null||l.resize()},I=()=>{m("refresh")},N=u=>{m("time-range-change",u)};return le(()=>f.data,()=>{A()},{deep:!0}),de(()=>{Y(),m("time-range-change",s.value)}),ce(()=>{l&&(l.dispose(),l=null),window.removeEventListener("resize",x)}),(u,y)=>(z(),j(r(te),{title:"进程监控","show-title":!0},{"header-extra":h(()=>[p("div",It,[c(r(Se),{value:s.value,"onUpdate:value":[y[0]||(y[0]=w=>s.value=w),N],type:"datetimerange",shortcuts:T,placeholder:"选择时间范围",size:"small"},null,8,["value"]),c(r(fe),{size:"small",onClick:I,loading:a.loading},{icon:h(()=>[c(r(q),null,{default:h(()=>[c(r(me))]),_:1})]),default:h(()=>[y[1]||(y[1]=G(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:h(()=>{var w;return[p("div",Ct,[p("div",{ref_key:"chartRef",ref:g,class:"chart-element"},null,512),a.loading?(z(),H("div",_t,[c(r(ue),{size:"large"})])):U("",!0),!a.loading&&!((w=a.data)!=null&&w.length)?(z(),H("div",Nt,[c(r(re),{description:"暂无数据"})])):U("",!0)])]}),_:1}))}}),zt=Z(Rt,[["__scopeId","data-v-5dd68d93"]]),At={class:"overview-grid"},Lt={class:"overview-item"},Yt={class:"overview-icon hostname"},Ot={class:"overview-content"},Pt={class:"overview-value text-truncate"},Ht={class:"overview-item"},Bt={class:"overview-icon os"},Et={class:"overview-content"},Ut={class:"overview-value text-truncate"},Ft={class:"overview-item"},Gt={class:"overview-icon version"},Wt={class:"overview-content"},Kt={class:"overview-value text-truncate"},Vt={class:"overview-item"},qt={class:"overview-icon architecture"},Jt={class:"overview-content"},Xt={class:"overview-value text-truncate"},jt={class:"overview-item"},Qt={class:"overview-icon server-type"},Zt={class:"overview-content"},ea={class:"overview-value text-truncate"},ta={class:"overview-item"},aa={class:"overview-icon ip"},ra={class:"overview-content"},sa={class:"overview-value text-truncate"},na=Q({name:"ServerInfoCard",__name:"ServerInfoCard",props:{serverInfo:{}},setup(a){const k=f=>({physical:"物理机",virtual:"虚拟机",unknown:"未知"})[f||"unknown"]||"未知",g=f=>{const m=f.toLowerCase();return m.includes("windows")?Ve:m.includes("linux")?Ce:m.includes("mac")||m.includes("darwin")?qe:_e},l=f=>{if(!f)return"N/A";if(f.toLowerCase().includes("windows")){const m=f.match(/Windows (\d+(?:\.\d+)?)/i);if(m){const b=m[1],_=f.match(/Windows \d+(?:\.\d+)?\s+(\w+)/i);return _?`Windows ${b} ${_[1]}`:`Windows ${b}`}}return f.length>20?f.substring(0,17)+"...":f};return(f,m)=>(z(),j(r(Ne),{title:"服务器信息",embedded:"",class:"server-info-card"},{default:h(()=>[p("div",At,[p("div",Lt,[p("div",Yt,[c(r(q),{size:"24"},{default:h(()=>[c(r(Ge))]),_:1})]),p("div",Ot,[m[0]||(m[0]=p("div",{class:"overview-label"},"主机名",-1)),c(r(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Pt,V(a.serverInfo.hostname),1)]),default:h(()=>[G(" "+V(a.serverInfo.hostname),1)]),_:1})])]),p("div",Ht,[p("div",Bt,[c(r(q),{size:"24"},{default:h(()=>[(z(),j(Ee(g(a.serverInfo.osType))))]),_:1})]),p("div",Et,[m[1]||(m[1]=p("div",{class:"overview-label"},"操作系统",-1)),c(r(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Ut,V(a.serverInfo.osType),1)]),default:h(()=>[G(" "+V(a.serverInfo.osType),1)]),_:1})])]),p("div",Ft,[p("div",Gt,[c(r(q),{size:"24"},{default:h(()=>[c(r(Ce))]),_:1})]),p("div",Wt,[m[2]||(m[2]=p("div",{class:"overview-label"},"系统版本",-1)),c(r(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Kt,V(l(a.serverInfo.osVersion)),1)]),default:h(()=>[G(" "+V(a.serverInfo.osVersion),1)]),_:1})])]),p("div",Vt,[p("div",qt,[c(r(q),{size:"24"},{default:h(()=>[c(r(_e))]),_:1})]),p("div",Jt,[m[3]||(m[3]=p("div",{class:"overview-label"},"系统架构",-1)),c(r(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Xt,V(a.serverInfo.architecture),1)]),default:h(()=>[G(" "+V(a.serverInfo.architecture),1)]),_:1})])]),p("div",jt,[p("div",Qt,[c(r(q),{size:"24"},{default:h(()=>[c(r(We))]),_:1})]),p("div",Zt,[m[4]||(m[4]=p("div",{class:"overview-label"},"服务器类型",-1)),c(r(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",ea,V(k(a.serverInfo.serverType)),1)]),default:h(()=>[G(" "+V(k(a.serverInfo.serverType)),1)]),_:1})])]),p("div",ta,[p("div",aa,[c(r(q),{size:"24"},{default:h(()=>[c(r(Ke))]),_:1})]),p("div",ra,[m[5]||(m[5]=p("div",{class:"overview-label"},"IP地址",-1)),c(r(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",sa,V(a.serverInfo.ipAddress||"N/A"),1)]),default:h(()=>[G(" "+V(a.serverInfo.ipAddress||"N/A"),1)]),_:1})])])])]),_:1}))}}),oa=Z(na,[["__scopeId","data-v-f17d303f"]]);var ee=(a=>(a.PHYSICAL="physical",a.VIRTUAL="virtual",a.UNKNOWN="unknown",a))(ee||{}),ie=(a=>(a.LINUX="Linux",a.WINDOWS="Windows",a.MACOS="MacOS",a.UNIX="Unix",a.OTHER="Other",a))(ie||{});function ia(){const a="hub0007",k=C(!1),g=C([]),l=C(),f={fields:[{field:"hostname",label:"主机名",type:"input",placeholder:"请输入主机名",span:6,clearable:!0},{field:"ipAddress",label:"IP地址",type:"input",placeholder:"请输入IP地址",span:6,clearable:!0},{field:"osType",label:"操作系统",type:"select",placeholder:"请选择操作系统",span:6,clearable:!0,options:[{label:"全部",value:""},{label:"Linux",value:ie.LINUX},{label:"Windows",value:ie.WINDOWS},{label:"MacOS",value:ie.MACOS},{label:"Unix",value:ie.UNIX},{label:"其他",value:ie.OTHER}]},{field:"serverType",label:"服务器类型",type:"select",placeholder:"请选择服务器类型",span:6,clearable:!0,options:[{label:"全部",value:""},{label:"物理服务器",value:ee.PHYSICAL},{label:"虚拟服务器",value:ee.VIRTUAL},{label:"未知",value:ee.UNKNOWN}]}],moreFields:[{field:"serverLocation",label:"服务器位置",type:"input",placeholder:"请输入服务器位置",span:6,clearable:!0}],toolbarButtons:[]};return{moduleId:a,loading:k,serverList:g,pageInfo:l,searchFormConfig:f,gridConfig:{columns:[{field:"metricServerId",title:"节点ID",showOverflow:!0,width:200},{field:"hostname",title:"主机名",showOverflow:!0},{field:"ipAddress",title:"IP地址",showOverflow:!0},{field:"osType",title:"操作系统",showOverflow:!0,cellRender:{name:"VxeTag",props:({row:s})=>({type:"info",content:s.osType})}},{field:"osVersion",title:"系统版本",showOverflow:!0},{field:"architecture",title:"架构",showOverflow:!0},{field:"serverType",title:"服务器类型",cellRender:{name:"VxeTag",props:({row:s})=>{const T={[ee.PHYSICAL]:{type:"success",text:"物理服务器"},[ee.VIRTUAL]:{type:"warning",text:"虚拟服务器"},[ee.UNKNOWN]:{type:"default",text:"未知"}},Y=T[s.serverType]||T[ee.UNKNOWN];return{type:Y.type,content:Y.text}}}},{field:"serverLocation",title:"服务器位置",showOverflow:!0},{field:"lastUpdateTime",title:"最后更新",sortable:!0,showOverflow:!0,formatter:({cellValue:s})=>s?L(s,"YYYY-MM-DD HH:mm:ss"):""},{field:"addTime",title:"创建时间",sortable:!0,showOverflow:!0,formatter:({cellValue:s})=>s?L(s,"YYYY-MM-DD HH:mm:ss"):""},{field:"addWho",title:"创建人",showOverflow:!0},{field:"editTime",title:"修改时间",sortable:!0,showOverflow:!0,formatter:({cellValue:s})=>s?L(s,"YYYY-MM-DD HH:mm:ss"):""},{field:"editWho",title:"修改人",showOverflow:!0}],menuConfig:{enabled:!0,customMenus:[{code:"view",name:"查看详情",prefixIcon:"vxe-icon-eye-fill"}]},paginationConfig:{show:!0}},setServerList:s=>{g.value=s},updatePagination:s=>{l.value=s}}}const ae=Ue("/gateway/hub0007");async function la(a){return ae.post("/queryServerInfos",a)}async function da(a){return ae.post("/getServerInfo",{metricServerId:a})}async function ca(a){return ae.post("/metrics/cpu",a)}async function ua(a){return ae.post("/metrics/memory",a)}async function fa(a){return ae.post("/metrics/disk",a)}async function ma(a){return ae.post("/metrics/diskio",a)}async function va(a){return ae.post("/metrics/network",a)}async function ha(a){return ae.post("/metrics/process",a)}function pa(){const a=C(""),k=C(!1),g=C(!1),l=C(!1),f=C(!1),m=C(!1),b=C(!1),_=C([]),s=C([]),T=C([]),Y=C([]),A=C([]),x=C([]),I=C([Date.now()-3600*1e3,Date.now()]),N=async o=>{const i=o||a.value;if(i){k.value=!0;try{const[$,S]=I.value,M=await ca({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(_.value=JSON.parse(M.bizData))}catch($){console.error("加载CPU监控数据失败:",$)}finally{k.value=!1}}},u=async o=>{const i=o||a.value;if(i){g.value=!0;try{const[$,S]=I.value,M=await ua({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(s.value=JSON.parse(M.bizData))}catch($){console.error("加载内存监控数据失败:",$)}finally{g.value=!1}}},y=async o=>{const i=o||a.value;if(i){l.value=!0;try{const[$,S]=I.value,M=await fa({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(T.value=JSON.parse(M.bizData))}catch($){console.error("加载磁盘监控数据失败:",$)}finally{l.value=!1}}},w=async o=>{const i=o||a.value;if(i){f.value=!0;try{const[$,S]=I.value,M=await ma({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(Y.value=JSON.parse(M.bizData))}catch($){console.error("加载磁盘IO监控数据失败:",$)}finally{f.value=!1}}},t=async o=>{const i=o||a.value;if(i){m.value=!0;try{const[$,S]=I.value,M=await va({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(A.value=JSON.parse(M.bizData))}catch($){console.error("加载网络监控数据失败:",$)}finally{m.value=!1}}},n=async o=>{const i=o||a.value;if(i){b.value=!0;try{const[$,S]=I.value,M=await ha({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(x.value=JSON.parse(M.bizData))}catch($){console.error("加载进程监控数据失败:",$)}finally{b.value=!1}}},e=async o=>{const i=o||a.value;i&&await Promise.all([N(i),u(i),y(i),w(i),t(i),n(i)])},d=()=>{_.value=[],s.value=[],T.value=[],Y.value=[],A.value=[],x.value=[]};return{selectedServerId:a,cpuLoading:k,memoryLoading:g,diskLoading:l,diskIOLoading:f,networkLoading:m,processLoading:b,cpuMetrics:_,memoryMetrics:s,diskMetrics:T,diskIOMetrics:Y,networkMetrics:A,processMetrics:x,timeRange:I,loadCPUMetrics:N,loadMemoryMetrics:u,loadDiskMetrics:y,loadDiskIOMetrics:w,loadNetworkMetrics:t,loadProcessMetrics:n,loadAllMetrics:e,clearAllMetrics:d,setSelectedServer:async o=>{a.value!==o&&(a.value=o,d(),o&&await e(o))},updateTimeRange:o=>{I.value=o}}}function ga(a){const k=Fe(),g=ia(),{loading:l,serverList:f,pageInfo:m,setServerList:b,updatePagination:_}=g,s=async x=>{var I,N,u;l.value=!0;try{let y=x;!y&&((I=a==null?void 0:a.value)!=null&&I.getFormData)&&(y=a.value.getFormData()||{});const t={...y?Object.fromEntries(Object.entries(y).filter(([,e])=>e!==""&&e!==null&&e!==void 0)):{},activeFlag:"Y",...Ae((N=m.value)==null?void 0:N.pageIndex,(u=m.value)==null?void 0:u.pageSize)},n=await la(t);if(n.oK){if(n.bizData){const e=JSON.parse(n.bizData),d=Array.isArray(e)?e:[];b(d)}if(n.pageQueryData){const e=JSON.parse(n.pageQueryData);_(e)}}else k.error(n.errMsg||"查询系统节点列表失败")}catch(y){console.error("加载系统节点列表失败:",y),k.error("加载系统节点列表失败")}finally{l.value=!1}};return{model:g,loading:l,serverList:f,pageInfo:m,loadServerNodes:s,handleSearch:async x=>{m.value&&(m.value.pageIndex=1),await s(x)},handlePageChange:async x=>{m.value&&(x.pageIndex!==void 0&&(m.value.pageIndex=x.pageIndex),x.pageSize!==void 0&&(m.value.pageSize=x.pageSize)),await s()},getServerDetail:async x=>{try{const I=await da(x);return I.oK&&I.bizData?JSON.parse(I.bizData):(k.error(I.errMsg||"获取节点详情失败"),null)}catch(I){return console.error("获取节点详情失败:",I),k.error("获取节点详情失败"),null}}}}function ya(a,k){const g=ga(k),{model:l}=g,f=async s=>{await g.handleSearch(s)},m=s=>{console.log("Toolbar button clicked:",s)},b=async({code:s,row:T})=>{if(T)switch(s){case"view":await _(T);break;default:console.log("Unknown menu key:",s)}},_=async s=>{console.log("查看节点详情:",s);const T=await g.getServerDetail(s.metricServerId);T&&console.log("节点详情:",T)};return{model:l,service:g,handleToolbarClick:m,handleMenuClick:b,handleSearch:f}}const wa=["id"],ba={key:0,class:"monitor-empty"},Ma={key:1,class:"monitor-container"},Da={class:"chart-row"},Sa={class:"chart-item"},$a={class:"chart-item"},xa={class:"chart-row"},ka={class:"chart-item"},Ta={class:"chart-item"},Ia={class:"chart-row"},Ca={class:"chart-item"},_a={class:"chart-item"},Na=Q({name:"ServerNodeManagement",__name:"ServerNodeManagement",setup(a){const k=C(),g=C(),{model:l,service:f,handleToolbarClick:m,handleMenuClick:b,handleSearch:_}=ya(g,k),s=pa(),T=W(()=>s.selectedServerId.value&&l.serverList.value.find(w=>w.metricServerId===s.selectedServerId.value)||null),Y=async({row:w})=>{w&&w.metricServerId&&await s.setSelectedServer(w.metricServerId)},A=async w=>{w&&(s.updateTimeRange(w),await s.loadCPUMetrics())},x=async w=>{w&&(s.updateTimeRange(w),await s.loadMemoryMetrics())},I=async w=>{w&&(s.updateTimeRange(w),await s.loadDiskMetrics())},N=async w=>{w&&(s.updateTimeRange(w),await s.loadDiskIOMetrics())},u=async w=>{w&&(s.updateTimeRange(w),await s.loadNetworkMetrics())},y=async w=>{w&&(s.updateTimeRange(w),await s.loadProcessMetrics())};return(w,t)=>(z(),H("div",{class:"server-node-management",id:r(f).model.moduleId},[c(r(Ie),{direction:"vertical","default-size":"300px"},{1:h(()=>[c(r(te),null,{default:h(()=>[c(r(Ie),{direction:"vertical","default-size":"80px"},{1:h(()=>[c(Ye,Te({ref_key:"searchFormRef",ref:k,"module-id":r(l).moduleId},r(l).searchFormConfig,{onSearch:r(_),onToolbarClick:r(m)}),null,16,["module-id","onSearch","onToolbarClick"])]),2:h(()=>[c(r(Le),Te({ref_key:"gridRef",ref:g,"module-id":r(l).moduleId,data:r(l).serverList,loading:r(l).loading},r(l).gridConfig,{onPageChange:r(f).handlePageChange,onMenuClick:r(b),onRowClick:Y}),null,16,["module-id","data","loading","onPageChange","onMenuClick"])]),_:1})]),_:1})]),2:h(()=>[c(r(te),null,{default:h(()=>[r(s).selectedServerId.value?(z(),H("div",Ma,[T.value?(z(),j(r(oa),{key:0,"server-info":T.value},null,8,["server-info"])):U("",!0),p("div",Da,[p("div",Sa,[c(r(at),{data:r(s).cpuMetrics.value,loading:r(s).cpuLoading.value,"warning-threshold":80,"danger-threshold":90,"cpu-detail-data":r(s).cpuMetrics.value,onRefresh:r(s).loadCPUMetrics,onTimeRangeChange:A},null,8,["data","loading","cpu-detail-data","onRefresh"])]),p("div",$a,[c(r(lt),{data:r(s).memoryMetrics.value,loading:r(s).memoryLoading.value,"warning-threshold":80,"danger-threshold":90,"memory-detail-data":r(s).memoryMetrics.value,onRefresh:r(s).loadMemoryMetrics,onTimeRangeChange:x},null,8,["data","loading","memory-detail-data","onRefresh"])])]),p("div",xa,[p("div",ka,[c(r(vt),{data:r(s).diskMetrics.value,loading:r(s).diskLoading.value,"warning-threshold":80,"danger-threshold":90,"disk-detail-data":r(s).diskMetrics.value,onRefresh:r(s).loadDiskMetrics,onTimeRangeChange:I},null,8,["data","loading","disk-detail-data","onRefresh"])]),p("div",Ta,[c(r(Mt),{data:r(s).diskIOMetrics.value,loading:r(s).diskIOLoading.value,"disk-io-detail-data":r(s).diskIOMetrics.value,onRefresh:r(s).loadDiskIOMetrics,onTimeRangeChange:N},null,8,["data","loading","disk-io-detail-data","onRefresh"])])]),p("div",Ia,[p("div",Ca,[c(r(Tt),{data:r(s).networkMetrics.value,loading:r(s).networkLoading.value,"network-detail-data":r(s).networkMetrics.value,"upload-color":"#ff4d4f","download-color":"#52c41a",onRefresh:r(s).loadNetworkMetrics,onTimeRangeChange:u},null,8,["data","loading","network-detail-data","onRefresh"])]),p("div",_a,[c(r(zt),{data:r(s).processMetrics.value,loading:r(s).processLoading.value,"process-detail-data":r(s).processMetrics.value,onRefresh:r(s).loadProcessMetrics,onTimeRangeChange:y},null,8,["data","loading","process-detail-data","onRefresh"])])])])):(z(),H("div",ba,[c(r(re),{description:"请在上方列表中选择一个节点查看监控数据"})]))]),_:1})]),_:1})],8,wa))}}),Za=Z(Na,[["__scopeId","data-v-0c083a3a"]]);export{Za as default};
