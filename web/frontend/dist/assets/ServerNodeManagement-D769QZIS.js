import{c as Ae,G as Le,S as Ye}from"./SearchForm-QXeOPYmP.js";import{d as Q,c as W,h as j,o as z,cv as Oe,w as h,a5 as ne,a4 as Pe,n as He,f as a,aa as Re,_ as Z,r as C,a7 as le,v as de,a8 as ce,g as p,b as H,i as U,e as u,I as ue,a9 as re,J as fe,K as G,j as q,ab as L,ac as $e,ad as Be,ag as oe,t as V,ah as Ee,af as Ue,m as Fe,am as Te}from"./index-DjxxKbEp.js";import{G as Ie}from"./GPane-CsXIYqCJ.js";import{R as me,D as Ge,A as Ce,a as xe,C as We,G as Ke,W as Ve,b as qe}from"./WindowsOutlined-CNU6um_s.js";import{u as ve,a as he,b as pe,c as ge,d as ye,e as we,f as be,g as Me,i as De,L as Ne}from"./installCanvasRenderer-BddeS-3K.js";import{N as Se}from"./DatePicker-CHfUawd3.js";import{_ as Je}from"./DataTable-BRkaRjr2.js";/* empty css                                                                    */import"./index-DR_R-bYe.js";import"./RefreshOutline-RMMvHLjq.js";import"./OptionsOutline-CJ-6A-d8.js";import"./InformationCircleOutline-Co9yRxRj.js";import"./Grid-DuzVlp9K.js";import"./Select-DKaQ0jI7.js";import"./InputNumber-CTlCGkXq.js";import"./Switch-CTvADbq_.js";import"./Checkbox-DyGGdka1.js";import"./Radio-o4XRDMGx.js";import"./RadioGroup-PBnJklQh.js";import"./prop-BjyUHhTu.js";import"./download-C2161hUv.js";const Xe=Q({name:"GCard",__name:"GCard",props:{title:{},showTitle:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},hoverable:{type:[Boolean,String],default:!1},size:{default:"medium"},contentStyle:{},headerStyle:{},segmented:{},embedded:{type:Boolean,default:!1},class:{},style:{}},setup(l){const k=l,g=W(()=>k.contentStyle?k.contentStyle:{padding:0});return(o,d)=>(z(),j(a(Re),{class:He(["g-card",{"g-card--no-title":!o.showTitle,"g-card--hoverable":o.hoverable===!0||o.hoverable==="hover","g-card--shadow-always":o.hoverable==="always"},k.class]),title:o.showTitle?o.title||"":void 0,bordered:o.bordered,size:o.size,segmented:o.segmented,embedded:o.embedded,"content-style":g.value,"header-style":o.headerStyle,style:Pe(o.style)},Oe({default:h(()=>[ne(o.$slots,"default",{},void 0,!0)]),_:2},[o.showTitle&&o.$slots.header?{name:"header",fn:h(()=>[ne(o.$slots,"header",{},void 0,!0)]),key:"0"}:void 0,o.showTitle&&o.$slots["header-extra"]?{name:"header-extra",fn:h(()=>[ne(o.$slots,"header-extra",{},void 0,!0)]),key:"1"}:void 0,o.$slots.action?{name:"action",fn:h(()=>[ne(o.$slots,"action",{},void 0,!0)]),key:"2"}:void 0,o.$slots.cover?{name:"cover",fn:h(()=>[ne(o.$slots,"cover",{},void 0,!0)]),key:"3"}:void 0,o.$slots.footer?{name:"footer",fn:h(()=>[ne(o.$slots,"footer",{},void 0,!0)]),key:"4"}:void 0]),1032,["class","title","bordered","size","segmented","embedded","content-style","header-style","style"]))}}),te=Z(Xe,[["__scopeId","data-v-7815dbb8"]]),je={class:"card-extra"},Qe={class:"chart-container"},Ze={key:0,class:"chart-loading"},et={key:1,class:"chart-empty"},tt=Q({__name:"CpuMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},cpuDetailData:{type:Array,default:()=>[]},userColor:{type:String,default:"#1890ff"},systemColor:{type:String,default:"#52c41a"},idleColor:{type:String,default:"#d9d9d9"}},emits:["refresh","time-range-change"],setup(l,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=C(null);let o=null;const d=l,m=k,b=Date.now(),x=b-3600*1e3,r=C([x,b]),T={最近1小时:()=>{const f=Date.now();return[f-3600*1e3,f]},最近6小时:()=>{const f=Date.now();return[f-6*3600*1e3,f]},最近12小时:()=>{const f=Date.now();return[f-12*3600*1e3,f]},最近24小时:()=>{const f=Date.now();return[f-24*3600*1e3,f]},最近7天:()=>{const f=Date.now();return[f-7*24*3600*1e3,f]}},Y=()=>{g.value&&(o=De(g.value),window.addEventListener("resize",_),A())},A=()=>{if(!o)return;if(!d.data||!Array.isArray(d.data)||d.data.length===0){o.clear();return}const f=d.data.map(s=>s.collectTime).sort(),y=new Map;d.data.forEach(s=>{y.set(s.collectTime,s)});const w=[{name:"CPU使用率",type:"line",data:f.map(s=>{const t=y.get(s);return{value:t?t.usagePercent:0,detail:t}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:d.userColor}},{name:"用户态使用率",type:"line",data:f.map(s=>{const t=y.get(s);return{value:t?t.userPercent:0,detail:t}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:d.systemColor}},{name:"系统态使用率",type:"line",data:f.map(s=>{const t=y.get(s);return{value:t?t.systemPercent:0,detail:t}}),smooth:!0,showSymbol:!1,lineStyle:{width:2},itemStyle:{color:d.idleColor}}],e={tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:s=>{const t=s[0].data.detail;let c="";return t&&(c+="CPU详细信息:<br/>",c+=`物理核心数: ${t.coreCount}<br/>`,c+=`逻辑核心数: ${t.logicalCount}<br/>`,c+=`1分钟负载: ${t.loadAvg1.toFixed(2)}<br/>`,c+=`5分钟负载: ${t.loadAvg5.toFixed(2)}<br/>`,c+=`15分钟负载: ${t.loadAvg15.toFixed(2)}<br/>`,c+=`IO等待率: ${t.ioWaitPercent.toFixed(2)}%<br/>`,c+=`硬中断率: ${t.irqPercent.toFixed(2)}%<br/>`,c+=`软中断率: ${t.softIrqPercent.toFixed(2)}%<br/>`,c+="<br/>"),s.forEach(v=>{const D=v.marker,n=v.seriesName,i=`${v.value.toFixed(2)}%`;c+=`${D} ${n}: ${i}<br/>`}),c},axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["CPU使用率","用户态使用率","系统态使用率"],type:"scroll",bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:f.map(s=>L(s,"HH:mm:ss")),axisLabel:{interval:Math.floor(f.length/10)}},yAxis:{type:"value",axisLabel:{formatter:s=>s.toFixed(2)+"%"},max:100,min:0},series:w};o.setOption(e,!0)},_=()=>{o==null||o.resize()},I=()=>{m("refresh")},R=f=>{m("time-range-change",f)};return le(()=>d.data,()=>{A()},{deep:!0}),de(()=>{Y(),m("time-range-change",r.value)}),ce(()=>{o&&(o.dispose(),o=null),window.removeEventListener("resize",_)}),(f,y)=>(z(),j(a(te),{title:"CPU使用率","show-title":!0},{"header-extra":h(()=>[p("div",je,[u(a(Se),{value:r.value,"onUpdate:value":[y[0]||(y[0]=w=>r.value=w),R],type:"datetimerange",shortcuts:T,placeholder:"选择时间范围",size:"small"},null,8,["value"]),u(a(fe),{size:"small",onClick:I,loading:l.loading},{icon:h(()=>[u(a(q),null,{default:h(()=>[u(a(me))]),_:1})]),default:h(()=>[y[1]||(y[1]=G(" 刷新 "))]),_:1},8,["loading"])])]),default:h(()=>[p("div",Qe,[p("div",{ref_key:"chartRef",ref:g,class:"chart-element"},null,512),l.loading?(z(),H("div",Ze,[u(a(ue),{size:"large"})])):U("",!0),!l.loading&&(!l.data||!Array.isArray(l.data)||l.data.length===0)?(z(),H("div",et,[u(a(re),{description:"暂无数据"})])):U("",!0)])]),_:1}))}}),at=Z(tt,[["__scopeId","data-v-1ffd38f9"]]),rt={class:"card-extra"},st={class:"chart-container"},nt={key:0,class:"chart-loading"},ot={key:1,class:"chart-empty"},it=Q({__name:"MemoryMonitor",props:{title:{type:String,default:"内存使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},memoryDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(l,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=l,o=W(()=>g.title||"内存使用率"),d=W(()=>g.warningThreshold),m=W(()=>g.dangerThreshold),b=k,x=C(null);let r=null;const T=Date.now(),Y=T-3600*1e3,A=C([Y,T]),_={最近1小时:()=>{const t=Date.now();return[t-3600*1e3,t]},最近6小时:()=>{const t=Date.now();return[t-6*3600*1e3,t]},最近12小时:()=>{const t=Date.now();return[t-12*3600*1e3,t]},最近24小时:()=>{const t=Date.now();return[t-24*3600*1e3,t]},最近7天:()=>{const t=Date.now();return[t-7*24*3600*1e3,t]}},I=W(()=>{if(!g.data||g.data.length===0)return[];const t=new Map;return g.data.forEach(v=>{const D=v.collectTime;t.has(D)||t.set(D,[]),t.get(D).push(v.usagePercent)}),Array.from(t.entries()).map(([v,D])=>{const n=g.data.find(i=>i.collectTime===v);return{time:v,value:Math.round(D.reduce((i,$)=>i+$,0)/D.length*100)/100,detail:n?{totalMemory:n.totalMemory,usedMemory:n.usedMemory,availableMemory:n.availableMemory,freeMemory:n.freeMemory,cachedMemory:n.cachedMemory,buffersMemory:n.buffersMemory,swapTotal:n.swapTotal,swapUsed:n.swapUsed,swapFree:n.swapFree,swapUsagePercent:n.swapUsagePercent}:null}}).sort((v,D)=>new Date(v.time).getTime()-new Date(D.time).getTime())}),R=t=>{if(t===0)return"0 B";const c=["B","KB","MB","GB","TB","PB"],v=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,v)).toFixed(2)} ${c[v]}`},f=()=>{b("refresh")},y=t=>{b("time-range-change",t)},w=()=>{x.value&&(r=De(x.value),window.addEventListener("resize",s),e())},e=()=>{if(!r)return;const t=I.value;if(t.length===0){r.clear();return}const c={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:function(v){const D=v[0],n=D.data.detail;if(!n)return`${D.marker}${D.seriesName}: ${D.data.value}%`;let i="";return i+=`${D.marker}内存使用率: <b>${D.data.value}%</b><br/>`,i+="<br/>详细信息:<br/>",i+=`总内存: ${R(n.totalMemory)}<br/>`,i+=`已用内存: ${R(n.usedMemory)}<br/>`,i+=`可用内存: ${R(n.availableMemory)}<br/>`,i+=`空闲内存: ${R(n.freeMemory)}<br/>`,i+=`缓存内存: ${R(n.cachedMemory)}<br/>`,i+=`缓冲区内存: ${R(n.buffersMemory)}<br/>`,i+="<br/>交换分区:<br/>",i+=`总交换空间: ${R(n.swapTotal)}<br/>`,i+=`已用交换空间: ${R(n.swapUsed)}<br/>`,i+=`空闲交换空间: ${R(n.swapFree)}<br/>`,i+=`交换使用率: ${n.swapUsagePercent.toFixed(1)}%`,i}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:t.map(v=>L(new Date(v.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:"内存使用率",type:"line",data:t.map(v=>({value:v.value,detail:v.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#52c41a"},itemStyle:{color:function(v){const D=v.data.value;return D>=m.value?"#ff4d4f":D>=d.value?"#faad14":"#52c41a"}},areaStyle:{color:new Ne(0,0,0,1,[{offset:0,color:"rgba(82, 196, 26, 0.3)"},{offset:1,color:"rgba(82, 196, 26, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:d.value,label:{formatter:`警告 ${d.value}%`,position:"start"}},{yAxis:m.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`危险 ${m.value}%`,position:"start"}}]}}]};r.setOption(c)},s=()=>{r==null||r.resize()};return le(()=>g.data,()=>{e()},{deep:!0}),de(()=>{w(),b("time-range-change",A.value)}),ce(()=>{r&&(r.dispose(),r=null),window.removeEventListener("resize",s)}),(t,c)=>(z(),j(a(te),{title:o.value,"show-title":!0},{"header-extra":h(()=>[p("div",rt,[u(a(Se),{value:A.value,"onUpdate:value":[c[0]||(c[0]=v=>A.value=v),y],type:"datetimerange",shortcuts:_,placeholder:"选择时间范围",size:"small"},null,8,["value"]),u(a(fe),{size:"small",onClick:f,loading:l.loading},{icon:h(()=>[u(a(q),null,{default:h(()=>[u(a(me))]),_:1})]),default:h(()=>[c[1]||(c[1]=G(" 刷新 "))]),_:1},8,["loading"])])]),default:h(()=>[p("div",st,[p("div",{ref_key:"chartRef",ref:x,class:"chart-element"},null,512),l.loading?(z(),H("div",nt,[u(a(ue),{size:"large"})])):U("",!0),!l.loading&&!I.value.length?(z(),H("div",ot,[u(a(re),{description:"暂无数据"})])):U("",!0)])]),_:1},8,["title"]))}}),lt=Z(it,[["__scopeId","data-v-058d593d"]]),dt={class:"card-extra"},ct={class:"chart-container"},ut={key:0,class:"chart-loading"},ft={key:1,class:"chart-empty"},mt=Q({__name:"DiskMonitor",props:{title:{type:String,default:"磁盘使用率"},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},warningThreshold:{type:Number,default:80},dangerThreshold:{type:Number,default:90},diskDetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(l,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=l,o=W(()=>g.title||"磁盘使用率"),d=k,m=C(null);let b=null;const x=Date.now(),r=x-3600*1e3,T=C([r,x]),Y={最近1小时:()=>{const e=Date.now();return[e-3600*1e3,e]},最近6小时:()=>{const e=Date.now();return[e-6*3600*1e3,e]},最近12小时:()=>{const e=Date.now();return[e-12*3600*1e3,e]},最近24小时:()=>{const e=Date.now();return[e-24*3600*1e3,e]},最近7天:()=>{const e=Date.now();return[e-7*24*3600*1e3,e]}},A=W(()=>{if(!g.data||g.data.length===0)return[];const e=new Map;return g.data.forEach(s=>{const t=s.collectTime;e.has(t)||e.set(t,{values:[],partitions:[]});const c=e.get(t);c.values.push(s.usagePercent),c.partitions.push(s)}),Array.from(e.entries()).map(([s,t])=>({time:s,value:Math.round(t.values.reduce((c,v)=>c+v,0)/t.values.length*100)/100,detail:{partitions:t.partitions,partitionCount:t.partitions.length,totalSpace:t.partitions.reduce((c,v)=>c+v.totalSpace,0),usedSpace:t.partitions.reduce((c,v)=>c+v.usedSpace,0),freeSpace:t.partitions.reduce((c,v)=>c+v.freeSpace,0),avgUsagePercent:Math.round(t.values.reduce((c,v)=>c+v,0)/t.values.length*100)/100}}))}),_=e=>{if(e===0)return"0 B";const s=["B","KB","MB","GB","TB","PB"],t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(2)} ${s[t]}`},I=()=>{d("refresh")},R=e=>{d("time-range-change",e)},f=()=>{m.value&&(b=De(m.value),window.addEventListener("resize",w),y())},y=()=>{if(!b)return;const e=A.value;if(e.length===0){b.clear();return}const s=W(()=>g.warningThreshold??80),t=W(()=>g.dangerThreshold??90),c={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:function(v){const D=v[0],n=D.data.detail;let i="";return i+=`${D.marker}磁盘使用率: <b>${D.data.value}%</b><br/>`,i+="<br/>详细信息:<br/>",i+=`分区数量: ${n.partitionCount}<br/>`,i+=`总空间: ${_(n.totalSpace)}<br/>`,i+=`已用空间: ${_(n.usedSpace)}<br/>`,i+=`空闲空间: ${_(n.freeSpace)}<br/>`,n.partitions.length>0&&(i+="<br/>分区详情:<br/>",n.partitions.slice(0,3).forEach(S=>{i+=`${S.mountPoint}: ${S.usagePercent.toFixed(1)}% (${_(S.usedSpace)}/${_(S.totalSpace)})<br/>`}),n.partitions.length>3&&(i+=`... 还有 ${n.partitions.length-3} 个分区`)),i}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e.map(v=>L(new Date(v.time),"HH:mm:ss")),axisLabel:{rotate:45}},yAxis:{type:"value",min:0,max:100,splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}%"}},series:[{name:"磁盘使用率",type:"line",data:e.map(v=>({value:v.value,detail:v.detail})),smooth:!0,showSymbol:!0,symbolSize:6,lineStyle:{width:2,color:"#faad14"},itemStyle:{color:function(v){const D=v.data.value;return D>=t.value?"#ff4d4f":(D>=s.value,"#faad14")}},areaStyle:{color:new Ne(0,0,0,1,[{offset:0,color:"rgba(250, 173, 20, 0.3)"},{offset:1,color:"rgba(250, 173, 20, 0.1)"}])},markLine:{silent:!0,lineStyle:{color:"#faad14"},data:[{yAxis:s.value,label:{formatter:`警告 ${s.value}%`,position:"start"}},{yAxis:t.value,lineStyle:{color:"#ff4d4f"},label:{formatter:`危险 ${t.value}%`,position:"start"}}]}}]};b.setOption(c)},w=()=>{b==null||b.resize()};return le(()=>g.data,()=>{y()},{deep:!0}),de(()=>{f(),d("time-range-change",T.value)}),ce(()=>{b&&(b.dispose(),b=null),window.removeEventListener("resize",w)}),(e,s)=>(z(),j(a(te),{title:o.value,"show-title":!0},{"header-extra":h(()=>[p("div",dt,[u(a(Se),{value:T.value,"onUpdate:value":[s[0]||(s[0]=t=>T.value=t),R],type:"datetimerange",shortcuts:Y,placeholder:"选择时间范围",size:"small"},null,8,["value"]),u(a(fe),{size:"small",onClick:I,loading:l.loading},{icon:h(()=>[u(a(q),null,{default:h(()=>[u(a(me))]),_:1})]),default:h(()=>[s[1]||(s[1]=G(" 刷新 "))]),_:1},8,["loading"])])]),default:h(()=>[p("div",ct,[p("div",{ref_key:"chartRef",ref:m,class:"chart-element"},null,512),l.loading?(z(),H("div",ut,[u(a(ue),{size:"large"})])):U("",!0),!l.loading&&!A.value.length?(z(),H("div",ft,[u(a(re),{description:"暂无数据"})])):U("",!0)])]),_:1},8,["title"]))}}),vt=Z(mt,[["__scopeId","data-v-172ca3f4"]]),ht={class:"card-extra"},pt={class:"chart-container"},gt={key:0,class:"chart-loading"},yt={key:1,class:"chart-empty"},wt={key:0,class:"detail-section"},bt=Q({__name:"DiskIOMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},diskIODetailData:{type:Array,default:()=>[]}},emits:["refresh","time-range-change"],setup(l,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=C(null);let o=null;const d=l,m=k,b=Date.now(),x=b-3600*1e3,r=C([x,b]),T={最近1小时:()=>{const e=Date.now();return[e-3600*1e3,e]},最近6小时:()=>{const e=Date.now();return[e-6*3600*1e3,e]},最近12小时:()=>{const e=Date.now();return[e-12*3600*1e3,e]},最近24小时:()=>{const e=Date.now();return[e-24*3600*1e3,e]},最近7天:()=>{const e=Date.now();return[e-7*24*3600*1e3,e]}},Y={pageSize:5,page:1},A=W(()=>[{title:"设备名称",key:"deviceName"},{title:"读取速率",key:"readRate",render:e=>$e(e.readRate)+"/s"},{title:"写入速率",key:"writeRate",render:e=>$e(e.writeRate)+"/s"},{title:"读取次数",key:"readCount"},{title:"写入次数",key:"writeCount"},{title:"采集时间",key:"collectTime",render:e=>L(e.collectTime)}]),_=W(()=>{if(!d.diskIODetailData)return[];const e=new Map;return d.diskIODetailData.forEach(s=>{const t=e.get(s.deviceName);(!t||new Date(s.collectTime)>new Date(t.collectTime))&&e.set(s.deviceName,s)}),Array.from(e.values())}),I=()=>{g.value&&(o=De(g.value),window.addEventListener("resize",f),R())},R=()=>{if(!o)return;if(!d.data||!Array.isArray(d.data)||d.data.length===0){o.clear();return}const e=new Map;d.data.forEach(n=>{var i;e.has(n.collectTime)||e.set(n.collectTime,new Map),(i=e.get(n.collectTime))==null||i.set(n.deviceName,n)});const s=Array.from(e.keys()).sort(),t=new Set;d.data.forEach(n=>t.add(n.deviceName));const c=[{read:"#1890ff",write:"#36cfc9"},{read:"#722ed1",write:"#eb2f96"},{read:"#fa8c16",write:"#faad14"},{read:"#52c41a",write:"#a0d911"},{read:"#f5222d",write:"#ff7a45"}],v=[];Array.from(t).forEach((n,i)=>{const $=i%c.length,S=c[$],M=[],E=[];s.forEach(F=>{var B;const N=(B=e.get(F))==null?void 0:B.get(n);M.push(N?N.readRate:0),E.push(N?N.writeRate:0)}),v.push({name:`${n} 读取`,type:"line",data:M,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:S.read}}),v.push({name:`${n} 写入`,type:"line",data:E,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:S.write}})});const D={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:n=>{const i=Array.isArray(n)?n[0]:n,$=s[i.dataIndex];let S=L($,"YYYY-MM-DD HH:mm:ss")+"<br/>";const M=new Map;return n.forEach(E=>{var B;const N=E.seriesName.split(" ")[0];M.has(N)||M.set(N,[]),(B=M.get(N))==null||B.push(E)}),M.forEach((E,F)=>{S+=`<div style="margin-top: 3px;"><b>${F}</b></div>`,E.forEach(N=>{const B=N.color,P=N.seriesName.includes("读取")?"读取":"写入",K=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${B};border:1px solid ${B}"></span>`;S+=`<div style="padding-left: 12px;line-height:18px">${K}${P}: ${$e(Number(N.value))}/s</div>`})}),S}},legend:{type:"scroll",bottom:0,padding:[10,20],selected:v.reduce((n,i)=>(n[i.name]=!0,n),{}),formatter:n=>{const i=n.split(" ")[0],$=n.includes("读取")?"读取":"写入";return`${i} ${$}`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:s.map(n=>L(n,"HH:mm:ss")),axisLabel:{interval:Math.floor(s.length/10)}},yAxis:{type:"value",axisLabel:{formatter:n=>$e(n)+"/s"}},series:v};o.setOption(D,!0)},f=()=>{o==null||o.resize()},y=()=>{m("refresh")},w=e=>{m("time-range-change",e)};return le(()=>d.data,()=>{R()},{deep:!0}),de(()=>{I(),m("time-range-change",r.value)}),ce(()=>{o&&(o.dispose(),o=null),window.removeEventListener("resize",f)}),(e,s)=>(z(),j(a(te),{title:"磁盘IO监控","show-title":!0},{"header-extra":h(()=>[p("div",ht,[u(a(Se),{value:r.value,"onUpdate:value":[s[0]||(s[0]=t=>r.value=t),w],type:"datetimerange",shortcuts:T,placeholder:"选择时间范围",size:"small"},null,8,["value"]),u(a(fe),{size:"small",onClick:y,loading:l.loading},{icon:h(()=>[u(a(q),null,{default:h(()=>[u(a(me))]),_:1})]),default:h(()=>[s[1]||(s[1]=G(" 刷新 "))]),_:1},8,["loading"])])]),default:h(()=>[p("div",pt,[p("div",{ref_key:"chartRef",ref:g,class:"chart-element"},null,512),l.loading?(z(),H("div",gt,[u(a(ue),{size:"large"})])):U("",!0),!l.loading&&(!l.data||!Array.isArray(l.data)||l.data.length===0)?(z(),H("div",yt,[u(a(re),{description:"暂无数据"})])):U("",!0)]),l.diskIODetailData&&l.diskIODetailData.length>0?(z(),H("div",wt,[u(a(Be),null,{default:h(()=>s[2]||(s[2]=[G("磁盘IO详情")])),_:1}),u(a(Je),{columns:A.value,data:_.value,pagination:Y,bordered:!1,size:"small"},null,8,["columns","data"])])):U("",!0)]),_:1}))}}),Mt=Z(bt,[["__scopeId","data-v-09f602e3"]]),Dt={class:"card-extra"},St={class:"chart-container"},$t={key:0,class:"chart-loading"},_t={key:1,class:"chart-empty"},kt=Q({__name:"NetworkMonitor",props:{title:{},data:{},loading:{type:Boolean},uploadColor:{},downloadColor:{}},emits:["refresh","time-range-change"],setup(l,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=l,o={title:"网络流量"},d=k,m=C(null);let b=null;const x=Date.now(),r=x-3600*1e3,T=C([r,x]),Y={最近1小时:()=>{const e=Date.now();return[e-3600*1e3,e]},最近6小时:()=>{const e=Date.now();return[e-6*3600*1e3,e]},最近12小时:()=>{const e=Date.now();return[e-12*3600*1e3,e]},最近24小时:()=>{const e=Date.now();return[e-24*3600*1e3,e]},最近7天:()=>{const e=Date.now();return[e-7*24*3600*1e3,e]}},A=W(()=>{if(!g.data||g.data.length===0)return[];const e=new Map;return g.data.forEach(s=>{const t=s.collectTime;e.has(t)||e.set(t,{interfaces:[]}),e.get(t).interfaces.push(s)}),Array.from(e.entries()).sort((s,t)=>new Date(s[0]).getTime()-new Date(t[0]).getTime()).map(([s,t])=>({time:s,detail:{interfaces:t.interfaces,interfaceCount:t.interfaces.length}}))}),_=e=>e===0?"0 B/s":e<1024?`${e.toFixed(2)} B/s`:e<1024*1024?`${(e/1024).toFixed(2)} KB/s`:e<1024*1024*1024?`${(e/(1024*1024)).toFixed(2)} MB/s`:`${(e/(1024*1024*1024)).toFixed(2)} GB/s`,I=()=>{d("refresh")},R=e=>{d("time-range-change",e)},f=()=>{m.value&&(b=De(m.value),window.addEventListener("resize",w),y())},y=()=>{if(!b)return;const e=A.value;if(e.length===0){b.clear();return}const s=e.map(S=>L(new Date(S.time),"HH:mm:ss")),t=new Set,c=[],v=[];e.forEach(S=>{S.detail.interfaces.forEach(M=>{t.has(M.interfaceName)||(M.ipAddresses&&M.ipAddresses.includes(".")&&!M.ipAddresses.includes(":")||M.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?c.push(M.interfaceName):v.push(M.interfaceName),t.add(M.interfaceName))})});const D=[...c,...v],n=[{send:"#fa541c",receive:"#73d13d"},{send:"#722ed1",receive:"#13c2c2"},{send:"#f5222d",receive:"#52c41a"},{send:"#fa8c16",receive:"#1890ff"},{send:"#eb2f96",receive:"#fadb14"}],i=[];D.forEach((S,M)=>{const E=M%n.length,F=n[E],N=e.map(P=>{const K=P.detail.interfaces.find(J=>J.interfaceName===S);return K?Math.round(K.sendRate/(1024*1024)*100)/100:0}),B=e.map(P=>{const K=P.detail.interfaces.find(J=>J.interfaceName===S);return K?Math.round(K.receiveRate/(1024*1024)*100)/100:0}),se=c.includes(S)?2:1;i.push({name:`${S} 上传`,type:"line",data:N,smooth:!0,showSymbol:!1,lineStyle:{width:se,type:"solid"},itemStyle:{color:F.send},emphasis:{focus:"series"},tooltip:{valueFormatter:P=>`${P} MB/s`}}),i.push({name:`${S} 下载`,type:"line",data:B,smooth:!0,showSymbol:!1,lineStyle:{width:se,type:"dashed"},itemStyle:{color:F.receive},emphasis:{focus:"series"},tooltip:{valueFormatter:P=>`${P} MB/s`}})});const $={title:{show:!1},tooltip:{trigger:"axis",confine:!1,appendToBody:!0,axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(S){var se;const M=S[0].axisValue,E=s.indexOf(M),F=(se=e[E])==null?void 0:se.detail;let N=`${M}<br/>`;const B=new Map;if(S.forEach(P=>{const J=P.seriesName.split(" ")[0];B.has(J)||B.set(J,[]),B.get(J).push(P)}),F){const P=new Set;B.forEach((X,O)=>{P.add(O)}),F.interfaces.forEach(X=>{P.add(X.interfaceName)}),N+=`接口总数: ${F.interfaceCount}<br/>`;const K=[],J=[];Array.from(P).forEach(X=>{const O=F.interfaces.find(_e=>_e.interfaceName===X);if(!O)return;O.ipAddresses&&O.ipAddresses.includes(".")&&!O.ipAddresses.includes(":")||O.interfaceName.match(/eth\d+|en\d+|bond\d+|wlan\d+|ens\d+|enp\d+|lo\b|vlan\d+/i)?K.push(X):J.push(X)});const ke=[...K,...J];ke.length>0&&(N+="<br/>接口详情:<br/>",ke.forEach(X=>{const O=F.interfaces.find(_e=>_e.interfaceName===X);if(!O)return;N+='<div style="padding:3px 0;border-bottom:1px solid #eee;">',N+=`<b>${X}</b>: `,K.includes(X)&&(N+='<span style="color:#1890ff;">[IPv4]</span> '),N+=`<br/><span style="padding-left:10px;color:#ff4d4f;">↑${_(O.sendRate)}</span> `,N+=`<span style="padding-left:5px;color:#52c41a;">↓${_(O.receiveRate)}</span>`,(O.errorsReceived>0||O.errorsSent>0)&&(N+=` <span style="color:#ff7875;">(错误: ${O.errorsReceived+O.errorsSent})</span>`),O.ipAddresses&&(N+=`<br/><span style="padding-left:10px;color:#999;font-size:12px;">IP: ${O.ipAddresses}</span>`),N+="</div>"}))}return N}},legend:{type:"scroll",data:i.map(S=>S.name),bottom:0,padding:[5,10],selected:i.reduce((S,M)=>{const E=M.name.split(" ")[0];return S[M.name]=c.includes(E),S},{})},grid:{left:"3%",right:"4%",bottom:"40px",top:"10px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:s,axisLabel:{rotate:45}},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{formatter:S=>S.toFixed(2)+" MB/s"}},series:i};b.setOption($)},w=()=>{b==null||b.resize()};return le(()=>g.data,()=>{y()},{deep:!0}),de(()=>{f(),d("time-range-change",T.value)}),ce(()=>{b&&(b.dispose(),b=null),window.removeEventListener("resize",w)}),(e,s)=>(z(),j(a(te),{title:e.title||o.title,"show-title":!0},{"header-extra":h(()=>[p("div",Dt,[u(a(Se),{value:T.value,"onUpdate:value":[s[0]||(s[0]=t=>T.value=t),R],type:"datetimerange",shortcuts:Y,placeholder:"选择时间范围",size:"small"},null,8,["value"]),u(a(fe),{size:"small",onClick:I,loading:e.loading},{icon:h(()=>[u(a(q),null,{default:h(()=>[u(a(me))]),_:1})]),default:h(()=>[s[1]||(s[1]=G(" 刷新 "))]),_:1},8,["loading"])])]),default:h(()=>[p("div",St,[p("div",{ref_key:"chartRef",ref:m,class:"chart-element"},null,512),e.loading?(z(),H("div",$t,[u(a(ue),{size:"large"})])):U("",!0),!e.loading&&!A.value.length?(z(),H("div",_t,[u(a(re),{description:"暂无数据"})])):U("",!0)])]),_:1},8,["title"]))}}),Tt=Z(kt,[["__scopeId","data-v-c822fd97"]]),It={class:"card-extra"},Ct={class:"chart-container"},xt={key:0,class:"chart-loading"},Rt={key:1,class:"chart-empty"},Nt=Q({__name:"ProcessMonitor",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},processDetailData:{type:Array,default:()=>[]},cpuColor:{type:String,default:"#1890ff"},memoryColor:{type:String,default:"#52c41a"}},emits:["refresh","time-range-change"],setup(l,{emit:k}){ve([he,pe,ge,ye,we,be,Me]);const g=C(null);let o=null;const d=l,m=k,b=Date.now(),x=b-3600*1e3,r=C([x,b]),T={最近1小时:()=>{const f=Date.now();return[f-3600*1e3,f]},最近6小时:()=>{const f=Date.now();return[f-6*3600*1e3,f]},最近12小时:()=>{const f=Date.now();return[f-12*3600*1e3,f]},最近24小时:()=>{const f=Date.now();return[f-24*3600*1e3,f]},最近7天:()=>{const f=Date.now();return[f-7*24*3600*1e3,f]}},Y=()=>{g.value&&(o=De(g.value),window.addEventListener("resize",_),A())},A=()=>{if(!o)return;if(!d.data||d.data.length===0){o.clear();return}const f=new Map;d.data.forEach(t=>{var c;f.has(t.collectTime)||f.set(t.collectTime,[]),(c=f.get(t.collectTime))==null||c.push(t)});const y=Array.from(f.keys()).sort(),w=[],e=[];y.forEach(t=>{const c=f.get(t)||[];if(c.length>0){const v=c.reduce((n,i)=>n+i.cpuPercent,0)/c.length,D=c.reduce((n,i)=>n+i.memoryPercent,0)/c.length;w.push(Number(v.toFixed(2))),e.push(Number(D.toFixed(2)))}else w.push(0),e.push(0)});const s={tooltip:{trigger:"axis",confine:!1,appendToBody:!0,formatter:t=>{const c=t[0].dataIndex,v=f.get(y[c])||[];let D=L(y[c],"YYYY-MM-DD HH:mm:ss")+"<br/>";return t.forEach(n=>{const $=`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${n.color};"></span>`;D+=$+n.seriesName+": "+n.value+"%<br/>"}),v.length>0&&(D+=`<span style="color:#666;">进程数量: ${v.length}</span><br/>`),v.length>0&&(D+="<br/><b>进程详情</b><br/>",[...v].sort((i,$)=>$.cpuPercent-i.cpuPercent).slice(0,5).forEach((i,$)=>{D+='<div style="padding-left:10px;margin:2px 0;">',D+=`<b>${$+1}. ${i.processName}</b> <span style="color:#666;">(PID: ${i.processId})</span><br/>`,D+=`<span style="padding-left:15px;">CPU: ${i.cpuPercent.toFixed(2)}%, `,D+=`内存: ${i.memoryPercent.toFixed(2)}%, `,D+=`线程: ${i.threadCount}</span>`,D+="</div>"}),v.length>5&&(D+=`<div style="padding-left:10px;color:#999;">... 以及 ${v.length-5} 个其他进程</div>`)),D}},legend:{data:["平均CPU使用率","平均内存使用率"],bottom:0,padding:[10,20]},grid:{left:"3%",right:"4%",bottom:"15%",top:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:y.map(t=>L(t,"HH:mm:ss")),axisLabel:{interval:Math.floor(y.length/10)}},yAxis:{type:"value",min:0,max:100,position:"left",axisLabel:{formatter:"{value}%"}},series:[{name:"平均CPU使用率",type:"line",data:w,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"solid"},itemStyle:{color:d.cpuColor}},{name:"平均内存使用率",type:"line",data:e,smooth:!0,showSymbol:!1,lineStyle:{width:2,type:"dashed"},itemStyle:{color:d.memoryColor}}]};o.setOption(s)},_=()=>{o==null||o.resize()},I=()=>{m("refresh")},R=f=>{m("time-range-change",f)};return le(()=>d.data,()=>{A()},{deep:!0}),de(()=>{Y(),m("time-range-change",r.value)}),ce(()=>{o&&(o.dispose(),o=null),window.removeEventListener("resize",_)}),(f,y)=>(z(),j(a(te),{title:"进程监控","show-title":!0},{"header-extra":h(()=>[p("div",It,[u(a(Se),{value:r.value,"onUpdate:value":[y[0]||(y[0]=w=>r.value=w),R],type:"datetimerange",shortcuts:T,placeholder:"选择时间范围",size:"small"},null,8,["value"]),u(a(fe),{size:"small",onClick:I,loading:l.loading},{icon:h(()=>[u(a(q),null,{default:h(()=>[u(a(me))]),_:1})]),default:h(()=>[y[1]||(y[1]=G(" 刷新 "))]),_:1},8,["loading"])])]),default:h(()=>{var w;return[p("div",Ct,[p("div",{ref_key:"chartRef",ref:g,class:"chart-element"},null,512),l.loading?(z(),H("div",xt,[u(a(ue),{size:"large"})])):U("",!0),!l.loading&&!((w=l.data)!=null&&w.length)?(z(),H("div",Rt,[u(a(re),{description:"暂无数据"})])):U("",!0)])]}),_:1}))}}),zt=Z(Nt,[["__scopeId","data-v-5dd68d93"]]),At={class:"overview-grid"},Lt={class:"overview-item"},Yt={class:"overview-icon hostname"},Ot={class:"overview-content"},Pt={class:"overview-value text-truncate"},Ht={class:"overview-item"},Bt={class:"overview-icon os"},Et={class:"overview-content"},Ut={class:"overview-value text-truncate"},Ft={class:"overview-item"},Gt={class:"overview-icon version"},Wt={class:"overview-content"},Kt={class:"overview-value text-truncate"},Vt={class:"overview-item"},qt={class:"overview-icon architecture"},Jt={class:"overview-content"},Xt={class:"overview-value text-truncate"},jt={class:"overview-item"},Qt={class:"overview-icon server-type"},Zt={class:"overview-content"},ea={class:"overview-value text-truncate"},ta={class:"overview-item"},aa={class:"overview-icon ip"},ra={class:"overview-content"},sa={class:"overview-value text-truncate"},na=Q({name:"ServerInfoCard",__name:"ServerInfoCard",props:{serverInfo:{}},setup(l){const k=d=>({physical:"物理机",virtual:"虚拟机",unknown:"未知"})[d||"unknown"]||"未知",g=d=>{const m=d.toLowerCase();return m.includes("windows")?Ve:m.includes("linux")?Ce:m.includes("mac")||m.includes("darwin")?qe:xe},o=d=>{if(!d)return"N/A";if(d.toLowerCase().includes("windows")){const m=d.match(/Windows (\d+(?:\.\d+)?)/i);if(m){const b=m[1],x=d.match(/Windows \d+(?:\.\d+)?\s+(\w+)/i);return x?`Windows ${b} ${x[1]}`:`Windows ${b}`}}return d.length>20?d.substring(0,17)+"...":d};return(d,m)=>(z(),j(a(Re),{title:"服务器信息",embedded:"",class:"server-info-card"},{default:h(()=>[p("div",At,[p("div",Lt,[p("div",Yt,[u(a(q),{size:"24"},{default:h(()=>[u(a(Ge))]),_:1})]),p("div",Ot,[m[0]||(m[0]=p("div",{class:"overview-label"},"主机名",-1)),u(a(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Pt,V(d.serverInfo.hostname),1)]),default:h(()=>[G(" "+V(d.serverInfo.hostname),1)]),_:1})])]),p("div",Ht,[p("div",Bt,[u(a(q),{size:"24"},{default:h(()=>[(z(),j(Ee(g(d.serverInfo.osType))))]),_:1})]),p("div",Et,[m[1]||(m[1]=p("div",{class:"overview-label"},"操作系统",-1)),u(a(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Ut,V(d.serverInfo.osType),1)]),default:h(()=>[G(" "+V(d.serverInfo.osType),1)]),_:1})])]),p("div",Ft,[p("div",Gt,[u(a(q),{size:"24"},{default:h(()=>[u(a(Ce))]),_:1})]),p("div",Wt,[m[2]||(m[2]=p("div",{class:"overview-label"},"系统版本",-1)),u(a(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Kt,V(o(d.serverInfo.osVersion)),1)]),default:h(()=>[G(" "+V(d.serverInfo.osVersion),1)]),_:1})])]),p("div",Vt,[p("div",qt,[u(a(q),{size:"24"},{default:h(()=>[u(a(xe))]),_:1})]),p("div",Jt,[m[3]||(m[3]=p("div",{class:"overview-label"},"系统架构",-1)),u(a(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",Xt,V(d.serverInfo.architecture),1)]),default:h(()=>[G(" "+V(d.serverInfo.architecture),1)]),_:1})])]),p("div",jt,[p("div",Qt,[u(a(q),{size:"24"},{default:h(()=>[u(a(We))]),_:1})]),p("div",Zt,[m[4]||(m[4]=p("div",{class:"overview-label"},"服务器类型",-1)),u(a(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",ea,V(k(d.serverInfo.serverType)),1)]),default:h(()=>[G(" "+V(k(d.serverInfo.serverType)),1)]),_:1})])]),p("div",ta,[p("div",aa,[u(a(q),{size:"24"},{default:h(()=>[u(a(Ke))]),_:1})]),p("div",ra,[m[5]||(m[5]=p("div",{class:"overview-label"},"IP地址",-1)),u(a(oe),{"show-arrow":!1},{trigger:h(()=>[p("div",sa,V(d.serverInfo.ipAddress||"N/A"),1)]),default:h(()=>[G(" "+V(d.serverInfo.ipAddress||"N/A"),1)]),_:1})])])])]),_:1}))}}),oa=Z(na,[["__scopeId","data-v-f17d303f"]]);var ee=(l=>(l.PHYSICAL="physical",l.VIRTUAL="virtual",l.UNKNOWN="unknown",l))(ee||{}),ie=(l=>(l.LINUX="Linux",l.WINDOWS="Windows",l.MACOS="MacOS",l.UNIX="Unix",l.OTHER="Other",l))(ie||{});function ia(){const l="hub0007",k=C(!1),g=C([]),o=C(),d={fields:[{field:"hostname",label:"主机名",type:"input",placeholder:"请输入主机名",span:6,clearable:!0},{field:"ipAddress",label:"IP地址",type:"input",placeholder:"请输入IP地址",span:6,clearable:!0},{field:"osType",label:"操作系统",type:"select",placeholder:"请选择操作系统",span:6,clearable:!0,options:[{label:"全部",value:""},{label:"Linux",value:ie.LINUX},{label:"Windows",value:ie.WINDOWS},{label:"MacOS",value:ie.MACOS},{label:"Unix",value:ie.UNIX},{label:"其他",value:ie.OTHER}]},{field:"serverType",label:"服务器类型",type:"select",placeholder:"请选择服务器类型",span:6,clearable:!0,options:[{label:"全部",value:""},{label:"物理服务器",value:ee.PHYSICAL},{label:"虚拟服务器",value:ee.VIRTUAL},{label:"未知",value:ee.UNKNOWN}]}],moreFields:[{field:"serverLocation",label:"服务器位置",type:"input",placeholder:"请输入服务器位置",span:6,clearable:!0}],toolbarButtons:[]};return{moduleId:l,loading:k,serverList:g,pageInfo:o,searchFormConfig:d,gridConfig:{columns:[{field:"metricServerId",title:"节点ID",showOverflow:!0,width:200},{field:"hostname",title:"主机名",showOverflow:!0},{field:"ipAddress",title:"IP地址",showOverflow:!0},{field:"osType",title:"操作系统",showOverflow:!0,cellRender:{name:"VxeTag",props:({row:r})=>({type:"info",content:r.osType})}},{field:"osVersion",title:"系统版本",showOverflow:!0},{field:"architecture",title:"架构",showOverflow:!0},{field:"serverType",title:"服务器类型",cellRender:{name:"VxeTag",props:({row:r})=>{const T={[ee.PHYSICAL]:{type:"success",text:"物理服务器"},[ee.VIRTUAL]:{type:"warning",text:"虚拟服务器"},[ee.UNKNOWN]:{type:"default",text:"未知"}},Y=T[r.serverType]||T[ee.UNKNOWN];return{type:Y.type,content:Y.text}}}},{field:"serverLocation",title:"服务器位置",showOverflow:!0},{field:"lastUpdateTime",title:"最后更新",sortable:!0,showOverflow:!0,formatter:({cellValue:r})=>r?L(r,"YYYY-MM-DD HH:mm:ss"):""},{field:"addTime",title:"创建时间",sortable:!0,showOverflow:!0,formatter:({cellValue:r})=>r?L(r,"YYYY-MM-DD HH:mm:ss"):""},{field:"addWho",title:"创建人",showOverflow:!0},{field:"editTime",title:"修改时间",sortable:!0,showOverflow:!0,formatter:({cellValue:r})=>r?L(r,"YYYY-MM-DD HH:mm:ss"):""},{field:"editWho",title:"修改人",showOverflow:!0}],menuConfig:{enabled:!0,customMenus:[{code:"view",name:"查看详情",prefixIcon:"vxe-icon-eye-fill"}]},paginationConfig:{show:!0}},setServerList:r=>{g.value=r},updatePagination:r=>{o.value=r}}}const ae=Ue("/gateway/hub0007");async function la(l){return ae.post("/queryServerInfos",l)}async function da(l){return ae.post("/getServerInfo",{metricServerId:l})}async function ca(l){return ae.post("/metrics/cpu",l)}async function ua(l){return ae.post("/metrics/memory",l)}async function fa(l){return ae.post("/metrics/disk",l)}async function ma(l){return ae.post("/metrics/diskio",l)}async function va(l){return ae.post("/metrics/network",l)}async function ha(l){return ae.post("/metrics/process",l)}function pa(){const l=C(""),k=C(!1),g=C(!1),o=C(!1),d=C(!1),m=C(!1),b=C(!1),x=C([]),r=C([]),T=C([]),Y=C([]),A=C([]),_=C([]),I=C([Date.now()-3600*1e3,Date.now()]),R=async n=>{const i=n||l.value;if(i){k.value=!0;try{const[$,S]=I.value,M=await ca({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(x.value=JSON.parse(M.bizData))}catch($){console.error("加载CPU监控数据失败:",$)}finally{k.value=!1}}},f=async n=>{const i=n||l.value;if(i){g.value=!0;try{const[$,S]=I.value,M=await ua({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(r.value=JSON.parse(M.bizData))}catch($){console.error("加载内存监控数据失败:",$)}finally{g.value=!1}}},y=async n=>{const i=n||l.value;if(i){o.value=!0;try{const[$,S]=I.value,M=await fa({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(T.value=JSON.parse(M.bizData))}catch($){console.error("加载磁盘监控数据失败:",$)}finally{o.value=!1}}},w=async n=>{const i=n||l.value;if(i){d.value=!0;try{const[$,S]=I.value,M=await ma({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(Y.value=JSON.parse(M.bizData))}catch($){console.error("加载磁盘IO监控数据失败:",$)}finally{d.value=!1}}},e=async n=>{const i=n||l.value;if(i){m.value=!0;try{const[$,S]=I.value,M=await va({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(A.value=JSON.parse(M.bizData))}catch($){console.error("加载网络监控数据失败:",$)}finally{m.value=!1}}},s=async n=>{const i=n||l.value;if(i){b.value=!0;try{const[$,S]=I.value,M=await ha({metricServerId:i,startTime:L($,"YYYY-MM-DD HH:mm:ss"),endTime:L(S,"YYYY-MM-DD HH:mm:ss")});M.oK&&M.bizData&&(_.value=JSON.parse(M.bizData))}catch($){console.error("加载进程监控数据失败:",$)}finally{b.value=!1}}},t=async n=>{const i=n||l.value;i&&await Promise.all([R(i),f(i),y(i),w(i),e(i),s(i)])},c=()=>{x.value=[],r.value=[],T.value=[],Y.value=[],A.value=[],_.value=[]};return{selectedServerId:l,cpuLoading:k,memoryLoading:g,diskLoading:o,diskIOLoading:d,networkLoading:m,processLoading:b,cpuMetrics:x,memoryMetrics:r,diskMetrics:T,diskIOMetrics:Y,networkMetrics:A,processMetrics:_,timeRange:I,loadCPUMetrics:R,loadMemoryMetrics:f,loadDiskMetrics:y,loadDiskIOMetrics:w,loadNetworkMetrics:e,loadProcessMetrics:s,loadAllMetrics:t,clearAllMetrics:c,setSelectedServer:async n=>{l.value!==n&&(l.value=n,c(),n&&await t(n))},updateTimeRange:n=>{I.value=n}}}function ga(l){const k=Fe(),g=ia(),{loading:o,serverList:d,pageInfo:m,setServerList:b,updatePagination:x}=g,r=async _=>{var I,R,f;o.value=!0;try{let y=_;!y&&((I=l==null?void 0:l.value)!=null&&I.getFormData)&&(y=l.value.getFormData()||{});const e={...y?Object.fromEntries(Object.entries(y).filter(([,t])=>t!==""&&t!==null&&t!==void 0)):{},activeFlag:"Y",...Ae((R=m.value)==null?void 0:R.pageIndex,(f=m.value)==null?void 0:f.pageSize)},s=await la(e);if(s.oK){if(s.bizData){const t=JSON.parse(s.bizData),c=Array.isArray(t)?t:[];b(c)}if(s.pageQueryData){const t=JSON.parse(s.pageQueryData);x(t)}}else k.error(s.errMsg||"查询系统节点列表失败")}catch(y){console.error("加载系统节点列表失败:",y),k.error("加载系统节点列表失败")}finally{o.value=!1}};return{model:g,loading:o,serverList:d,pageInfo:m,loadServerNodes:r,handleSearch:async _=>{m.value&&(m.value.pageIndex=1),await r(_)},handlePageChange:async _=>{m.value&&(_.pageIndex!==void 0&&(m.value.pageIndex=_.pageIndex),_.pageSize!==void 0&&(m.value.pageSize=_.pageSize)),await r()},getServerDetail:async _=>{try{const I=await da(_);return I.oK&&I.bizData?JSON.parse(I.bizData):(k.error(I.errMsg||"获取节点详情失败"),null)}catch(I){return console.error("获取节点详情失败:",I),k.error("获取节点详情失败"),null}}}}function ya(l,k){const g=ga(k),{model:o}=g,d=async r=>{await g.handleSearch(r)},m=r=>{console.log("Toolbar button clicked:",r)},b=async({code:r,row:T})=>{if(T)switch(r){case"view":await x(T);break;default:console.log("Unknown menu key:",r)}},x=async r=>{console.log("查看节点详情:",r);const T=await g.getServerDetail(r.metricServerId);T&&console.log("节点详情:",T)};return{model:o,service:g,handleToolbarClick:m,handleMenuClick:b,handleSearch:d}}const wa=["id"],ba={key:0,class:"monitor-empty"},Ma={key:1,class:"monitor-container"},Da={class:"chart-row"},Sa={class:"chart-item"},$a={class:"chart-item"},_a={class:"chart-row"},ka={class:"chart-item"},Ta={class:"chart-item"},Ia={class:"chart-row"},Ca={class:"chart-item"},xa={class:"chart-item"},Ra=Q({name:"ServerNodeManagement",__name:"ServerNodeManagement",setup(l){const k=C(),g=C(),{model:o,service:d,handleToolbarClick:m,handleMenuClick:b,handleSearch:x}=ya(g,k),r=pa(),T=W(()=>r.selectedServerId.value&&o.serverList.value.find(w=>w.metricServerId===r.selectedServerId.value)||null),Y=async({row:w})=>{w&&w.metricServerId&&await r.setSelectedServer(w.metricServerId)},A=async w=>{w&&(r.updateTimeRange(w),await r.loadCPUMetrics())},_=async w=>{w&&(r.updateTimeRange(w),await r.loadMemoryMetrics())},I=async w=>{w&&(r.updateTimeRange(w),await r.loadDiskMetrics())},R=async w=>{w&&(r.updateTimeRange(w),await r.loadDiskIOMetrics())},f=async w=>{w&&(r.updateTimeRange(w),await r.loadNetworkMetrics())},y=async w=>{w&&(r.updateTimeRange(w),await r.loadProcessMetrics())};return(w,e)=>(z(),H("div",{class:"server-node-management",id:a(d).model.moduleId},[u(a(Ie),{direction:"vertical","default-size":"300px"},{1:h(()=>[u(a(te),null,{default:h(()=>[u(a(Ie),{direction:"vertical","default-size":"80px"},{1:h(()=>[u(Ye,Te({ref_key:"searchFormRef",ref:k,"module-id":a(o).moduleId},a(o).searchFormConfig,{onSearch:a(x),onToolbarClick:a(m)}),null,16,["module-id","onSearch","onToolbarClick"])]),2:h(()=>[u(a(Le),Te({ref_key:"gridRef",ref:g,"module-id":a(o).moduleId,data:a(o).serverList,loading:a(o).loading},a(o).gridConfig,{onPageChange:a(d).handlePageChange,onMenuClick:a(b),onRowClick:Y}),null,16,["module-id","data","loading","onPageChange","onMenuClick"])]),_:1})]),_:1})]),2:h(()=>[u(a(te),null,{default:h(()=>[a(r).selectedServerId.value?(z(),H("div",Ma,[T.value?(z(),j(a(oa),{key:0,"server-info":T.value},null,8,["server-info"])):U("",!0),p("div",Da,[p("div",Sa,[u(a(at),{data:a(r).cpuMetrics.value,loading:a(r).cpuLoading.value,"warning-threshold":80,"danger-threshold":90,"cpu-detail-data":a(r).cpuMetrics.value,onRefresh:a(r).loadCPUMetrics,onTimeRangeChange:A},null,8,["data","loading","cpu-detail-data","onRefresh"])]),p("div",$a,[u(a(lt),{data:a(r).memoryMetrics.value,loading:a(r).memoryLoading.value,"warning-threshold":80,"danger-threshold":90,"memory-detail-data":a(r).memoryMetrics.value,onRefresh:a(r).loadMemoryMetrics,onTimeRangeChange:_},null,8,["data","loading","memory-detail-data","onRefresh"])])]),p("div",_a,[p("div",ka,[u(a(vt),{data:a(r).diskMetrics.value,loading:a(r).diskLoading.value,"warning-threshold":80,"danger-threshold":90,"disk-detail-data":a(r).diskMetrics.value,onRefresh:a(r).loadDiskMetrics,onTimeRangeChange:I},null,8,["data","loading","disk-detail-data","onRefresh"])]),p("div",Ta,[u(a(Mt),{data:a(r).diskIOMetrics.value,loading:a(r).diskIOLoading.value,"disk-io-detail-data":a(r).diskIOMetrics.value,onRefresh:a(r).loadDiskIOMetrics,onTimeRangeChange:R},null,8,["data","loading","disk-io-detail-data","onRefresh"])])]),p("div",Ia,[p("div",Ca,[u(a(Tt),{data:a(r).networkMetrics.value,loading:a(r).networkLoading.value,"network-detail-data":a(r).networkMetrics.value,"upload-color":"#ff4d4f","download-color":"#52c41a",onRefresh:a(r).loadNetworkMetrics,onTimeRangeChange:f},null,8,["data","loading","network-detail-data","onRefresh"])]),p("div",xa,[u(a(zt),{data:a(r).processMetrics.value,loading:a(r).processLoading.value,"process-detail-data":a(r).processMetrics.value,onRefresh:a(r).loadProcessMetrics,onTimeRangeChange:y},null,8,["data","loading","process-detail-data","onRefresh"])])])])):(z(),H("div",ba,[u(a(re),{description:"请在上方列表中选择一个节点查看监控数据"})]))]),_:1})]),_:1})],8,wa))}}),Za=Z(Ra,[["__scopeId","data-v-0c083a3a"]]);export{Za as default};
