import{d as V,m as X,cR as d,a7 as P,c as h,o as r,a5 as z,n as K,j as a,h as m,f as y,b as p,g as v,e as o,aO as E,w as i,K as g,t as x,r as B,J as H,i as L,_ as U}from"./index-B5iwLEhr.js";import{C as Q}from"./CopyOutline-D29-WYAX.js";import{C as Y}from"./CodeOutline-DrtOkp0s.js";import{N as Z}from"./Code-B7-WNvvt.js";import"./SearchForm-DE-Qtsds.js";const tt={key:0,class:"g-text-show__toolbar"},et={class:"g-text-show__toolbar-left"},st={key:1,class:"performance-tip"},at={class:"g-text-show__toolbar-right"},nt={key:1,class:"g-text-show__plain-text"},N=500*1024,b=2*1024*1024,ot=V({name:"GTextShow",__name:"GTextShow",props:{content:{default:""},format:{default:"auto"},showLineNumbers:{type:Boolean,default:!1},showCopyButton:{type:Boolean,default:!0},autoFormat:{type:Boolean,default:!0},maxHeight:{},minHeight:{},class:{},style:{}},emits:["copy"],setup(_,{emit:j}){const s=_,F=j,c=X(),f=B(!0),n=B(null),M={highlight:d.highlight.bind(d),getLanguage:d.getLanguage.bind(d)},w=a(()=>s.content?new Blob([s.content]).size:0),S=a(()=>w.value>N),O=a(()=>{const t=w.value;return t<1024?`${t}B`:t<1024*1024?`${(t/1024).toFixed(2)}KB`:`${(t/1024/1024).toFixed(2)}MB`}),k=t=>{if(!t||!t.trim())return"txt";const e=t.trim();if(new Blob([e]).size>b)return e.startsWith("{")||e.startsWith("[")?"json":e.startsWith("<?xml")||e.startsWith("<")?e.includes("soap:Envelope")||e.includes("soapenv:Envelope")?"soap":"xml":"txt";if(e.startsWith("{")||e.startsWith("["))try{return JSON.parse(e),"json"}catch{}return e.startsWith("<?xml")||e.startsWith("<")?e.includes("soap:Envelope")||e.includes("soapenv:Envelope")?"soap":"xml":e.includes("---")||e.includes(":")&&e.split(`
`).length>1?"yaml":/^\s*(SELECT|INSERT|UPDATE|DELETE|CREATE|ALTER|DROP)\s+/i.test(e)?"sql":/<html[\s>]|<body[\s>]|<div[\s>]/i.test(e)?"html":e.includes("function")||e.includes("const ")||e.includes("let ")?e.includes(":")&&e.includes("interface")||e.includes("type ")?"typescript":"javascript":e.includes("{")&&e.includes("}")&&e.includes(":")?"css":"txt"},l=a(()=>s.format==="auto"?k(s.content):s.format),A=a(()=>{const t=l.value;return{json:"json",xml:"xml",soap:"xml",txt:"plaintext",yaml:"yaml",sql:"sql",javascript:"javascript",typescript:"typescript",css:"css",html:"html",auto:"plaintext"}[t]||"plaintext"}),J=t=>{if(new Blob([t]).size>b)return t;try{const u=JSON.parse(t);return JSON.stringify(u,null,2)}catch{return t}},T=a(()=>{if(!s.content)return"";const t=l.value,e=w.value,u=n.value!==null?n.value:s.autoFormat;return e>b&&!u?s.content:t==="json"&&u?J(s.content):s.content});P(()=>s.content,t=>{if(!t){f.value=!0,n.value=null;return}const e=new Blob([t]).size;f.value=e<=N,n.value=null},{immediate:!0});const R=a(()=>{const t=l.value;return{json:"success",xml:"info",soap:"primary",txt:"default",yaml:"warning",sql:"info",javascript:"success",typescript:"primary",css:"info",html:"info",auto:"default"}[t]||"default"}),W=a(()=>{const t=l.value;return{json:"JSON",xml:"XML",soap:"SOAP",txt:"TXT",yaml:"YAML",sql:"SQL",javascript:"JavaScript",typescript:"TypeScript",css:"CSS",html:"HTML",auto:"AUTO"}[t]||"TXT"}),q=a(()=>s.showCopyButton||C.value&&!s.autoFormat),C=a(()=>l.value==="json"||l.value==="xml"||l.value==="soap"),D=a(()=>{const t={};if(s.style){if(typeof s.style=="string")return s.style;Object.assign(t,s.style)}return t}),G=a(()=>{const t={};return s.maxHeight&&(t.maxHeight=typeof s.maxHeight=="number"?`${s.maxHeight}px`:s.maxHeight,t.overflow="auto"),s.minHeight&&(t.minHeight=typeof s.minHeight=="number"?`${s.minHeight}px`:s.minHeight),t}),I=async()=>{try{const t=T.value||s.content;await navigator.clipboard.writeText(t),c.success("复制成功"),F("copy",t)}catch(t){c.error("复制失败"),console.error("复制失败:",t)}},$=()=>{const t=l.value;if(t!=="json"&&t!=="xml"&&t!=="soap"){c.warning("当前格式不支持格式化");return}const e=n.value!==null?n.value:s.autoFormat;n.value=!e,n.value?c.success("已格式化"):c.info("已取消格式化")};return(t,e)=>(r(),h("div",{class:K(["g-text-show",s.class]),style:z(D.value)},[q.value?(r(),h("div",tt,[y("div",et,[p(o(E),{size:"small",type:R.value},{default:i(()=>[g(x(W.value),1)]),_:1},8,["type"]),S.value?(r(),v(o(E),{key:0,size:"small",type:"warning"},{default:i(()=>[g(" 超大内容（"+x(O.value)+"） ",1)]),_:1})):m("",!0),S.value&&!f.value?(r(),h("span",st," 已禁用语法高亮以提升性能 ")):m("",!0)]),y("div",at,[_.showCopyButton?(r(),v(o(H),{key:0,size:"small",quaternary:"",onClick:I},{icon:i(()=>[p(o(L),null,{default:i(()=>[p(o(Q))]),_:1})]),default:i(()=>[e[0]||(e[0]=g(" 复制 ",-1))]),_:1})):m("",!0),C.value?(r(),v(o(H),{key:1,size:"small",quaternary:"",onClick:$},{icon:i(()=>[p(o(L),null,{default:i(()=>[p(o(Y))]),_:1})]),default:i(()=>[g(" "+x((n.value!==null?n.value:s.autoFormat)?"取消格式化":"格式化"),1)]),_:1})):m("",!0)])])):m("",!0),y("div",{class:"g-text-show__content",style:z(G.value)},[f.value?(r(),v(o(Z),{key:0,code:T.value,language:A.value,"show-line-numbers":_.showLineNumbers,hljs:M,class:"g-text-show__code"},null,8,["code","language","show-line-numbers"])):(r(),h("pre",nt,[y("code",null,x(T.value),1)]))],4)],6))}}),mt=U(ot,[["__scopeId","data-v-5cd1a2cd"]]);export{mt as G};
